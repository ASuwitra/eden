/*
: 2013 (c) Sahana Software Foundation
 @license: MIT

 requires: jQuery 1.9.1+
 requires: jQuery UI 1.10 widget factory

*/
(function(d){d.color={};d.color.make=function(z,a,c,e){var b={};b.r=z||0;b.g=a||0;b.b=c||0;b.a=null!=e?e:1;b.add=function(d,a){for(var c=0;c<d.length;++c)b[d.charAt(c)]+=a;return b.normalize()};b.scale=function(d,a){for(var c=0;c<d.length;++c)b[d.charAt(c)]*=a;return b.normalize()};b.toString=function(){return 1<=b.a?"rgb("+[b.r,b.g,b.b].join()+")":"rgba("+[b.r,b.g,b.b,b.a].join()+")"};b.normalize=function(){function d(a,c,b){return c<a?a:c>b?b:c}b.r=d(0,parseInt(b.r),255);b.g=d(0,parseInt(b.g),255);
b.b=d(0,parseInt(b.b),255);b.a=d(0,b.a,1);return b};b.clone=function(){return d.color.make(b.r,b.b,b.g,b.a)};return b.normalize()};d.color.extract=function(z,a){var c;do{c=z.css(a).toLowerCase();if(""!=c&&"transparent"!=c)break;z=z.parent()}while(!d.nodeName(z.get(0),"body"));"rgba(0, 0, 0, 0)"==c&&(c="transparent");return d.color.parse(c)};d.color.parse=function(z){var a,c=d.color.make;if(a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(z))return c(parseInt(a[1],10),parseInt(a[2],
10),parseInt(a[3],10));if(a=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(z))return c(parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),parseFloat(a[4]));if(a=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(z))return c(2.55*parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]));if(a=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(z))return c(2.55*
parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]),parseFloat(a[4]));if(a=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(z))return c(parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16));if(a=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(z))return c(parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16));z=d.trim(z).toLowerCase();if("transparent"==z)return c(255,255,255,0);a=B[z]||[0,0,0];return c(a[0],a[1],a[2])};var B={aqua:[0,255,255],azure:[240,255,255],beige:[245,
245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,
144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);
(function(d){function B(a,e){var b=e.children("."+a)[0];if(null==b&&(b=document.createElement("canvas"),b.className=a,d(b).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(e),!b.getContext))if(window.G_vmlCanvasManager)b=window.G_vmlCanvasManager.initElement(b);else throw Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=
b;b=this.context=b.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1);this.resize(e.width(),e.height());this.textContainer=null;this.text={};this._textCache={}}function z(a,e,b,k){function h(l,s){s=[F].concat(s);for(var f=0;f<l.length;++f)l[f].apply(this,s)}function g(l){for(var s=[],f=0;f<l.length;++f){var a=d.extend(!0,{},m.series);null!=l[f].data?
(a.data=l[f].data,delete l[f].data,d.extend(!0,a,l[f]),l[f].data=a.data):a.data=l[f];s.push(a)}D=s;f=D.length;s=-1;for(l=0;l<D.length;++l)a=D[l].color,null!=a&&(f--,"number"==typeof a&&a>s&&(s=a));f<=s&&(f=s+1);var s=[],t=m.colors,b=t.length,c=0;for(l=0;l<f;l++)a=d.color.parse(t[l%b]||"#666"),0==l%b&&l&&(c=0<=c?0.5>c?-c-0.2:0:-c),s[l]=a.scale("rgb",1+c);for(l=f=0;l<D.length;++l){a=D[l];null==a.color?(a.color=s[f].toString(),++f):"number"==typeof a.color&&(a.color=s[a.color].toString());if(null==a.lines.show){var e,
t=!0;for(e in a)if(a[e]&&a[e].show){t=!1;break}t&&(a.lines.show=!0)}null==a.lines.zero&&(a.lines.zero=!!a.lines.fill);a.xaxis=I(Q,q(a,"x"));a.yaxis=I(X,q(a,"y"))}H()}function q(l,a){var f=l[a+"axis"];"object"==typeof f&&(f=f.n);"number"!=typeof f&&(f=1);return f}function r(){return d.grep(Q.concat(X),function(l){return l})}function y(l){var a={},f,d;for(f=0;f<Q.length;++f)(d=Q[f])&&d.used&&(a["x"+d.n]=d.c2p(l.left));for(f=0;f<X.length;++f)(d=X[f])&&d.used&&(a["y"+d.n]=d.c2p(l.top));void 0!==a.x1&&
(a.x=a.x1);void 0!==a.y1&&(a.y=a.y1);return a}function I(l,a){l[a-1]||(l[a-1]={n:a,direction:l==Q?"x":"y",options:d.extend(!0,{},l==Q?m.xaxis:m.yaxis)});return l[a-1]}function H(){function l(l,a,f){a<l.datamin&&a!=-b&&(l.datamin=a);f>l.datamax&&f!=b&&(l.datamax=f)}var a=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,b=Number.MAX_VALUE,t,c,E,e,w,m,G,k,n,g,p,N;d.each(r(),function(l,d){d.datamin=a;d.datamax=f;d.used=!1});for(t=0;t<D.length;++t)w=D[t],w.datapoints={points:[]},h(V.processRawData,
[w,w.data,w.datapoints]);for(t=0;t<D.length;++t){w=D[t];p=w.data;N=w.datapoints.format;if(!N){N=[];N.push({x:!0,number:!0,required:!0});N.push({y:!0,number:!0,required:!0});if(w.bars.show||w.lines.show&&w.lines.fill)N.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:!!(w.bars.show&&w.bars.zero||w.lines.show&&w.lines.zero)}),w.bars.horizontal&&(delete N[N.length-1].y,N[N.length-1].x=!0);w.datapoints.format=N}if(null==w.datapoints.pointsize){w.datapoints.pointsize=N.length;G=w.datapoints.pointsize;
m=w.datapoints.points;var fa=w.lines.show&&w.lines.steps;w.xaxis.used=w.yaxis.used=!0;for(c=E=0;c<p.length;++c,E+=G){g=p[c];var oa=null==g;if(!oa)for(e=0;e<G;++e){k=g[e];if(n=N[e])n.number&&null!=k&&(k=+k,isNaN(k)?k=null:Infinity==k?k=b:-Infinity==k&&(k=-b)),null==k&&(n.required&&(oa=!0),null!=n.defaultValue&&(k=n.defaultValue));m[E+e]=k}if(oa)for(e=0;e<G;++e)k=m[E+e],null!=k&&(n=N[e],n.x&&l(w.xaxis,k,k),n.y&&l(w.yaxis,k,k)),m[E+e]=null;else if(fa&&0<E&&null!=m[E-G]&&m[E-G]!=m[E]&&m[E-G+1]!=m[E+1]){for(e=
0;e<G;++e)m[E+G+e]=m[E+e];m[E+1]=m[E-G+1];E+=G}}}}for(t=0;t<D.length;++t)w=D[t],h(V.processDatapoints,[w,w.datapoints]);for(t=0;t<D.length;++t){w=D[t];m=w.datapoints.points;G=w.datapoints.pointsize;N=w.datapoints.format;g=E=a;fa=p=f;for(c=0;c<m.length;c+=G)if(null!=m[c])for(e=0;e<G;++e)k=m[c+e],(n=N[e])&&(!1!==n.autoscale&&k!=b&&k!=-b)&&(n.x&&(k<E&&(E=k),k>p&&(p=k)),n.y&&(k<g&&(g=k),k>fa&&(fa=k)));if(w.bars.show){switch(w.bars.align){case "left":c=0;break;case "right":c=-w.bars.barWidth;break;case "center":c=
-w.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+w.bars.align);}w.bars.horizontal?(g+=c,fa+=c+w.bars.barWidth):(E+=c,p+=c+w.bars.barWidth)}l(w.xaxis,E,p);l(w.yaxis,g,fa)}d.each(r(),function(l,d){d.datamin==a&&(d.datamin=null);d.datamax==f&&(d.datamax=null)})}function C(l){function a(l){return l}var f,d,c=l.options.transform||a,b=l.options.inverseTransform;"x"==l.direction?(f=l.scale=Z/Math.abs(c(l.max)-c(l.min)),d=Math.min(c(l.max),c(l.min))):(f=l.scale=W/Math.abs(c(l.max)-c(l.min)),
f=-f,d=Math.max(c(l.max),c(l.min)));l.p2c=c==a?function(l){return(l-d)*f}:function(l){return(c(l)-d)*f};l.c2p=b?function(l){return b(d+l/f)}:function(l){return d+l/f}}function K(l){var a=l.labelWidth,f=l.labelHeight,c=l.options.position,b=l.options.tickLength,e=m.grid.axisMargin,E=m.grid.labelMargin,k="x"==l.direction?Q:X,w,h=d.grep(k,function(l){return l&&l.options.position==c&&l.reserveSpace});d.inArray(l,h)==h.length-1&&(e=0);null==b&&(b=d.grep(k,function(l){return l&&l.reserveSpace}),b=(w=0==
d.inArray(l,b))?"full":5);isNaN(+b)||(E+=+b);"x"==l.direction?(f+=E,"bottom"==c?(u.bottom+=f+e,l.box={top:L.height-u.bottom,height:f}):(l.box={top:u.top+e,height:f},u.top+=f+e)):(a+=E,"left"==c?(l.box={left:u.left+e,width:a},u.left+=a+e):(u.right+=a+e,l.box={left:L.width-u.right,width:a}));l.position=c;l.tickLength=b;l.box.padding=E;l.innermost=w}function z(){var l=m.grid.minBorderMargin,a={x:0,y:0},f;if(null==l)for(f=l=0;f<D.length;++f)l=Math.max(l,2*(D[f].points.radius+D[f].points.lineWidth/2));
a.x=a.y=Math.ceil(l);d.each(r(),function(l,f){var d=f.direction;f.reserveSpace&&(a[d]=Math.ceil(Math.max(a[d],("x"==d?f.labelWidth:f.labelHeight)/2)))});u.left=Math.max(a.x,u.left);u.right=Math.max(a.x,u.right);u.top=Math.max(a.y,u.top);u.bottom=Math.max(a.y,u.bottom)}function v(){var l,a=r(),f=m.grid.show;for(l in u){var c=m.grid.margin||0;u[l]="number"==typeof c?c:c[l]||0}h(V.processOffset,[u]);for(l in u)u[l]="object"==typeof m.grid.borderWidth?u[l]+(f?m.grid.borderWidth[l]:0):u[l]+(f?m.grid.borderWidth:
0);d.each(a,function(l,a){a.show=a.options.show;null==a.show&&(a.show=a.used);a.reserveSpace=a.show||a.options.reserveSpace;var f=a.options,d=+(null!=f.min?f.min:a.datamin),c=+(null!=f.max?f.max:a.datamax),b=c-d;if(0==b){if(b=0==c?1:0.01,null==f.min&&(d-=b),null==f.max||null!=f.min)c+=b}else{var s=f.autoscaleMargin;null!=s&&(null==f.min&&(d-=b*s,0>d&&(null!=a.datamin&&0<=a.datamin)&&(d=0)),null==f.max&&(c+=b*s,0<c&&(null!=a.datamax&&0>=a.datamax)&&(c=0)))}a.min=d;a.max=c});if(f){c=d.grep(a,function(l){return l.reserveSpace});
d.each(c,function(l,a){R(a);var f=a.options.ticks,c=[];null==f||"number"==typeof f&&0<f?c=a.tickGenerator(a):f&&(c=d.isFunction(f)?f(a):f);var b;a.ticks=[];for(f=0;f<c.length;++f){var s=null,e=c[f];"object"==typeof e?(b=+e[0],1<e.length&&(s=e[1])):b=+e;null==s&&(s=a.tickFormatter(b,a));isNaN(b)||a.ticks.push({v:b,label:s})}c=a.ticks;a.options.autoscaleMargin&&0<c.length&&(null==a.options.min&&(a.min=Math.min(a.min,c[0].v)),null==a.options.max&&1<c.length&&(a.max=Math.max(a.max,c[c.length-1].v)));
c=a.options;f=a.ticks||[];b=c.labelWidth||0;for(var s=c.labelHeight||0,e="flot-"+a.direction+"-axis flot-"+a.direction+a.n+"-axis "+(a.direction+"Axis "+a.direction+a.n+"Axis"),m=c.font||"flot-tick-label tickLabel",k=0;k<f.length;++k){var da=f[k];da.label&&(da=L.getTextInfo(e,da.label,m),null==c.labelWidth&&(b=Math.max(b,da.width)),null==c.labelHeight&&(s=Math.max(s,da.height)))}a.labelWidth=Math.ceil(b);a.labelHeight=Math.ceil(s)});for(l=c.length-1;0<=l;--l)K(c[l]);z();d.each(c,function(l,a){"x"==
a.direction?(a.box.left=u.left-a.labelWidth/2,a.box.width=L.width-u.left-u.right+a.labelWidth):(a.box.top=u.top-a.labelHeight/2,a.box.height=L.height-u.bottom-u.top+a.labelHeight)})}Z=L.width-u.left-u.right;W=L.height-u.bottom-u.top;d.each(a,function(l,a){C(a)});f&&ia();A()}function R(l){var a=l.options,f;f="number"==typeof a.ticks&&0<a.ticks?a.ticks:0.3*Math.sqrt("x"==l.direction?L.width:L.height);f=(l.max-l.min)/f;var c=-Math.floor(Math.log(f)/Math.LN10),b=a.tickDecimals;null!=b&&c>b&&(c=b);var e=
Math.pow(10,-c),m=f/e,k;1.5>m?k=1:3>m?(k=2,2.25<m&&(null==b||c+1<=b)&&(k=2.5,++c)):k=7.5>m?5:10;k*=e;null!=a.minTickSize&&k<a.minTickSize&&(k=a.minTickSize);l.delta=f;l.tickDecimals=Math.max(0,null!=b?b:c);l.tickSize=a.tickSize||k;if("time"==a.mode&&!l.tickGenerator)throw Error("Time mode requires the flot.time plugin.");l.tickGenerator||(l.tickGenerator=function(a){var l=[],f=a.tickSize*Math.floor(a.min/a.tickSize),c=0,d=Number.NaN,b;do b=d,d=f+c*a.tickSize,l.push(d),++c;while(d<a.max&&d!=b);return l},
l.tickFormatter=function(a,l){var f=l.tickDecimals?Math.pow(10,l.tickDecimals):1,c=""+Math.round(a*f)/f;if(null!=l.tickDecimals){var d=c.indexOf("."),d=-1==d?0:c.length-d-1;if(d<l.tickDecimals)return(d?c:c+".")+(""+f).substr(1,l.tickDecimals-d)}return c});d.isFunction(a.tickFormatter)&&(l.tickFormatter=function(l,f){return""+a.tickFormatter(l,f)});if(null!=a.alignTicksWithAxis){var w=("x"==l.direction?Q:X)[a.alignTicksWithAxis-1];w&&(w.used&&w!=l)&&(f=l.tickGenerator(l),0<f.length&&(null==a.min&&
(l.min=Math.min(l.min,f[0])),null==a.max&&1<f.length&&(l.max=Math.max(l.max,f[f.length-1]))),l.tickGenerator=function(a){var l=[],f,c;for(c=0;c<w.ticks.length;++c)f=(w.ticks[c].v-w.min)/(w.max-w.min),f=a.min+f*(a.max-a.min),l.push(f);return l},l.mode||null!=a.tickDecimals||(f=Math.max(0,-Math.floor(Math.log(l.delta)/Math.LN10)+1),c=l.tickGenerator(l),1<c.length&&/\..*0$/.test((c[1]-c[0]).toFixed(f))||(l.tickDecimals=f)))}}function p(){L.clear();h(V.drawBackground,[n]);var a=m.grid;a.show&&a.backgroundColor&&
(n.save(),n.translate(u.left,u.top),n.fillStyle=qa(m.grid.backgroundColor,W,0,"rgba(255, 255, 255, 0)"),n.fillRect(0,0,Z,W),n.restore());a.show&&!a.aboveData&&J();for(var c=0;c<D.length;++c){h(V.drawSeries,[n,D[c]]);var f=D[c];f.lines.show&&S(f);f.bars.show&&P(f);f.points.show&&M(f)}h(V.draw,[n]);a.show&&a.aboveData&&J();L.render()}function x(a,c){for(var f,d,b,e,k=r(),m=0;m<k.length;++m)if(f=k[m],f.direction==c&&(e=c+f.n+"axis",a[e]||1!=f.n||(e=c+"axis"),a[e])){d=a[e].from;b=a[e].to;break}a[e]||
(f="x"==c?Q[0]:X[0],d=a[c+"1"],b=a[c+"2"]);null!=d&&(null!=b&&d>b)&&(e=d,d=b,b=e);return{from:d,to:b,axis:f}}function J(){var a,c,f;n.save();n.translate(u.left,u.top);if(f=m.grid.markings)for(d.isFunction(f)&&(c=F.getAxes(),c.xmin=c.xaxis.min,c.xmax=c.xaxis.max,c.ymin=c.yaxis.min,c.ymax=c.yaxis.max,f=f(c)),a=0;a<f.length;++a){c=f[a];var b=x(c,"x"),e=x(c,"y");null==b.from&&(b.from=b.axis.min);null==b.to&&(b.to=b.axis.max);null==e.from&&(e.from=e.axis.min);null==e.to&&(e.to=e.axis.max);b.to<b.axis.min||
(b.from>b.axis.max||e.to<e.axis.min||e.from>e.axis.max)||(b.from=Math.max(b.from,b.axis.min),b.to=Math.min(b.to,b.axis.max),e.from=Math.max(e.from,e.axis.min),e.to=Math.min(e.to,e.axis.max),b.from==b.to&&e.from==e.to)||(b.from=b.axis.p2c(b.from),b.to=b.axis.p2c(b.to),e.from=e.axis.p2c(e.from),e.to=e.axis.p2c(e.to),b.from==b.to||e.from==e.to?(n.beginPath(),n.strokeStyle=c.color||m.grid.markingsColor,n.lineWidth=c.lineWidth||m.grid.markingsLineWidth,n.moveTo(b.from,e.from),n.lineTo(b.to,e.to),n.stroke()):
(n.fillStyle=c.color||m.grid.markingsColor,n.fillRect(b.from,e.to,b.to-b.from,e.from-e.to)))}c=r();f=m.grid.borderWidth;for(b=0;b<c.length;++b){e=c[b];a=e.box;var k=e.tickLength,h,g,w,ea;if(e.show&&0!=e.ticks.length){n.lineWidth=1;"x"==e.direction?(h=0,g="full"==k?"top"==e.position?0:W:a.top-u.top+("top"==e.position?a.height:0)):(g=0,h="full"==k?"left"==e.position?0:Z:a.left-u.left+("left"==e.position?a.width:0));e.innermost||(n.strokeStyle=e.options.color,n.beginPath(),w=ea=0,"x"==e.direction?w=
Z+1:ea=W+1,1==n.lineWidth&&("x"==e.direction?g=Math.floor(g)+0.5:h=Math.floor(h)+0.5),n.moveTo(h,g),n.lineTo(h+w,g+ea),n.stroke());n.strokeStyle=e.options.tickColor;n.beginPath();for(a=0;a<e.ticks.length;++a){var G=e.ticks[a].v;w=ea=0;isNaN(G)||(G<e.min||G>e.max||"full"==k&&("object"==typeof f&&0<f[e.position]||0<f)&&(G==e.min||G==e.max))||("x"==e.direction?(h=e.p2c(G),ea="full"==k?-W:k,"top"==e.position&&(ea=-ea)):(g=e.p2c(G),w="full"==k?-Z:k,"left"==e.position&&(w=-w)),1==n.lineWidth&&("x"==e.direction?
h=Math.floor(h)+0.5:g=Math.floor(g)+0.5),n.moveTo(h,g),n.lineTo(h+w,g+ea))}n.stroke()}}f&&(a=m.grid.borderColor,"object"==typeof f||"object"==typeof a?("object"!==typeof f&&(f={top:f,right:f,bottom:f,left:f}),"object"!==typeof a&&(a={top:a,right:a,bottom:a,left:a}),0<f.top&&(n.strokeStyle=a.top,n.lineWidth=f.top,n.beginPath(),n.moveTo(0-f.left,0-f.top/2),n.lineTo(Z,0-f.top/2),n.stroke()),0<f.right&&(n.strokeStyle=a.right,n.lineWidth=f.right,n.beginPath(),n.moveTo(Z+f.right/2,0-f.top),n.lineTo(Z+f.right/
2,W),n.stroke()),0<f.bottom&&(n.strokeStyle=a.bottom,n.lineWidth=f.bottom,n.beginPath(),n.moveTo(Z+f.right,W+f.bottom/2),n.lineTo(0,W+f.bottom/2),n.stroke()),0<f.left&&(n.strokeStyle=a.left,n.lineWidth=f.left,n.beginPath(),n.moveTo(0-f.left/2,W+f.bottom),n.lineTo(0-f.left/2,0),n.stroke())):(n.lineWidth=f,n.strokeStyle=m.grid.borderColor,n.strokeRect(-f/2,-f/2,Z+f,W+f)));n.restore()}function ia(){d.each(r(),function(a,c){if(c.show&&0!=c.ticks.length){var f=c.box,b="flot-"+c.direction+"-axis flot-"+
c.direction+c.n+"-axis "+(c.direction+"Axis "+c.direction+c.n+"Axis"),d=c.options.font||"flot-tick-label tickLabel",e,k,m,h,n;L.removeText(b);for(var G=0;G<c.ticks.length;++G)e=c.ticks[G],!e.label||(e.v<c.min||e.v>c.max)||("x"==c.direction?(h="center",k=u.left+c.p2c(e.v),"bottom"==c.position?m=f.top+f.padding:(m=f.top+f.height-f.padding,n="bottom")):(n="middle",m=u.top+c.p2c(e.v),"left"==c.position?(k=f.left+f.width-f.padding,h="right"):k=f.left+f.padding),L.addText(b,k,m,e.label,d,null,h,n))}})}
function S(a){function c(a,l,f,b,d){var e=a.points;a=a.pointsize;var k=null,m=null;n.beginPath();for(var s=a;s<e.length;s+=a){var h=e[s-a],g=e[s-a+1],t=e[s],p=e[s+1];if(null!=h&&null!=t){if(g<=p&&g<d.min){if(p<d.min)continue;h=(d.min-g)/(p-g)*(t-h)+h;g=d.min}else if(p<=g&&p<d.min){if(g<d.min)continue;t=(d.min-g)/(p-g)*(t-h)+h;p=d.min}if(g>=p&&g>d.max){if(p>d.max)continue;h=(d.max-g)/(p-g)*(t-h)+h;g=d.max}else if(p>=g&&p>d.max){if(g>d.max)continue;t=(d.max-g)/(p-g)*(t-h)+h;p=d.max}if(h<=t&&h<b.min){if(t<
b.min)continue;g=(b.min-h)/(t-h)*(p-g)+g;h=b.min}else if(t<=h&&t<b.min){if(h<b.min)continue;p=(b.min-h)/(t-h)*(p-g)+g;t=b.min}if(h>=t&&h>b.max){if(t>b.max)continue;g=(b.max-h)/(t-h)*(p-g)+g;h=b.max}else if(t>=h&&t>b.max){if(h>b.max)continue;p=(b.max-h)/(t-h)*(p-g)+g;t=b.max}h==k&&g==m||n.moveTo(b.p2c(h)+l,d.p2c(g)+f);k=t;m=p;n.lineTo(b.p2c(t)+l,d.p2c(p)+f)}}n.stroke()}function f(a,c,l){var f=a.points;a=a.pointsize;for(var b=Math.min(Math.max(0,l.min),l.max),d=0,e=!1,k=1,h=0,m=0;!(0<a&&d>f.length+
a);){var d=d+a,s=f[d-a],g=f[d-a+k],t=f[d],p=f[d+k];if(e){if(0<a&&null!=s&&null==t){m=d;a=-a;k=2;continue}if(0>a&&d==h+a){n.fill();e=!1;a=-a;k=1;d=h=m+a;continue}}if(null!=s&&null!=t){if(s<=t&&s<c.min){if(t<c.min)continue;g=(c.min-s)/(t-s)*(p-g)+g;s=c.min}else if(t<=s&&t<c.min){if(s<c.min)continue;p=(c.min-s)/(t-s)*(p-g)+g;t=c.min}if(s>=t&&s>c.max){if(t>c.max)continue;g=(c.max-s)/(t-s)*(p-g)+g;s=c.max}else if(t>=s&&t>c.max){if(s>c.max)continue;p=(c.max-s)/(t-s)*(p-g)+g;t=c.max}e||(n.beginPath(),n.moveTo(c.p2c(s),
l.p2c(b)),e=!0);if(g>=l.max&&p>=l.max)n.lineTo(c.p2c(s),l.p2c(l.max)),n.lineTo(c.p2c(t),l.p2c(l.max));else if(g<=l.min&&p<=l.min)n.lineTo(c.p2c(s),l.p2c(l.min)),n.lineTo(c.p2c(t),l.p2c(l.min));else{var da=s,x=t;g<=p&&g<l.min&&p>=l.min?(s=(l.min-g)/(p-g)*(t-s)+s,g=l.min):p<=g&&(p<l.min&&g>=l.min)&&(t=(l.min-g)/(p-g)*(t-s)+s,p=l.min);g>=p&&g>l.max&&p<=l.max?(s=(l.max-g)/(p-g)*(t-s)+s,g=l.max):p>=g&&(p>l.max&&g<=l.max)&&(t=(l.max-g)/(p-g)*(t-s)+s,p=l.max);s!=da&&n.lineTo(c.p2c(da),l.p2c(g));n.lineTo(c.p2c(s),
l.p2c(g));n.lineTo(c.p2c(t),l.p2c(p));t!=x&&(n.lineTo(c.p2c(t),l.p2c(p)),n.lineTo(c.p2c(x),l.p2c(p)))}}}}n.save();n.translate(u.left,u.top);n.lineJoin="round";var b=a.lines.lineWidth,d=a.shadowSize;if(0<b&&0<d){n.lineWidth=d;n.strokeStyle="rgba(0,0,0,0.1)";var e=Math.PI/18;c(a.datapoints,Math.sin(e)*(b/2+d/2),Math.cos(e)*(b/2+d/2),a.xaxis,a.yaxis);n.lineWidth=d/2;c(a.datapoints,Math.sin(e)*(b/2+d/4),Math.cos(e)*(b/2+d/4),a.xaxis,a.yaxis)}n.lineWidth=b;n.strokeStyle=a.color;if(d=T(a.lines,a.color,
0,W))n.fillStyle=d,f(a.datapoints,a.xaxis,a.yaxis);0<b&&c(a.datapoints,0,0,a.xaxis,a.yaxis);n.restore()}function M(a){function c(a,l,f,d,b,e,s,k){var h=a.points;a=a.pointsize;for(var m=0;m<h.length;m+=a){var g=h[m],t=h[m+1];null==g||(g<e.min||g>e.max||t<s.min||t>s.max)||(n.beginPath(),g=e.p2c(g),t=s.p2c(t)+d,"circle"==k?n.arc(g,t,l,0,b?Math.PI:2*Math.PI,!1):k(n,g,t,l,b),n.closePath(),f&&(n.fillStyle=f,n.fill()),n.stroke())}}n.save();n.translate(u.left,u.top);var f=a.points.lineWidth,d=a.shadowSize,
b=a.points.radius,e=a.points.symbol;0==f&&(f=1E-4);0<f&&0<d&&(d/=2,n.lineWidth=d,n.strokeStyle="rgba(0,0,0,0.1)",c(a.datapoints,b,null,d+d/2,!0,a.xaxis,a.yaxis,e),n.strokeStyle="rgba(0,0,0,0.2)",c(a.datapoints,b,null,d/2,!0,a.xaxis,a.yaxis,e));n.lineWidth=f;n.strokeStyle=a.color;c(a.datapoints,b,T(a.points,a.color),0,!1,a.xaxis,a.yaxis,e);n.restore()}function ca(a,c,f,d,b,e,k,h,m,g,p,n){var x,u,q,M;p?(M=u=q=!0,x=!1,p=f,f=c+d,b=c+b,a<p&&(c=a,a=p,p=c,x=!0,u=!1)):(x=u=q=!0,M=!1,p=a+d,a+=b,b=f,f=c,f<
b&&(c=f,f=b,b=c,M=!0,q=!1));a<h.min||(p>h.max||f<m.min||b>m.max)||(p<h.min&&(p=h.min,x=!1),a>h.max&&(a=h.max,u=!1),b<m.min&&(b=m.min,M=!1),f>m.max&&(f=m.max,q=!1),p=h.p2c(p),b=m.p2c(b),a=h.p2c(a),f=m.p2c(f),k&&(g.beginPath(),g.moveTo(p,b),g.lineTo(p,f),g.lineTo(a,f),g.lineTo(a,b),g.fillStyle=k(b,f),g.fill()),0<n&&(x||u||q||M)&&(g.beginPath(),g.moveTo(p,b+e),x?g.lineTo(p,f+e):g.moveTo(p,f+e),q?g.lineTo(a,f+e):g.moveTo(a,f+e),u?g.lineTo(a,b+e):g.moveTo(a,b+e),M?g.lineTo(p,b+e):g.moveTo(p,b+e),g.stroke()))}
function P(a){n.save();n.translate(u.left,u.top);n.lineWidth=a.bars.lineWidth;n.strokeStyle=a.color;var c;switch(a.bars.align){case "left":c=0;break;case "right":c=-a.bars.barWidth;break;case "center":c=-a.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+a.bars.align);}(function(c,b,d,e,k,h,m){var s=c.points;c=c.pointsize;for(var g=0;g<s.length;g+=c)null!=s[g]&&ca(s[g],s[g+1],s[g+2],b,d,e,k,h,m,n,a.bars.horizontal,a.bars.lineWidth)})(a.datapoints,c,c+a.bars.barWidth,0,a.bars.fill?
function(c,b){return T(a.bars,a.color,c,b)}:null,a.xaxis,a.yaxis);n.restore()}function T(a,c,b,e){var g=a.fill;if(!g)return null;if(a.fillColor)return qa(a.fillColor,b,e,c);a=d.color.parse(c);a.a="number"==typeof g?g:0.4;a.normalize();return a.toString()}function A(){a.find(".legend").remove();if(m.legend.show){for(var b=[],e=[],f=!1,g=m.legend.labelFormatter,k,h,p=0;p<D.length;++p)k=D[p],k.label&&(h=g?g(k.label,k):k.label)&&e.push({label:h,color:k.color});if(m.legend.sorted)if(d.isFunction(m.legend.sorted))e.sort(m.legend.sorted);
else if("reverse"==m.legend.sorted)e.reverse();else{var n="descending"!=m.legend.sorted;e.sort(function(a,c){return a.label==c.label?0:a.label<c.label!=n?1:-1})}for(p=0;p<e.length;++p)g=e[p],0==p%m.legend.noColumns&&(f&&b.push("</tr>"),b.push("<tr>"),f=!0),b.push('<td class="legendColorBox"><div style="border:1px solid '+m.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+g.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+g.label+"</td>");
f&&b.push("</tr>");0!=b.length&&(e='<table style="font-size:smaller;color:'+m.grid.color+'">'+b.join("")+"</table>",null!=m.legend.container?d(m.legend.container).html(e):(b="",f=m.legend.position,p=m.legend.margin,null==p[0]&&(p=[p,p]),"n"==f.charAt(0)?b+="top:"+(p[1]+u.top)+"px;":"s"==f.charAt(0)&&(b+="bottom:"+(p[1]+u.bottom)+"px;"),"e"==f.charAt(1)?b+="right:"+(p[0]+u.right)+"px;":"w"==f.charAt(1)&&(b+="left:"+(p[0]+u.left)+"px;"),e=d('<div class="legend">'+e.replace('style="','style="position:absolute;'+
b+";")+"</div>").appendTo(a),0!=m.legend.backgroundOpacity&&(f=m.legend.backgroundColor,null==f&&(f=(f=m.grid.backgroundColor)&&"string"==typeof f?d.color.parse(f):d.color.extract(e,"background-color"),f.a=1,f=f.toString()),p=e.children(),d('<div style="position:absolute;width:'+p.width()+"px;height:"+p.height()+"px;"+b+"background-color:"+f+';"> </div>').prependTo(e).css("opacity",m.legend.backgroundOpacity))))}}function ra(a){m.grid.hoverable&&$("plothover",a,function(a){return!1!=a.hoverable})}
function Y(a){m.grid.hoverable&&$("plothover",a,function(a){return!1})}function sa(a){$("plotclick",a,function(a){return!1!=a.clickable})}function $(b,d,f){var e=aa.offset(),g=d.pageX-e.left-u.left,k=d.pageY-e.top-u.top,h=y({left:g,top:k});h.pageX=d.pageX;h.pageY=d.pageY;d=m.grid.mouseActiveRadius;var p=d*d+1,n=null,x,q,M;for(x=D.length-1;0<=x;--x)if(f(D[x])){var r=D[x],v=r.xaxis,A=r.yaxis,J=r.datapoints.points,H=v.c2p(g),ca=A.c2p(k),C=d/v.scale,ia=d/A.scale;M=r.datapoints.pointsize;v.options.inverseTransform&&
(C=Number.MAX_VALUE);A.options.inverseTransform&&(ia=Number.MAX_VALUE);if(r.lines.show||r.points.show)for(q=0;q<J.length;q+=M){var S=J[q],P=J[q+1];null==S||(S-H>C||S-H<-C||P-ca>ia||P-ca<-ia)||(S=Math.abs(v.p2c(S)-g),P=Math.abs(A.p2c(P)-k),P=S*S+P*P,P<p&&(p=P,n=[x,q/M]))}if(r.bars.show&&!n)for(v="left"==r.bars.align?0:-r.bars.barWidth/2,r=v+r.bars.barWidth,q=0;q<J.length;q+=M)S=J[q],P=J[q+1],A=J[q+2],null!=S&&(D[x].bars.horizontal?H<=Math.max(A,S)&&H>=Math.min(A,S)&&ca>=P+v&&ca<=P+r:H>=S+v&&H<=S+r&&
ca>=Math.min(A,P)&&ca<=Math.max(A,P))&&(n=[x,q/M])}n?(x=n[0],q=n[1],M=D[x].datapoints.pointsize,f={datapoint:D[x].datapoints.points.slice(q*M,(q+1)*M),dataIndex:q,series:D[x],seriesIndex:x}):f=null;f&&(f.pageX=parseInt(f.series.xaxis.p2c(f.datapoint[0])+e.left+u.left,10),f.pageY=parseInt(f.series.yaxis.p2c(f.datapoint[1])+e.top+u.top,10));if(m.grid.autoHighlight){for(e=0;e<ba.length;++e)g=ba[e],g.auto!=b||f&&g.series==f.series&&g.point[0]==f.datapoint[0]&&g.point[1]==f.datapoint[1]||ka(g.series,g.point);
f&&la(f.series,f.datapoint,b)}a.trigger(b,[h,f])}function ga(){var a=m.interaction.redrawOverlayInterval;-1==a?ma():ja||(ja=setTimeout(ma,a))}function ma(){ja=null;U.save();ha.clear();U.translate(u.left,u.top);var a,c;for(a=0;a<ba.length;++a)if(c=ba[a],c.series.bars.show)pa(c.series,c.point);else{var b=c.series,e=c.point;c=e[0];var e=e[1],g=b.xaxis,k=b.yaxis,m="string"===typeof b.highlightColor?b.highlightColor:d.color.parse(b.color).scale("a",0.5).toString();if(!(c<g.min||c>g.max||e<k.min||e>k.max)){var p=
b.points.radius+b.points.lineWidth/2;U.lineWidth=p;U.strokeStyle=m;m=1.5*p;c=g.p2c(c);e=k.p2c(e);U.beginPath();"circle"==b.points.symbol?U.arc(c,e,m,0,2*Math.PI,!1):b.points.symbol(U,c,e,m,!1);U.closePath();U.stroke()}}U.restore();h(V.drawOverlay,[U])}function la(a,c,b){"number"==typeof a&&(a=D[a]);if("number"==typeof c){var d=a.datapoints.pointsize;c=a.datapoints.points.slice(d*c,d*(c+1))}d=na(a,c);-1==d?(ba.push({series:a,point:c,auto:b}),ga()):b||(ba[d].auto=!1)}function ka(a,c){if(null==a&&null==
c)ba=[],ga();else{"number"==typeof a&&(a=D[a]);if("number"==typeof c){var b=a.datapoints.pointsize;c=a.datapoints.points.slice(b*c,b*(c+1))}b=na(a,c);-1!=b&&(ba.splice(b,1),ga())}}function na(a,c){for(var b=0;b<ba.length;++b){var d=ba[b];if(d.series==a&&d.point[0]==c[0]&&d.point[1]==c[1])return b}return-1}function pa(a,c){var b="string"===typeof a.highlightColor?a.highlightColor:d.color.parse(a.color).scale("a",0.5).toString(),e="left"==a.bars.align?0:-a.bars.barWidth/2;U.lineWidth=a.bars.lineWidth;
U.strokeStyle=b;ca(c[0],c[1],c[2]||0,e,e+a.bars.barWidth,0,function(){return b},a.xaxis,a.yaxis,U,a.bars.horizontal,a.bars.lineWidth)}function qa(a,c,b,e){if("string"==typeof a)return a;c=n.createLinearGradient(0,b,0,c);b=0;for(var g=a.colors.length;b<g;++b){var k=a.colors[b];if("string"!=typeof k){var h=d.color.parse(e);null!=k.brightness&&(h=h.scale("rgb",k.brightness));null!=k.opacity&&(h.a*=k.opacity);k=h.toString()}c.addColorStop(b/(g-1),k)}return c}var D=[],m={colors:["#edc240","#afd8f8","#cb4b4b",
"#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:0.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,
minTickSize:null},yaxis:{autoscaleMargin:0.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,
markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1E3/60},hooks:{}},L=null,ha=null,aa=null,n=null,U=null,Q=[],X=[],u={left:0,right:0,top:0,bottom:0},Z=0,W=0,V={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},F=this;F.setData=g;F.setupGrid=v;F.draw=p;F.getPlaceholder=function(){return a};
F.getCanvas=function(){return L.element};F.getPlotOffset=function(){return u};F.width=function(){return Z};F.height=function(){return W};F.offset=function(){var a=aa.offset();a.left+=u.left;a.top+=u.top;return a};F.getData=function(){return D};F.getAxes=function(){var a={};d.each(Q.concat(X),function(c,b){b&&(a[b.direction+(1!=b.n?b.n:"")+"axis"]=b)});return a};F.getXAxes=function(){return Q};F.getYAxes=function(){return X};F.c2p=y;F.p2c=function(a){var c={},b,d,e;for(b=0;b<Q.length;++b)if((d=Q[b])&&
d.used&&(e="x"+d.n,null==a[e]&&1==d.n&&(e="x"),null!=a[e])){c.left=d.p2c(a[e]);break}for(b=0;b<X.length;++b)if((d=X[b])&&d.used&&(e="y"+d.n,null==a[e]&&1==d.n&&(e="y"),null!=a[e])){c.top=d.p2c(a[e]);break}return c};F.getOptions=function(){return m};F.highlight=la;F.unhighlight=ka;F.triggerRedrawOverlay=ga;F.pointOffset=function(a){return{left:parseInt(Q[q(a,"x")-1].p2c(+a.x)+u.left,10),top:parseInt(X[q(a,"y")-1].p2c(+a.y)+u.top,10)}};F.shutdown=function(){ja&&clearTimeout(ja);aa.unbind("mousemove",
ra);aa.unbind("mouseleave",Y);aa.unbind("click",sa);h(V.shutdown,[aa])};F.resize=function(){var b=a.width(),d=a.height();L.resize(b,d);ha.resize(b,d)};F.hooks=V;(function(){for(var a={Canvas:B},c=0;c<k.length;++c){var b=k[c];b.init(F,a);b.options&&d.extend(!0,m,b.options)}})(F);(function(b){d.extend(!0,m,b);null==m.xaxis.color&&(m.xaxis.color=d.color.parse(m.grid.color).scale("a",0.22).toString());null==m.yaxis.color&&(m.yaxis.color=d.color.parse(m.grid.color).scale("a",0.22).toString());null==m.xaxis.tickColor&&
(m.xaxis.tickColor=m.grid.tickColor||m.xaxis.color);null==m.yaxis.tickColor&&(m.yaxis.tickColor=m.grid.tickColor||m.yaxis.color);null==m.grid.borderColor&&(m.grid.borderColor=m.grid.color);null==m.grid.tickColor&&(m.grid.tickColor=d.color.parse(m.grid.color).scale("a",0.22).toString());var e,f,g={style:a.css("font-style"),size:Math.round(0.8*(+a.css("font-size").replace("px","")||13)),variant:a.css("font-variant"),weight:a.css("font-weight"),family:a.css("font-family")};g.lineHeight=1.15*g.size;f=
m.xaxes.length||1;for(b=0;b<f;++b)(e=m.xaxes[b])&&!e.tickColor&&(e.tickColor=e.color),e=d.extend(!0,{},m.xaxis,e),m.xaxes[b]=e,e.font&&(e.font=d.extend({},g,e.font),e.font.color||(e.font.color=e.color));f=m.yaxes.length||1;for(b=0;b<f;++b)(e=m.yaxes[b])&&!e.tickColor&&(e.tickColor=e.color),e=d.extend(!0,{},m.yaxis,e),m.yaxes[b]=e,e.font&&(e.font=d.extend({},g,e.font),e.font.color||(e.font.color=e.color));m.xaxis.noTicks&&null==m.xaxis.ticks&&(m.xaxis.ticks=m.xaxis.noTicks);m.yaxis.noTicks&&null==
m.yaxis.ticks&&(m.yaxis.ticks=m.yaxis.noTicks);m.x2axis&&(m.xaxes[1]=d.extend(!0,{},m.xaxis,m.x2axis),m.xaxes[1].position="top");m.y2axis&&(m.yaxes[1]=d.extend(!0,{},m.yaxis,m.y2axis),m.yaxes[1].position="right");m.grid.coloredAreas&&(m.grid.markings=m.grid.coloredAreas);m.grid.coloredAreasColor&&(m.grid.markingsColor=m.grid.coloredAreasColor);m.lines&&d.extend(!0,m.series.lines,m.lines);m.points&&d.extend(!0,m.series.points,m.points);m.bars&&d.extend(!0,m.series.bars,m.bars);null!=m.shadowSize&&
(m.series.shadowSize=m.shadowSize);null!=m.highlightColor&&(m.series.highlightColor=m.highlightColor);for(b=0;b<m.xaxes.length;++b)I(Q,b+1).options=m.xaxes[b];for(b=0;b<m.yaxes.length;++b)I(X,b+1).options=m.yaxes[b];for(var k in V)m.hooks[k]&&m.hooks[k].length&&(V[k]=V[k].concat(m.hooks[k]));h(V.processOptions,[m])})(b);(function(){a.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove();"static"==a.css("position")&&a.css("position","relative");L=new B("flot-base",a);ha=new B("flot-overlay",
a);n=L.context;U=ha.context;aa=d(ha.element).unbind();var b=a.data("plot");b&&(b.shutdown(),ha.clear());a.data("plot",F)})();g(e);v();p();m.grid.hoverable&&(aa.mousemove(ra),aa.bind("mouseleave",Y));m.grid.clickable&&aa.click(sa);h(V.bindEvents,[aa]);var ba=[],ja=null}var a=Object.prototype.hasOwnProperty;B.prototype.resize=function(a,e){if(0>=a||0>=e)throw Error("Invalid dimensions for plot, width = "+a+", height = "+e);var b=this.element,d=this.context,h=this.pixelRatio;this.width!=a&&(b.width=
a*h,b.style.width=a+"px",this.width=a);this.height!=e&&(b.height=e*h,b.style.height=e+"px",this.height=e);d.restore();d.save();d.scale(h,h)};B.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};B.prototype.render=function(){var c=this._textCache,e;for(e in c)if(a.call(c,e)){var b=this.getTextLayer(e),d=c[e];b.hide();for(var h in d)if(a.call(d,h)){var g=d[h],q;for(q in g)if(a.call(g,q)){var r=g[q];r.active?r.rendered||(b.append(r.element),r.rendered=!0):(delete g[q],r.rendered&&
r.element.detach())}}b.show()}};B.prototype.getTextLayer=function(a){var e=this.text[a];null==e&&(null==this.textContainer&&(this.textContainer=d("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),e=this.text[a]=d("<div></div>").addClass(a).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer));return e};B.prototype.getTextInfo=function(a,e,b,k){var h,g;e=""+e;k=
"object"===typeof b?b.style+" "+b.variant+" "+b.weight+" "+b.size+"px/"+b.lineHeight+"px "+b.family:b;h=this._textCache[a];null==h&&(h=this._textCache[a]={});g=h[k];null==g&&(g=h[k]={});h=g[e];null==h&&(a=d("<div></div>").html(e).css({position:"absolute",top:-9999}).appendTo(this.getTextLayer(a)),"object"===typeof b?a.css({font:k,color:b.color}):"string"===typeof b&&a.addClass(b),h=g[e]={active:!1,rendered:!1,element:a,width:a.outerWidth(!0),height:a.outerHeight(!0)},a.detach());return h};B.prototype.addText=
function(a,d,b,k,h,g,q,r){a=this.getTextInfo(a,k,h,g);a.active=!0;"center"==q?d-=a.width/2:"right"==q&&(d-=a.width);"middle"==r?b-=a.height/2:"bottom"==r&&(b-=a.height);a.element.css({top:Math.round(b),left:Math.round(d)})};B.prototype.removeText=function(c,d,b,k){if(null==d){if(c=this._textCache[c],null!=c)for(var h in c)if(a.call(c,h)){d=c[h];for(var g in d)a.call(d,g)&&(d[g].active=!1)}}else this.getTextInfo(c,d,b,k).active=!1};d.plot=function(a,e,b){return new z(d(a),e,b,d.plot.plugins)};d.plot.version=
"0.8.0";d.plot.plugins=[];d.fn.plot=function(a,e){return this.each(function(){d.plot(this,a,e)})}})(jQuery);
(function(d){var B=10,z=0.95,a={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:0.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(a,d){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+d.color+";'>"+a+"<br/>"+Math.round(d.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:0.5}}}};d.plot.plugins.push({init:function(c){function e(b){for(var c=
0,e=0,g=0,k=a.series.pie.combine.color,h=[],q=0;q<b.length;++q){var r=b[q].data;d.isArray(r)?d.isNumeric(r[1])?r[1]=+r[1]:r[1]=0:r=d.isNumeric(r)?[1,+r]:[1,0];b[q].data=[r]}for(q=0;q<b.length;++q)c+=b[q].data[0][1];for(q=0;q<b.length;++q)r=b[q].data[0][1],r/c<=a.series.pie.combine.threshold&&(e+=r,g++,k||(k=b[q].color));for(q=0;q<b.length;++q)r=b[q].data[0][1],(2>g||r/c>a.series.pie.combine.threshold)&&h.push({data:[[1,r]],color:b[q].color,label:b[q].label,angle:2*r*Math.PI/c,percent:r/(c/100)});
1<g&&h.push({data:[[1,e]],color:k,label:a.series.pie.combine.label,angle:2*e*Math.PI/c,percent:e/(c/100)});return h}function b(b,c){function e(){v.clearRect(0,0,q,r);I.children().filter(".pieLabel, .pieLabelBackground").remove()}function g(){var b=a.series.pie.shadow.left,c=a.series.pie.shadow.top,d=a.series.pie.shadow.alpha,e=1<a.series.pie.radius?a.series.pie.radius:H*a.series.pie.radius;if(!(e>=q/2-b||e*a.series.pie.tilt>=r/2-c||10>=e)){v.save();v.translate(b,c);v.globalAlpha=d;v.fillStyle="#000";
v.translate(C,K);v.scale(1,a.series.pie.tilt);for(b=1;10>=b;b++)v.beginPath(),v.arc(0,0,e,0,2*Math.PI,!1),v.fill(),e-=b;v.restore()}}function h(){function b(a,c,d){0>=a||isNaN(a)||(d?v.fillStyle=c:(v.strokeStyle=c,v.lineJoin="round"),v.beginPath(),1E-9<Math.abs(a-2*Math.PI)&&v.moveTo(0,0),v.arc(0,0,g,p,p+a/2,!1),v.arc(0,0,g,p+a/2,p+a,!1),v.closePath(),p+=a,d?v.fill():v.stroke())}function c(){for(var b=e,g=1<a.series.pie.label.radius?a.series.pie.label.radius:H*a.series.pie.label.radius,k=0;k<T.length;++k){if(T[k].percent>=
100*a.series.pie.label.threshold){var h;h=T[k];var p=b,x=k;if(0==h.data[0][1])h=!0;else{var v=a.legend.labelFormatter,m=void 0,y=a.series.pie.label.formatter,m=v?v(h.label,h):h.label;y&&(m=y(m,h));v=(p+h.angle+p)/2;p=C+Math.round(Math.cos(v)*g);v=K+Math.round(Math.sin(v)*g)*a.series.pie.tilt;I.append("<span class='pieLabel' id='pieLabel"+x+"' style='position:absolute;top:"+v+"px;left:"+p+"px;'>"+m+"</span>");x=I.children("#pieLabel"+x);m=v-x.height()/2;v=p-x.width()/2;x.css("top",m);x.css("left",
v);0<0-m||0<0-v||0>r-(m+x.height())||0>q-(v+x.width())?h=!1:(0!=a.series.pie.label.background.opacity&&(p=a.series.pie.label.background.color,null==p&&(p=h.color),h="top:"+m+"px;left:"+v+"px;",d("<div class='pieLabelBackground' style='position:absolute;width:"+x.width()+"px;height:"+x.height()+"px;"+h+"background-color:"+p+";'></div>").css("opacity",a.series.pie.label.background.opacity).insertBefore(x)),h=!0)}if(!h)return!1}b+=T[k].angle}return!0}var e=Math.PI*a.series.pie.startAngle,g=1<a.series.pie.radius?
a.series.pie.radius:H*a.series.pie.radius;v.save();v.translate(C,K);v.scale(1,a.series.pie.tilt);v.save();for(var p=e,x=0;x<T.length;++x)T[x].startAngle=p,b(T[x].angle,T[x].color,!0);v.restore();if(0<a.series.pie.stroke.width){v.save();v.lineWidth=a.series.pie.stroke.width;p=e;for(x=0;x<T.length;++x)b(T[x].angle,a.series.pie.stroke.color,!1);v.restore()}k(v);v.restore();return a.series.pie.label.show?c():!0}if(I){var q=b.getPlaceholder().width(),r=b.getPlaceholder().height(),y=I.children().filter(".legend").children().width()||
0;v=c;O=!1;H=Math.min(q,r/a.series.pie.tilt)/2;K=r/2+a.series.pie.offset.top;C=q/2;C="auto"==a.series.pie.offset.left?a.legend.position.match("w")?C+y/2:C-y/2:C+a.series.pie.offset.left;C<H?C=H:C>q-H&&(C=q-H);var T=b.getData(),y=0;do 0<y&&(H*=z),y+=1,e(),0.8>=a.series.pie.tilt&&g();while(!h()&&y<B);y>=B&&(e(),I.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>"));b.setSeries&&b.insertLegend&&(b.setSeries(T),b.insertLegend())}}function k(b){if(0<a.series.pie.innerRadius){b.save();
var c=1<a.series.pie.innerRadius?a.series.pie.innerRadius:H*a.series.pie.innerRadius;b.globalCompositeOperation="destination-out";b.beginPath();b.fillStyle=a.series.pie.stroke.color;b.arc(0,0,c,0,2*Math.PI,!1);b.fill();b.closePath();b.restore();b.save();b.beginPath();b.strokeStyle=a.series.pie.stroke.color;b.arc(0,0,c,0,2*Math.PI,!1);b.stroke();b.closePath();b.restore()}}function h(a){q("plothover",a)}function g(a){q("plotclick",a)}function q(b,d){var e=c.offset(),g=parseInt(d.pageX-e.left);a:{for(var e=
parseInt(d.pageY-e.top),h=c.getData(),k=c.getOptions(),k=1<k.series.pie.radius?k.series.pie.radius:H*k.series.pie.radius,q,y,z=0;z<h.length;++z){var A=h[z];if(A.pie.show){v.save();v.beginPath();v.moveTo(0,0);v.arc(0,0,k,A.startAngle,A.startAngle+A.angle/2,!1);v.arc(0,0,k,A.startAngle+A.angle/2,A.startAngle+A.angle,!1);v.closePath();q=g-C;y=e-K;if(v.isPointInPath){if(v.isPointInPath(g-C,e-K)){v.restore();g={datapoint:[A.percent,A.data],dataIndex:0,series:A,seriesIndex:z};break a}}else{var B=k*Math.cos(A.startAngle),
Y=k*Math.sin(A.startAngle),O=k*Math.cos(A.startAngle+A.angle/4),$=k*Math.sin(A.startAngle+A.angle/4),ga=k*Math.cos(A.startAngle+A.angle/2),ma=k*Math.sin(A.startAngle+A.angle/2),la=k*Math.cos(A.startAngle+A.angle/1.5),ka=k*Math.sin(A.startAngle+A.angle/1.5),na=k*Math.cos(A.startAngle+A.angle),pa=k*Math.sin(A.startAngle+A.angle),B=[[0,0],[B,Y],[O,$],[ga,ma],[la,ka],[na,pa]];q=[q,y];y=!1;Y=-1;O=B.length;for($=O-1;++Y<O;$=Y)(B[Y][1]<=q[1]&&q[1]<B[$][1]||B[$][1]<=q[1]&&q[1]<B[Y][1])&&q[0]<(B[$][0]-B[Y][0])*
(q[1]-B[Y][1])/(B[$][1]-B[Y][1])+B[Y][0]&&(y=!y);if(y){v.restore();g={datapoint:[A.percent,A.data],dataIndex:0,series:A,seriesIndex:z};break a}}v.restore()}}g=null}if(a.grid.autoHighlight)for(e=0;e<R.length;++e)h=R[e],h.auto!=b||g&&h.series==g.series||(h=h.series,null==h&&(R=[],c.triggerRedrawOverlay()),h=r(h),-1!=h&&(R.splice(h,1),c.triggerRedrawOverlay()));g&&(e=g.series,h=r(e),-1==h?(R.push({series:e,auto:b}),c.triggerRedrawOverlay()):b||(R[h].auto=!1));I.trigger(b,[{pageX:d.pageX,pageY:d.pageY},
g])}function r(a){for(var b=0;b<R.length;++b)if(R[b].series==a)return b;return-1}var y=null,I=null,H=null,C=null,K=null,O=!1,v=null,R=[];c.hooks.processOptions.push(function(a,b){b.series.pie.show&&(b.grid.show=!1,"auto"==b.series.pie.label.show&&(b.series.pie.label.show=b.legend.show?!1:!0),"auto"==b.series.pie.radius&&(b.series.pie.radius=b.series.pie.label.show?0.75:1),1<b.series.pie.tilt?b.series.pie.tilt=1:0>b.series.pie.tilt&&(b.series.pie.tilt=0))});c.hooks.bindEvents.push(function(a,b){var c=
a.getOptions();c.series.pie.show&&(c.grid.hoverable&&b.unbind("mousemove").mousemove(h),c.grid.clickable&&b.unbind("click").click(g))});c.hooks.processDatapoints.push(function(b,c,g,k){b.getOptions().series.pie.show&&!O&&(O=!0,y=b.getCanvas(),I=d(y).parent(),a=b.getOptions(),b.setData(e(b.getData())))});c.hooks.drawOverlay.push(function(a,b){if(a.getOptions().series.pie.show){var c=a.getOptions(),d=1<c.series.pie.radius?c.series.pie.radius:H*c.series.pie.radius;b.save();b.translate(C,K);b.scale(1,
c.series.pie.tilt);for(var e=0;e<R.length;++e){var g=R[e].series;0>=g.angle||isNaN(g.angle)||(b.fillStyle="rgba(255, 255, 255, "+c.series.pie.highlight.opacity+")",b.beginPath(),1E-9<Math.abs(g.angle-2*Math.PI)&&b.moveTo(0,0),b.arc(0,0,d,g.startAngle,g.startAngle+g.angle/2,!1),b.arc(0,0,d,g.startAngle+g.angle/2,g.startAngle+g.angle,!1),b.closePath(),b.fill())}k(b);b.restore()}});c.hooks.draw.push(function(a,c){a.getOptions().series.pie.show&&b(a,c)})},options:a,name:"pie",version:"1.1"})})(jQuery);
(function(d,B){var z=0;d.widget("s3.pivottable",{options:{showTotals:!0,collapseForm:!0,ajaxURL:null,defaultChart:null,showChart:!1},_create:function(){this.id=z;z+=1;this.chart=this.table=null},_init:function(){var a=this.element;this.table=this.data=null;this.chart_options={currentChart:null,currentDataIndex:null,currentSeriesIndex:null};this.table_options={hidden:!1};var c=d(a).find(".pt-chart");this.chart=c.length?c.first():null;this.options.collapseForm&&(a=d(a).attr("id"),d("#"+a+"-options legend").siblings().toggle(),
d("#"+a+"-options legend").children().toggle());this.refresh()},_destroy:function(){this.table&&this.table.remove();this.chart&&this.chart.empty()},refresh:function(){var a=this.element,c=null;this._unbindEvents();var e=d(a).find('input[type="hidden"][name="pivotdata"]');e.length&&(c=JSON.parse(d(e).first().val()));c||(c={empty:!0},d(a).find(".pt-hide-table").hide(),d(a).find(".pt-show-table").hide(),d(a).find(".pt-empty").show());this.data=c;c.nodata?(d(a).find(".pt-table").first().empty().append(d('<div class="pt-no-data">'+
c.nodata+"</div>")),d(a).find(".pt-hide-table").hide(),d(a).find(".pt-show-table").hide(),d(a).find(".pt-empty").hide()):(this._renderTable(),this._renderChartOptions());this._renderChart();this._bindEvents();d(a).find(".pt-throbber").hide()},_renderTable:function(){var a=this.element,c=d(a).find(".pt-table").first().empty();this.table=null;var e=this.data;if(!e.empty){var b=e.cells,k=e.cols,h=e.rows,g=e.total,q=e.labels,e=this._renderHeader(k,q);e.append(this._renderColumns(k,q));b=this._renderRows(h,
k,q,b);k=this._renderFooter(h,k,q,g);h=d('<table class="dataTable display report"/>').append(e).append(b);null!==k&&h.append(k);this.table=d(h);d(c).append(this.table);d(a).find(".pt-empty").hide();this.table_options.hidden?(d(a).find(".pt-show-table").show(),d(a).find(".pt-hide-table").hide()):(d(a).find(".pt-show-table").hide(),d(a).find(".pt-hide-table").show())}},_renderHeader:function(a,c){var e=d("<tr>");colspan="__other__"==a[a.length-1][0]?a.length-1:a.length;e.append(d('<th scope="col">'+
c.layer+"</th>"));(1<a.length||a[0][4])&&e.append(d('<th scope="col" colspan="'+colspan+'">'+c.cols+"</th>"));this.options.showTotals&&e.append(d('<th class="totals_header row_totals" scope="col" rowspan="2">'+c.total+"</th>"));return d("<thead>").append(e)},_renderColumns:function(a,c){var e=d("<tr>"),b;e.append(d('<th scope="col">'+c.rows+"</th>"));for(var k=1==a.length&&null===a[0][4]?!0:!1,h=0;h<a.length;h++)"__other__"==a[h][0]||k&&this.options.showTotals||(b=k?"":a[h][4],e.append(d('<th scope="col">'+
b+"</th>")));return e},_renderRows:function(a,c,e,b){for(var k=d("<tbody>"),h=this.options.showTotals,g=1==a.length&&null===a[0][4]?!0:!1,q,r,y=0;y<b.length;y++)q=a[y],"__other__"==q[0]||g&&this.options.showTotals||(r=g?"":a[y][4],r=d('<tr class="'+(y%2?"odd":"even")+'"><td>'+r+"</td></tr>").append(this._renderCells(b[y],c,e)),h&&r.append(d("<td>"+q[2]+"</td>")),k.append(r));return k},_renderCells:function(a,c,e){for(var b,k=e.none,h=1==c.length&&null===c[0][4]?!0:!1,g=[],q,r,y=0;y<a.length;y++)if(!("__other__"==
c[y][0]||h&&this.options.showTotals)){b=a[y];e=b.items;q=d("<td>");if(null===e)r=d('<div class="pt-cell-value">'+k+"</div>");else if(d.isArray(e)){r=d('<div class="pt-cell-value">');list=d("<ul>");for(var I=0;I<e.length;I++)list.append(d("<li>"+e[I]+"</li>"));r.append(list)}else r=d('<div class="pt-cell-value">'+e+"</div>");q.append(r);b=b.keys;e&&(b&&b.length)&&q.data("records",b).append(d('<div class="pt-cell-zoom"></div>'));g.push(q)}return g},_renderFooter:function(a,c,e,b){var k=1==c.length&&
null===c[0][4]?!0:!1;if(this.options.showTotals){var h,g;g=h=0;for(len=a.length;h<len;h++)"__other__"!=a[h][0]&&g++;a=d('<tr class="'+(g%2?"odd":"even")+' totals_row"><th class="totals_header" scope="row">'+e.total+"</th></tr>");for(h=0;h<c.length;h++)"__other__"==c[h][0]||k||a.append(d("<td>"+c[h][2]+"</td>"));a.append(d("<td>"+b+"</td>"));return d("<tfoot>").append(a)}return null},_renderChartOptions:function(){var a=this.element,c=d(a).find(".pt-chart-controls").first().empty(),e=this.data;if(!e.empty){var e=
e.labels,b=d(a).attr("id"),a=e.layer,k=e.rows,h=e.cols,g=e.per,q=d('<div class="pt-chart-opts">'),r=b+"-pchart-rows",y=b+"-vchart-rows",I=b+"-hchart-rows",H=b+"-pchart-cols",C=b+"-vchart-cols",b=b+"-hchart-cols";a&&d(q).append(d('<span class="pt-chart-label">'+a+"</span>"));k&&d(q).append(d('<div id="'+r+'" class="pt-chart-icon pt-pchart"/><div id="'+y+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+g+" "+k+"</span>"));h&&d(q).append(d('<div id="'+H+'" class="pt-chart-icon pt-pchart"/><div id="'+
C+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+g+" "+h+"</span>"));k&&h&&d(q).append(d('<span class="pt-chart-label">| '+e.breakdown+'</span><div id="'+I+'" class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+[g,k,"&amp;",h].join(" ")+'</span><div id="'+b+'"  class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+[g,h,"&amp;",k].join(" ")+"</span>"));d(c).append(q)}},_renderChart:function(a){var c=this.data;d(this.element).find(".pt-chart-contents").hide();
var e=this.chart;if(e&&(d(e).unbind("plothover").unbind("plotclick").empty(),!c.empty))if(!1===a)this.options.showChart=!1;else{e=this.options.showChart;if("undefined"==typeof a||!a){if(!e)return;a=this.chart_options.currentChart}if("undefined"==typeof a||!a){if(!e)return;a=this.options.defaultChart}if("undefined"!=typeof a&&a){this.options.showChart=!0;this.chart_options.currentChart=a;e=a.type;a=a.axis;var b=c.labels,k=b.per,h=b.layer+" "+k+" "+b.rows,b=b.layer+" "+k+" "+b.cols,k=c.filter,g=k[0],
q=k[1],r=k[2];"piechart"==e?"rows"==a?this._renderPieChart(c.rows,h,g,q):this._renderPieChart(c.cols,b,g,r):"barchart"==e?"rows"==a?this._renderBarChart(c.rows,h,g,q):this._renderBarChart(c.cols,b,g,r):"breakdown"==e&&("rows"==a?this._renderBreakDown(c,0,h,k):this._renderBreakDown(c,1,b,k))}}},_renderPieChart:function(a,c,e,b){var k=this.chart;if(k){d(k).closest(".pt-chart-contents").show().css({width:"800px"});d(k).css({height:"360px"});for(var h=[],g=0;g<a.length;g++){var q=a[g];q[1]||h.push({label:q[4],
data:q[2],key:q[3]})}c?d(k).siblings(".pt-chart-title").html("<h4>"+c+"</h4>"):d(k).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(k),h,{series:{pie:{show:!0,radius:125}},legend:{show:!0,position:"ne"},grid:{hoverable:!0,clickable:!0}});var r=this;this.chart_options.currentDataIndex=null;d(k).bind("plothover",function(a,b,c){if(c){if(r.chart_options.currentDataIndex!=c.seriesIndex){r._removeChartTooltip();r.chart_options.currentDataIndex=c.seriesIndex;a=c.series.data[0][1];var e=c.series.percent.toFixed(1),
g='<div class="pt-tooltip-label">'+c.series.label+"</div>";r._renderChartTooltip(b.pageX,b.pageY,g+('<div class="pt-tooltip-text">'+a+" ("+e+"%)</div>"));d(".pt-tooltip-label").css({color:c.series.color})}}else r._removeChartTooltip()});e&&b&&d(k).bind("plotclick",function(a,c,d){if(d){a={};try{a[b]=h[d.seriesIndex].key}catch(g){return}d=r._updateURL(e,a);window.open(d,"_blank")}})}},_renderBarChart:function(a,c,e,b){var k=this.chart;if(k){d(k).closest(".pt-chart-contents").show().css({width:"96%"});
d(k).css({height:"360px"});for(var h=[],g=[],q=0,r=0;r<a.length;r++){var y=a[r];y[1]||(h.push({label:y[4],data:[[q+1,y[2]]],key:y[3]}),g.push([q+1,y[4]]),q++)}c?d(k).siblings(".pt-chart-title").html("<h4>"+c+"</h4>"):d(k).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(k),h,{series:{bars:{show:!0,barWidth:0.6,align:"center"}},legend:{show:!1,position:"ne"},grid:{hoverable:!0,clickable:!0},xaxis:{ticks:g,min:0,max:h.length+1,tickLength:0}});var z=this;this.chart_options.currentDataIndex=
null;d(k).bind("plothover",function(a,b,c){c?z.chart_options.currentDataIndex!=c.seriesIndex&&(z._removeChartTooltip(),z.chart_options.currentDataIndex=c.seriesIndex,a='<div class="pt-tooltip-label">'+c.series.label+"</div>",a+='<div class="pt-tooltip-text">'+c.series.data[0][1]+"</div>",z._renderChartTooltip(b.pageX,b.pageY,a),d(".pt-tooltip-label").css({color:c.series.color})):z._removeChartTooltip()});e&&b&&d(k).bind("plotclick",function(a,c,d){if(d){a={};try{a[b]=h[d.seriesIndex].key}catch(g){return}d=
z._updateURL(e,a);window.open(d,"_blank")}})}},_renderBreakDown:function(a,c,e,b){var k=this.chart;if(k){d(k).closest(".pt-chart-contents").show().css({width:"96%"});var h=b[0],g,q,r=a.cells,y,z=[],B=[];0===c?(c=a.rows,y=a.cols,a=function(a,b){return r[z[a]][B[b]].value},g=b[1],q=b[2]):(c=a.cols,y=a.rows,a=function(a,b){return r[B[b]][z[a]].value},g=b[2],q=b[1]);var C=[],K=[];b=0;for(len=c.length;b<len;b++)c[b][1]||(C.push(c[b]),z.push(b));b=0;for(len=y.length;b<len;b++)y[b][1]||(K.push(y[b]),B.push(b));
b=Math.max(C.length*Math.max(16*(K.length+1),50)+70,360);d(k).css({height:b+"px"});b=[];for(var O=c=0;O<K.length;O++){for(var v={label:K[O][4]},R=[],p,x=0;x<C.length;x++)y=(C.length-x)*(K.length+1)-O,p=a(x,O),p>c&&(c=p),R.push([p,y]);v.data=R;b.push(v)}a=[];for(x=0;x<C.length;x++)O=C[x][4],y=(C.length-x)*(K.length+1)+1,a.push([y,O]);e?d(k).siblings(".pt-chart-title").html("<h4>"+e+"</h4>"):d(k).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(k),b,{series:{bars:{show:!0,barWidth:0.8,
align:"center",horizontal:!0}},legend:{show:!0,position:"ne"},yaxis:{ticks:a,labelWidth:120,max:C.length*(K.length+1)+1},xaxis:{max:1.1*c},grid:{hoverable:!0,clickable:!0}});d(".flot-y-axis .tickLabel").css({"padding-top":"20px",left:"0px",width:"120px"});var J=this;this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null;d(k).bind("plothover",function(a,b,c){if(c){if(J.chart_options.currentDataIndex!=c.dataIndex||J.chart_options.currentSeriesIndex!=c.seriesIndex)J._removeChartTooltip(),
J.chart_options.currentDataIndex=c.dataIndex,J.chart_options.currentSeriesIndex=c.seriesIndex,a='<div class="pt-tooltip-label">'+C[c.dataIndex][4]+"</div>",a+='<div class="pt-tooltip-text">'+c.series.label+' : <span class="pt-tooltip-value">'+c.datapoint[0]+"</span></div>",J._renderChartTooltip(b.pageX,b.pageY,a),d(".pt-tooltip-label").css({"padding-bottom":"8px"}),d(".pt-tooltip-text").css({color:c.series.color}),d(".pt-tooltip-value").css({"font-weight":"bold"})}else J._removeChartTooltip()});h&&
(g&&q)&&d(k).bind("plotclick",function(a,b,c){if(c){a={};try{a[g]=C[c.dataIndex][3],a[q]=K[c.seriesIndex][3]}catch(d){return}c=J._updateURL(h,a);window.open(c,"_blank")}})}},_renderChartTooltip:function(a,c,e){d('<div class="pt-chart-tooltip">'+e+"</div>").css({position:"absolute",display:"none",top:c-50,left:a+10,border:"1px solid #999",padding:"10px","min-height":"50px","max-width":"240px","z-index":"501","background-color":"white",color:"#000",opacity:0.95}).appendTo("body").fadeIn(200)},_removeChartTooltip:function(){d(".pt-chart-tooltip").remove();
this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null},_getOptions:function(){var a="#"+d(this.element).attr("id");return{rows:d(a+"-rows").val(),cols:d(a+"-cols").val(),fact:d(a+"-fact").val(),totals:d(a+"-totals").is(":checked")?1:0}},_getFilters:function(){var a="#"+d(this.element).attr("id"),c=d(a+"-filters"),a=[];try{if(c.length)a=S3.search.getCurrentFilters(c.first());else return null}catch(e){}for(var c={},b=0,k=a.length,h;b<k;b++)h=a[b].split("="),1<h.length&&
(c[h[0]]=h[1]);return c},_updateURL:function(a,c){var d=a.split("?"),b={};if(1<d.length){var k=d[1].split("&"),h,g,q;g=0;for(q=k.length;g<q;g++)h=k[g].split("="),1<h.length&&(b[decodeURIComponent(h[0])]=decodeURIComponent(h[1]))}if(c)for(option in c)newopt=c[option],b[option]=newopt?newopt:null;k=[];for(option in b)null!==b[option]&&k.push(option+"="+b[option]);b=k.join("&");d=d[0];b&&(d=d+"?"+b);return d},_updateAjaxURL:function(a,c){var d=this.options.ajaxURL.split("?"),b={};if(1<d.length){var k=
d[1].split("&"),h,g,q;g=0;for(q=k.length;g<q;g++)h=k[g].split("="),1<h.length&&"aggregate"!=h[0]&&(b[decodeURIComponent(h[0])]=decodeURIComponent(h[1]))}k=!1;if(a)for(option in a)h=a[option],"totals"==option?this.options.showTotals=h?!0:!1:b[option]!=h&&(k=!0),b[option]=h?h:null;if(c){for(option in c)h=c[option],b[option]!=h&&(k=!0),b[option]=h?h:null;for(option in b)a.hasOwnProperty(option)||(h=c[option],b[option]!=h&&(k=!0),b[option]=h?h:null)}h=[];for(option in b)null!==b[option]&&h.push(option+
"="+b[option]);b=h.join("&");d=d[0];b&&(d=d+"?"+b);this.options.ajaxURL=d;return k},reload:function(a,c,e){e="undefined"!=typeof e?e:!0;"undefined"==typeof c&&(c=this._getFilters());var b=this,k=this.element,h,g=d(k).find('input[type="hidden"][name="pivotdata"]');if(g.length){if(a||c)h=this._updateAjaxURL(a,c);h||e?(a=this.options.ajaxURL,d(k).find(".pt-throbber").show(),d.ajax({url:a,dataType:"json"}).done(function(a){g.first().val(JSON.stringify(a));b.refresh()}).fail(function(a,b,c){msg="UNAUTHORIZED"==
c?i18n.gis_requires_login:a.responseText;console.log(msg)})):(d(k).find(".pt-throbber").show(),b.refresh())}},_bindEvents:function(a){var c=this,e=this.element;a=this.data;var b=d(e).attr("id");d("#"+b+"-options legend").click(function(){d(this).siblings().toggle();d(this).children().toggle()});d("#"+b+"-filters legend").click(function(){d(this).siblings().toggle();d(this).children().toggle()});d(e).find(".pt-hide-table").click(function(){c.table_options.hidden=!0;d(e).find(".pt-table").hide();d(this).siblings(".pt-show-table").show();
d(this).hide()});d(e).find(".pt-show-table").click(function(){c.table_options.hidden=!1;d(e).find(".pt-table").show();d(this).siblings(".pt-hide-table").show();d(this).hide()});d("#"+b+"-totals").click(function(){var a=d(this).is(":checked");c.options.showTotals!=a&&c.reload({totals:a},null,!1)});d(e).find("input.pt-submit").click(function(){var a=c._getOptions(),b=c._getFilters();c.reload(a,b,!1)});d("#"+b+" div.pt-table div.pt-cell-zoom").click(function(b){b=d(b.currentTarget);var c=b.closest("td"),
e=c.find(".pt-cell-records");if(0<e.length)e.remove(),b.removeClass("opened");else{for(var q=c.data("records"),e=d("<div/>").addClass("pt-cell-records"),r=d("<ul/>"),y=0;y<q.length;y++)r.append("<li>"+a.lookup[q[y]]+"</li>");e.append(r);c.append(e);b.addClass("opened")}});d("#"+b+"-pchart-rows").click(function(){c._renderChart({type:"piechart",axis:"rows"})});d("#"+b+"-vchart-rows").click(function(){c._renderChart({type:"barchart",axis:"rows"})});d("#"+b+"-pchart-cols").click(function(){c._renderChart({type:"piechart",
axis:"cols"})});d("#"+b+"-vchart-cols").click(function(){c._renderChart({type:"barchart",axis:"cols"})});d("#"+b+"-hchart-rows").click(function(){c._renderChart({type:"breakdown",axis:"rows"})});d("#"+b+"-hchart-cols").click(function(){c._renderChart({type:"breakdown",axis:"cols"})});d(e).find(".pt-hide-chart").click(function(){c._renderChart(!1)})},_unbindEvents:function(){var a=this.element,c=d(a).attr("id");d(a).find("input.pt-submit").unbind("click");d("#"+c+" div.pt-table div.pt-cell-zoom").unbind("click");
d("#"+c+"-options legend").unbind("click");d("#"+c+"-filters legend").unbind("click");d(c+"-totals").unbind("click");d("#"+c+"-pchart-rows").unbind("click");d("#"+c+"-vchart-rows").unbind("click");d("#"+c+"-pchart-cols").unbind("click");d("#"+c+"-vchart-cols").unbind("click");d(a).find(".pt-hide-table").unbind("click");d(a).find(".pt-show-table").unbind("click");d(a).find(".pt-hide-chart").unbind("click")}})})(jQuery);
