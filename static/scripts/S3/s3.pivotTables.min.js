/*
: 2013 (c) Sahana Software Foundation
 @license: MIT

 requires: jQuery 1.9.1+
 requires: jQuery UI 1.10 widget factory

*/
(function(c){c.color={};c.color.make=function(C,a,e,d){var b={};b.r=C||0;b.g=a||0;b.b=e||0;b.a=null!=d?d:1;b.add=function(c,a){for(var e=0;e<c.length;++e)b[c.charAt(e)]+=a;return b.normalize()};b.scale=function(c,a){for(var e=0;e<c.length;++e)b[c.charAt(e)]*=a;return b.normalize()};b.toString=function(){return 1<=b.a?"rgb("+[b.r,b.g,b.b].join()+")":"rgba("+[b.r,b.g,b.b,b.a].join()+")"};b.normalize=function(){function c(a,e,b){return e<a?a:e>b?b:e}b.r=c(0,parseInt(b.r),255);b.g=c(0,parseInt(b.g),255);
b.b=c(0,parseInt(b.b),255);b.a=c(0,b.a,1);return b};b.clone=function(){return c.color.make(b.r,b.b,b.g,b.a)};return b.normalize()};c.color.extract=function(C,a){var e;do{e=C.css(a).toLowerCase();if(""!=e&&"transparent"!=e)break;C=C.parent()}while(!c.nodeName(C.get(0),"body"));"rgba(0, 0, 0, 0)"==e&&(e="transparent");return c.color.parse(e)};c.color.parse=function(C){var a,e=c.color.make;if(a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(C))return e(parseInt(a[1],10),parseInt(a[2],
10),parseInt(a[3],10));if(a=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(C))return e(parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10),parseFloat(a[4]));if(a=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(C))return e(2.55*parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]));if(a=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(C))return e(2.55*
parseFloat(a[1]),2.55*parseFloat(a[2]),2.55*parseFloat(a[3]),parseFloat(a[4]));if(a=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(C))return e(parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16));if(a=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(C))return e(parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16));C=c.trim(C).toLowerCase();if("transparent"==C)return e(255,255,255,0);a=B[C]||[0,0,0];return e(a[0],a[1],a[2])};var B={aqua:[0,255,255],azure:[240,255,255],beige:[245,
245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,
144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);
(function(c){function B(a,d){var b=d.children("."+a)[0];if(null==b&&(b=document.createElement("canvas"),b.className=a,c(b).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(d),!b.getContext))if(window.G_vmlCanvasManager)b=window.G_vmlCanvasManager.initElement(b);else throw Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=
b;b=this.context=b.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1);this.resize(d.width(),d.height());this.textContainer=null;this.text={};this._textCache={}}function C(a,d,b,g){function h(m,s){s=[G].concat(s);for(var k=0;k<m.length;++k)m[k].apply(this,s)}function f(m){for(var s=[],k=0;k<m.length;++k){var a=c.extend(!0,{},n.series);null!=m[k].data?
(a.data=m[k].data,delete m[k].data,c.extend(!0,a,m[k]),m[k].data=a.data):a.data=m[k];s.push(a)}E=s;k=E.length;s=-1;for(m=0;m<E.length;++m)a=E[m].color,null!=a&&(k--,"number"==typeof a&&a>s&&(s=a));k<=s&&(k=s+1);var s=[],v=n.colors,e=v.length,b=0;for(m=0;m<k;m++)a=c.color.parse(v[m%e]||"#666"),0==m%e&&m&&(b=0<=b?0.5>b?-b-0.2:0:-b),s[m]=a.scale("rgb",1+b);for(m=k=0;m<E.length;++m){a=E[m];null==a.color?(a.color=s[k].toString(),++k):"number"==typeof a.color&&(a.color=s[a.color].toString());if(null==a.lines.show){var d,
v=!0;for(d in a)if(a[d]&&a[d].show){v=!1;break}v&&(a.lines.show=!0)}null==a.lines.zero&&(a.lines.zero=!!a.lines.fill);a.xaxis=q(O,l(a,"x"));a.yaxis=q(W,l(a,"y"))}H()}function l(m,a){var k=m[a+"axis"];"object"==typeof k&&(k=k.n);"number"!=typeof k&&(k=1);return k}function t(){return c.grep(O.concat(W),function(m){return m})}function r(m){var a={},k,c;for(k=0;k<O.length;++k)(c=O[k])&&c.used&&(a["x"+c.n]=c.c2p(m.left));for(k=0;k<W.length;++k)(c=W[k])&&c.used&&(a["y"+c.n]=c.c2p(m.top));void 0!==a.x1&&
(a.x=a.x1);void 0!==a.y1&&(a.y=a.y1);return a}function q(m,a){m[a-1]||(m[a-1]={n:a,direction:m==O?"x":"y",options:c.extend(!0,{},m==O?n.xaxis:n.yaxis)});return m[a-1]}function H(){function m(m,a,k){a<m.datamin&&a!=-e&&(m.datamin=a);k>m.datamax&&k!=e&&(m.datamax=k)}var a=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,e=Number.MAX_VALUE,v,b,F,d,w,n,I,g,p,f,l,L;c.each(t(),function(m,c){c.datamin=a;c.datamax=k;c.used=!1});for(v=0;v<E.length;++v)w=E[v],w.datapoints={points:[]},h(U.processRawData,
[w,w.data,w.datapoints]);for(v=0;v<E.length;++v){w=E[v];l=w.data;L=w.datapoints.format;if(!L){L=[];L.push({x:!0,number:!0,required:!0});L.push({y:!0,number:!0,required:!0});if(w.bars.show||w.lines.show&&w.lines.fill)L.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:!!(w.bars.show&&w.bars.zero||w.lines.show&&w.lines.zero)}),w.bars.horizontal&&(delete L[L.length-1].y,L[L.length-1].x=!0);w.datapoints.format=L}if(null==w.datapoints.pointsize){w.datapoints.pointsize=L.length;I=w.datapoints.pointsize;
n=w.datapoints.points;var da=w.lines.show&&w.lines.steps;w.xaxis.used=w.yaxis.used=!0;for(b=F=0;b<l.length;++b,F+=I){f=l[b];var ma=null==f;if(!ma)for(d=0;d<I;++d){g=f[d];if(p=L[d])p.number&&null!=g&&(g=+g,isNaN(g)?g=null:Infinity==g?g=e:-Infinity==g&&(g=-e)),null==g&&(p.required&&(ma=!0),null!=p.defaultValue&&(g=p.defaultValue));n[F+d]=g}if(ma)for(d=0;d<I;++d)g=n[F+d],null!=g&&(p=L[d],p.autoscale&&(p.x&&m(w.xaxis,g,g),p.y&&m(w.yaxis,g,g))),n[F+d]=null;else if(da&&0<F&&null!=n[F-I]&&n[F-I]!=n[F]&&
n[F-I+1]!=n[F+1]){for(d=0;d<I;++d)n[F+I+d]=n[F+d];n[F+1]=n[F-I+1];F+=I}}}}for(v=0;v<E.length;++v)w=E[v],h(U.processDatapoints,[w,w.datapoints]);for(v=0;v<E.length;++v){w=E[v];n=w.datapoints.points;I=w.datapoints.pointsize;L=w.datapoints.format;f=F=a;da=l=k;for(b=0;b<n.length;b+=I)if(null!=n[b])for(d=0;d<I;++d)g=n[b+d],(p=L[d])&&(!1!==p.autoscale&&g!=e&&g!=-e)&&(p.x&&(g<F&&(F=g),g>l&&(l=g)),p.y&&(g<f&&(f=g),g>da&&(da=g)));if(w.bars.show){switch(w.bars.align){case "left":b=0;break;case "right":b=-w.bars.barWidth;
break;case "center":b=-w.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+w.bars.align);}w.bars.horizontal?(f+=b,da+=b+w.bars.barWidth):(F+=b,l+=b+w.bars.barWidth)}m(w.xaxis,F,l);m(w.yaxis,f,da)}c.each(t(),function(m,c){c.datamin==a&&(c.datamin=null);c.datamax==k&&(c.datamax=null)})}function D(m){function a(m){return m}var k,c,b=m.options.transform||a,e=m.options.inverseTransform;"x"==m.direction?(k=m.scale=Y/Math.abs(b(m.max)-b(m.min)),c=Math.min(b(m.max),b(m.min))):(k=m.scale=
V/Math.abs(b(m.max)-b(m.min)),k=-k,c=Math.max(b(m.max),b(m.min)));m.p2c=b==a?function(m){return(m-c)*k}:function(m){return(b(m)-c)*k};m.c2p=e?function(m){return e(c+m/k)}:function(m){return c+m/k}}function ba(m){var a=m.labelWidth,k=m.labelHeight,b=m.options.position,e=m.options.tickLength,d=n.grid.axisMargin,F=n.grid.labelMargin,g="x"==m.direction?O:W,w,h=c.grep(g,function(m){return m&&m.options.position==b&&m.reserveSpace});c.inArray(m,h)==h.length-1&&(d=0);null==e&&(e=c.grep(g,function(m){return m&&
m.reserveSpace}),e=(w=0==c.inArray(m,e))?"full":5);isNaN(+e)||(F+=+e);"x"==m.direction?(k+=F,"bottom"==b?(u.bottom+=k+d,m.box={top:K.height-u.bottom,height:k}):(m.box={top:u.top+d,height:k},u.top+=k+d)):(a+=F,"left"==b?(m.box={left:u.left+d,width:a},u.left+=a+d):(u.right+=a+d,m.box={left:K.width-u.right,width:a}));m.position=b;m.tickLength=e;m.box.padding=F;m.innermost=w}function C(){var m=n.grid.minBorderMargin,a={x:0,y:0},k;if(null==m)for(k=m=0;k<E.length;++k)m=Math.max(m,2*(E[k].points.radius+
E[k].points.lineWidth/2));a.x=a.y=Math.ceil(m);c.each(t(),function(m,k){var c=k.direction;k.reserveSpace&&(a[c]=Math.ceil(Math.max(a[c],("x"==c?k.labelWidth:k.labelHeight)/2)))});u.left=Math.max(a.x,u.left);u.right=Math.max(a.x,u.right);u.top=Math.max(a.y,u.top);u.bottom=Math.max(a.y,u.bottom)}function x(){var m,a=t(),k=n.grid.show;for(m in u){var b=n.grid.margin||0;u[m]="number"==typeof b?b:b[m]||0}h(U.processOffset,[u]);for(m in u)u[m]="object"==typeof n.grid.borderWidth?u[m]+(k?n.grid.borderWidth[m]:
0):u[m]+(k?n.grid.borderWidth:0);c.each(a,function(m,a){a.show=a.options.show;null==a.show&&(a.show=a.used);a.reserveSpace=a.show||a.options.reserveSpace;var k=a.options,c=+(null!=k.min?k.min:a.datamin),b=+(null!=k.max?k.max:a.datamax),e=b-c;if(0==e){if(e=0==b?1:0.01,null==k.min&&(c-=e),null==k.max||null!=k.min)b+=e}else{var s=k.autoscaleMargin;null!=s&&(null==k.min&&(c-=e*s,0>c&&(null!=a.datamin&&0<=a.datamin)&&(c=0)),null==k.max&&(b+=e*s,0<b&&(null!=a.datamax&&0>=a.datamax)&&(b=0)))}a.min=c;a.max=
b});if(k){b=c.grep(a,function(m){return m.reserveSpace});c.each(b,function(m,a){P(a);var k=a.options.ticks,b=[];null==k||"number"==typeof k&&0<k?b=a.tickGenerator(a):k&&(b=c.isFunction(k)?k(a):k);var e;a.ticks=[];for(k=0;k<b.length;++k){var s=null,d=b[k];"object"==typeof d?(e=+d[0],1<d.length&&(s=d[1])):e=+d;null==s&&(s=a.tickFormatter(e,a));isNaN(e)||a.ticks.push({v:e,label:s})}b=a.ticks;a.options.autoscaleMargin&&0<b.length&&(null==a.options.min&&(a.min=Math.min(a.min,b[0].v)),null==a.options.max&&
1<b.length&&(a.max=Math.max(a.max,b[b.length-1].v)));b=a.options;k=a.ticks||[];e=b.labelWidth||0;s=b.labelHeight||0;d=e||"x"==a.direction?Math.floor(K.width/(k.length||1)):null;legacyStyles=a.direction+"Axis "+a.direction+a.n+"Axis";layer="flot-"+a.direction+"-axis flot-"+a.direction+a.n+"-axis "+legacyStyles;font=b.font||"flot-tick-label tickLabel";for(var n=0;n<k.length;++n){var g=k[n];g.label&&(g=K.getTextInfo(layer,g.label,font,null,d),e=Math.max(e,g.width),s=Math.max(s,g.height))}a.labelWidth=
b.labelWidth||e;a.labelHeight=b.labelHeight||s});for(m=b.length-1;0<=m;--m)ba(b[m]);C();c.each(b,function(m,a){"x"==a.direction?(a.box.left=u.left-a.labelWidth/2,a.box.width=K.width-u.left-u.right+a.labelWidth):(a.box.top=u.top-a.labelHeight/2,a.box.height=K.height-u.bottom-u.top+a.labelHeight)})}Y=K.width-u.left-u.right;V=K.height-u.bottom-u.top;c.each(a,function(m,a){D(a)});k&&Q();z()}function P(m){var a=m.options,k;k="number"==typeof a.ticks&&0<a.ticks?a.ticks:0.3*Math.sqrt("x"==m.direction?K.width:
K.height);k=(m.max-m.min)/k;var b=-Math.floor(Math.log(k)/Math.LN10),e=a.tickDecimals;null!=e&&b>e&&(b=e);var d=Math.pow(10,-b),n=k/d,g;1.5>n?g=1:3>n?(g=2,2.25<n&&(null==e||b+1<=e)&&(g=2.5,++b)):g=7.5>n?5:10;g*=d;null!=a.minTickSize&&g<a.minTickSize&&(g=a.minTickSize);m.delta=k;m.tickDecimals=Math.max(0,null!=e?e:b);m.tickSize=a.tickSize||g;if("time"==a.mode&&!m.tickGenerator)throw Error("Time mode requires the flot.time plugin.");m.tickGenerator||(m.tickGenerator=function(a){var m=[],k=a.tickSize*
Math.floor(a.min/a.tickSize),c=0,b=Number.NaN,e;do e=b,b=k+c*a.tickSize,m.push(b),++c;while(b<a.max&&b!=e);return m},m.tickFormatter=function(a,m){var k=m.tickDecimals?Math.pow(10,m.tickDecimals):1,c=""+Math.round(a*k)/k;if(null!=m.tickDecimals){var b=c.indexOf("."),b=-1==b?0:c.length-b-1;if(b<m.tickDecimals)return(b?c:c+".")+(""+k).substr(1,m.tickDecimals-b)}return c});c.isFunction(a.tickFormatter)&&(m.tickFormatter=function(m,k){return""+a.tickFormatter(m,k)});if(null!=a.alignTicksWithAxis){var w=
("x"==m.direction?O:W)[a.alignTicksWithAxis-1];w&&(w.used&&w!=m)&&(k=m.tickGenerator(m),0<k.length&&(null==a.min&&(m.min=Math.min(m.min,k[0])),null==a.max&&1<k.length&&(m.max=Math.max(m.max,k[k.length-1]))),m.tickGenerator=function(a){var m=[],k,c;for(c=0;c<w.ticks.length;++c)k=(w.ticks[c].v-w.min)/(w.max-w.min),k=a.min+k*(a.max-a.min),m.push(k);return m},m.mode||null!=a.tickDecimals||(k=Math.max(0,-Math.floor(Math.log(m.delta)/Math.LN10)+1),b=m.tickGenerator(m),1<b.length&&/\..*0$/.test((b[1]-b[0]).toFixed(k))||
(m.tickDecimals=k)))}}function A(){K.clear();h(U.drawBackground,[p]);var a=n.grid;a.show&&a.backgroundColor&&(p.save(),p.translate(u.left,u.top),p.fillStyle=pa(n.grid.backgroundColor,V,0,"rgba(255, 255, 255, 0)"),p.fillRect(0,0,Y,V),p.restore());a.show&&!a.aboveData&&J();for(var c=0;c<E.length;++c){h(U.drawSeries,[p,E[c]]);var k=E[c];k.lines.show&&N(k);k.bars.show&&ca(k);k.points.show&&R(k)}h(U.draw,[p]);a.show&&a.aboveData&&J();K.render();ea()}function y(a,c){for(var k,b,e,d,g=t(),n=0;n<g.length;++n)if(k=
g[n],k.direction==c&&(d=c+k.n+"axis",a[d]||1!=k.n||(d=c+"axis"),a[d])){b=a[d].from;e=a[d].to;break}a[d]||(k="x"==c?O[0]:W[0],b=a[c+"1"],e=a[c+"2"]);null!=b&&(null!=e&&b>e)&&(d=b,b=e,e=d);return{from:b,to:e,axis:k}}function J(){var a,b,k;p.save();p.translate(u.left,u.top);if(k=n.grid.markings)for(c.isFunction(k)&&(b=G.getAxes(),b.xmin=b.xaxis.min,b.xmax=b.xaxis.max,b.ymin=b.yaxis.min,b.ymax=b.yaxis.max,k=k(b)),a=0;a<k.length;++a){b=k[a];var e=y(b,"x"),d=y(b,"y");null==e.from&&(e.from=e.axis.min);null==
e.to&&(e.to=e.axis.max);null==d.from&&(d.from=d.axis.min);null==d.to&&(d.to=d.axis.max);e.to<e.axis.min||(e.from>e.axis.max||d.to<d.axis.min||d.from>d.axis.max)||(e.from=Math.max(e.from,e.axis.min),e.to=Math.min(e.to,e.axis.max),d.from=Math.max(d.from,d.axis.min),d.to=Math.min(d.to,d.axis.max),e.from==e.to&&d.from==d.to)||(e.from=e.axis.p2c(e.from),e.to=e.axis.p2c(e.to),d.from=d.axis.p2c(d.from),d.to=d.axis.p2c(d.to),e.from==e.to||d.from==d.to?(p.beginPath(),p.strokeStyle=b.color||n.grid.markingsColor,
p.lineWidth=b.lineWidth||n.grid.markingsLineWidth,p.moveTo(e.from,d.from),p.lineTo(e.to,d.to),p.stroke()):(p.fillStyle=b.color||n.grid.markingsColor,p.fillRect(e.from,d.to,e.to-e.from,d.from-d.to)))}b=t();k=n.grid.borderWidth;for(e=0;e<b.length;++e){d=b[e];a=d.box;var g=d.tickLength,h,f,w,l;if(d.show&&0!=d.ticks.length){p.lineWidth=1;"x"==d.direction?(h=0,f="full"==g?"top"==d.position?0:V:a.top-u.top+("top"==d.position?a.height:0)):(f=0,h="full"==g?"left"==d.position?0:Y:a.left-u.left+("left"==d.position?
a.width:0));d.innermost||(p.strokeStyle=d.options.color,p.beginPath(),w=l=0,"x"==d.direction?w=Y+1:l=V+1,1==p.lineWidth&&("x"==d.direction?f=Math.floor(f)+0.5:h=Math.floor(h)+0.5),p.moveTo(h,f),p.lineTo(h+w,f+l),p.stroke());p.strokeStyle=d.options.tickColor;p.beginPath();for(a=0;a<d.ticks.length;++a){var I=d.ticks[a].v;w=l=0;isNaN(I)||(I<d.min||I>d.max||"full"==g&&("object"==typeof k&&0<k[d.position]||0<k)&&(I==d.min||I==d.max))||("x"==d.direction?(h=d.p2c(I),l="full"==g?-V:g,"top"==d.position&&(l=
-l)):(f=d.p2c(I),w="full"==g?-Y:g,"left"==d.position&&(w=-w)),1==p.lineWidth&&("x"==d.direction?h=Math.floor(h)+0.5:f=Math.floor(f)+0.5),p.moveTo(h,f),p.lineTo(h+w,f+l))}p.stroke()}}k&&(a=n.grid.borderColor,"object"==typeof k||"object"==typeof a?("object"!==typeof k&&(k={top:k,right:k,bottom:k,left:k}),"object"!==typeof a&&(a={top:a,right:a,bottom:a,left:a}),0<k.top&&(p.strokeStyle=a.top,p.lineWidth=k.top,p.beginPath(),p.moveTo(0-k.left,0-k.top/2),p.lineTo(Y,0-k.top/2),p.stroke()),0<k.right&&(p.strokeStyle=
a.right,p.lineWidth=k.right,p.beginPath(),p.moveTo(Y+k.right/2,0-k.top),p.lineTo(Y+k.right/2,V),p.stroke()),0<k.bottom&&(p.strokeStyle=a.bottom,p.lineWidth=k.bottom,p.beginPath(),p.moveTo(Y+k.right,V+k.bottom/2),p.lineTo(0,V+k.bottom/2),p.stroke()),0<k.left&&(p.strokeStyle=a.left,p.lineWidth=k.left,p.beginPath(),p.moveTo(0-k.left/2,V+k.bottom),p.lineTo(0-k.left/2,0),p.stroke())):(p.lineWidth=k,p.strokeStyle=n.grid.borderColor,p.strokeRect(-k/2,-k/2,Y+k,V+k)));p.restore()}function Q(){c.each(t(),function(a,
b){if(b.show&&0!=b.ticks.length){var k=b.box,c="flot-"+b.direction+"-axis flot-"+b.direction+b.n+"-axis "+(b.direction+"Axis "+b.direction+b.n+"Axis"),e=b.options.font||"flot-tick-label tickLabel",d,g,n,h,p;K.removeText(c);for(var f=0;f<b.ticks.length;++f)d=b.ticks[f],!d.label||(d.v<b.min||d.v>b.max)||("x"==b.direction?(h="center",g=u.left+b.p2c(d.v),"bottom"==b.position?n=k.top+k.padding:(n=k.top+k.height-k.padding,p="bottom")):(p="middle",n=u.top+b.p2c(d.v),"left"==b.position?(g=k.left+k.width-
k.padding,h="right"):g=k.left+k.padding),K.addText(c,g,n,d.label,e,null,null,h,p))}})}function N(a){function b(a,m,k,c,e){var d=a.points;a=a.pointsize;var g=null,n=null;p.beginPath();for(var s=a;s<d.length;s+=a){var h=d[s-a],f=d[s-a+1],l=d[s],v=d[s+1];if(null!=h&&null!=l){if(f<=v&&f<e.min){if(v<e.min)continue;h=(e.min-f)/(v-f)*(l-h)+h;f=e.min}else if(v<=f&&v<e.min){if(f<e.min)continue;l=(e.min-f)/(v-f)*(l-h)+h;v=e.min}if(f>=v&&f>e.max){if(v>e.max)continue;h=(e.max-f)/(v-f)*(l-h)+h;f=e.max}else if(v>=
f&&v>e.max){if(f>e.max)continue;l=(e.max-f)/(v-f)*(l-h)+h;v=e.max}if(h<=l&&h<c.min){if(l<c.min)continue;f=(c.min-h)/(l-h)*(v-f)+f;h=c.min}else if(l<=h&&l<c.min){if(h<c.min)continue;v=(c.min-h)/(l-h)*(v-f)+f;l=c.min}if(h>=l&&h>c.max){if(l>c.max)continue;f=(c.max-h)/(l-h)*(v-f)+f;h=c.max}else if(l>=h&&l>c.max){if(h>c.max)continue;v=(c.max-h)/(l-h)*(v-f)+f;l=c.max}h==g&&f==n||p.moveTo(c.p2c(h)+m,e.p2c(f)+k);g=l;n=v;p.lineTo(c.p2c(l)+m,e.p2c(v)+k)}}p.stroke()}function k(a,m,b){var c=a.points;a=a.pointsize;
for(var k=Math.min(Math.max(0,b.min),b.max),e=0,d=!1,g=1,h=0,n=0;!(0<a&&e>c.length+a);){var e=e+a,s=c[e-a],f=c[e-a+g],l=c[e],v=c[e+g];if(d){if(0<a&&null!=s&&null==l){n=e;a=-a;g=2;continue}if(0>a&&e==h+a){p.fill();d=!1;a=-a;g=1;e=h=n+a;continue}}if(null!=s&&null!=l){if(s<=l&&s<m.min){if(l<m.min)continue;f=(m.min-s)/(l-s)*(v-f)+f;s=m.min}else if(l<=s&&l<m.min){if(s<m.min)continue;v=(m.min-s)/(l-s)*(v-f)+f;l=m.min}if(s>=l&&s>m.max){if(l>m.max)continue;f=(m.max-s)/(l-s)*(v-f)+f;s=m.max}else if(l>=s&&
l>m.max){if(s>m.max)continue;v=(m.max-s)/(l-s)*(v-f)+f;l=m.max}d||(p.beginPath(),p.moveTo(m.p2c(s),b.p2c(k)),d=!0);if(f>=b.max&&v>=b.max)p.lineTo(m.p2c(s),b.p2c(b.max)),p.lineTo(m.p2c(l),b.p2c(b.max));else if(f<=b.min&&v<=b.min)p.lineTo(m.p2c(s),b.p2c(b.min)),p.lineTo(m.p2c(l),b.p2c(b.min));else{var t=s,oa=l;f<=v&&f<b.min&&v>=b.min?(s=(b.min-f)/(v-f)*(l-s)+s,f=b.min):v<=f&&(v<b.min&&f>=b.min)&&(l=(b.min-f)/(v-f)*(l-s)+s,v=b.min);f>=v&&f>b.max&&v<=b.max?(s=(b.max-f)/(v-f)*(l-s)+s,f=b.max):v>=f&&(v>
b.max&&f<=b.max)&&(l=(b.max-f)/(v-f)*(l-s)+s,v=b.max);s!=t&&p.lineTo(m.p2c(t),b.p2c(f));p.lineTo(m.p2c(s),b.p2c(f));p.lineTo(m.p2c(l),b.p2c(v));l!=oa&&(p.lineTo(m.p2c(l),b.p2c(v)),p.lineTo(m.p2c(oa),b.p2c(v)))}}}}p.save();p.translate(u.left,u.top);p.lineJoin="round";var c=a.lines.lineWidth,e=a.shadowSize;if(0<c&&0<e){p.lineWidth=e;p.strokeStyle="rgba(0,0,0,0.1)";var d=Math.PI/18;b(a.datapoints,Math.sin(d)*(c/2+e/2),Math.cos(d)*(c/2+e/2),a.xaxis,a.yaxis);p.lineWidth=e/2;b(a.datapoints,Math.sin(d)*
(c/2+e/4),Math.cos(d)*(c/2+e/4),a.xaxis,a.yaxis)}p.lineWidth=c;p.strokeStyle=a.color;if(e=S(a.lines,a.color,0,V))p.fillStyle=e,k(a.datapoints,a.xaxis,a.yaxis);0<c&&b(a.datapoints,0,0,a.xaxis,a.yaxis);p.restore()}function R(a){function b(a,m,c,e,k,d,s,g){var f=a.points;a=a.pointsize;for(var h=0;h<f.length;h+=a){var n=f[h],l=f[h+1];null==n||(n<d.min||n>d.max||l<s.min||l>s.max)||(p.beginPath(),n=d.p2c(n),l=s.p2c(l)+e,"circle"==g?p.arc(n,l,m,0,k?Math.PI:2*Math.PI,!1):g(p,n,l,m,k),p.closePath(),c&&(p.fillStyle=
c,p.fill()),p.stroke())}}p.save();p.translate(u.left,u.top);var c=a.points.lineWidth,e=a.shadowSize,d=a.points.radius,g=a.points.symbol;0==c&&(c=1E-4);0<c&&0<e&&(e/=2,p.lineWidth=e,p.strokeStyle="rgba(0,0,0,0.1)",b(a.datapoints,d,null,e+e/2,!0,a.xaxis,a.yaxis,g),p.strokeStyle="rgba(0,0,0,0.2)",b(a.datapoints,d,null,e/2,!0,a.xaxis,a.yaxis,g));p.lineWidth=c;p.strokeStyle=a.color;b(a.datapoints,d,S(a.points,a.color),0,!1,a.xaxis,a.yaxis,g);p.restore()}function fa(a,b,c,e,d,g,f,h,n,l,p,t){var A,q,y,u;
p?(u=q=y=!0,A=!1,p=c,c=b+e,d=b+d,a<p&&(b=a,a=p,p=b,A=!0,q=!1)):(A=q=y=!0,u=!1,p=a+e,a+=d,d=c,c=b,c<d&&(b=c,c=d,d=b,u=!0,y=!1));a<h.min||(p>h.max||c<n.min||d>n.max)||(p<h.min&&(p=h.min,A=!1),a>h.max&&(a=h.max,q=!1),d<n.min&&(d=n.min,u=!1),c>n.max&&(c=n.max,y=!1),p=h.p2c(p),d=n.p2c(d),a=h.p2c(a),c=n.p2c(c),f&&(l.beginPath(),l.moveTo(p,d),l.lineTo(p,c),l.lineTo(a,c),l.lineTo(a,d),l.fillStyle=f(d,c),l.fill()),0<t&&(A||q||y||u)&&(l.beginPath(),l.moveTo(p,d+g),A?l.lineTo(p,c+g):l.moveTo(p,c+g),y?l.lineTo(a,
c+g):l.moveTo(a,c+g),q?l.lineTo(a,d+g):l.moveTo(a,d+g),u?l.lineTo(p,d+g):l.moveTo(p,d+g),l.stroke()))}function ca(a){p.save();p.translate(u.left,u.top);p.lineWidth=a.bars.lineWidth;p.strokeStyle=a.color;var b;switch(a.bars.align){case "left":b=0;break;case "right":b=-a.bars.barWidth;break;case "center":b=-a.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+a.bars.align);}(function(b,c,e,d,g,h,n){var f=b.points;b=b.pointsize;for(var s=0;s<f.length;s+=b)null!=f[s]&&fa(f[s],f[s+1],
f[s+2],c,e,d,g,h,n,p,a.bars.horizontal,a.bars.lineWidth)})(a.datapoints,b,b+a.bars.barWidth,0,a.bars.fill?function(b,c){return S(a.bars,a.color,b,c)}:null,a.xaxis,a.yaxis);p.restore()}function S(a,b,e,d){var g=a.fill;if(!g)return null;if(a.fillColor)return pa(a.fillColor,e,d,b);a=c.color.parse(b);a.a="number"==typeof g?g:0.4;a.normalize();return a.toString()}function z(){a.find(".legend").remove();if(n.legend.show){for(var b=[],d=[],k=!1,g=n.legend.labelFormatter,h,f,l=0;l<E.length;++l)h=E[l],h.label&&
(f=g?g(h.label,h):h.label)&&d.push({label:f,color:h.color});if(n.legend.sorted)if(c.isFunction(n.legend.sorted))d.sort(n.legend.sorted);else if("reverse"==n.legend.sorted)d.reverse();else{var p="descending"!=n.legend.sorted;d.sort(function(a,b){return a.label==b.label?0:a.label<b.label!=p?1:-1})}for(l=0;l<d.length;++l)g=d[l],0==l%n.legend.noColumns&&(k&&b.push("</tr>"),b.push("<tr>"),k=!0),b.push('<td class="legendColorBox"><div style="border:1px solid '+n.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+
g.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+g.label+"</td>");k&&b.push("</tr>");0!=b.length&&(d='<table style="font-size:smaller;color:'+n.grid.color+'">'+b.join("")+"</table>",null!=n.legend.container?c(n.legend.container).html(d):(b="",k=n.legend.position,l=n.legend.margin,null==l[0]&&(l=[l,l]),"n"==k.charAt(0)?b+="top:"+(l[1]+u.top)+"px;":"s"==k.charAt(0)&&(b+="bottom:"+(l[1]+u.bottom)+"px;"),"e"==k.charAt(1)?b+="right:"+(l[0]+u.right)+"px;":"w"==k.charAt(1)&&(b+="left:"+
(l[0]+u.left)+"px;"),d=c('<div class="legend">'+d.replace('style="','style="position:absolute;'+b+";")+"</div>").appendTo(a),0!=n.legend.backgroundOpacity&&(k=n.legend.backgroundColor,null==k&&(k=(k=n.grid.backgroundColor)&&"string"==typeof k?c.color.parse(k):c.color.extract(d,"background-color"),k.a=1,k=k.toString()),l=d.children(),c('<div style="position:absolute;width:'+l.width()+"px;height:"+l.height()+"px;"+b+"background-color:"+k+';"> </div>').prependTo(d).css("opacity",n.legend.backgroundOpacity))))}}
function qa(a){n.grid.hoverable&&Z("plothover",a,function(a){return!1!=a.hoverable})}function X(a){n.grid.hoverable&&Z("plothover",a,function(a){return!1})}function ra(a){Z("plotclick",a,function(a){return!1!=a.clickable})}function Z(b,c,d){var g=$.offset(),h=c.pageX-g.left-u.left,f=c.pageY-g.top-u.top,l=r({left:h,top:f});l.pageX=c.pageX;l.pageY=c.pageY;c=n.grid.mouseActiveRadius;var p=c*c+1,t=null,A,q,y;for(A=E.length-1;0<=A;--A)if(d(E[A])){var R=E[A],x=R.xaxis,z=R.yaxis,J=R.datapoints.points,H=
x.c2p(h),ca=z.c2p(f),fa=c/x.scale,D=c/z.scale;y=R.datapoints.pointsize;x.options.inverseTransform&&(fa=Number.MAX_VALUE);z.options.inverseTransform&&(D=Number.MAX_VALUE);if(R.lines.show||R.points.show)for(q=0;q<J.length;q+=y){var Q=J[q],N=J[q+1];null==Q||(Q-H>fa||Q-H<-fa||N-ca>D||N-ca<-D)||(Q=Math.abs(x.p2c(Q)-h),N=Math.abs(z.p2c(N)-f),N=Q*Q+N*N,N<p&&(p=N,t=[A,q/y]))}if(R.bars.show&&!t)for(x="left"==R.bars.align?0:-R.bars.barWidth/2,R=x+R.bars.barWidth,q=0;q<J.length;q+=y)Q=J[q],N=J[q+1],z=J[q+2],
null!=Q&&(E[A].bars.horizontal?H<=Math.max(z,Q)&&H>=Math.min(z,Q)&&ca>=N+x&&ca<=N+R:H>=Q+x&&H<=Q+R&&ca>=Math.min(z,N)&&ca<=Math.max(z,N))&&(t=[A,q/y])}t?(A=t[0],q=t[1],y=E[A].datapoints.pointsize,d={datapoint:E[A].datapoints.points.slice(q*y,(q+1)*y),dataIndex:q,series:E[A],seriesIndex:A}):d=null;d&&(d.pageX=parseInt(d.series.xaxis.p2c(d.datapoint[0])+g.left+u.left,10),d.pageY=parseInt(d.series.yaxis.p2c(d.datapoint[1])+g.top+u.top,10));if(n.grid.autoHighlight){for(g=0;g<aa.length;++g)h=aa[g],h.auto!=
b||d&&h.series==d.series&&h.point[0]==d.datapoint[0]&&h.point[1]==d.datapoint[1]||ia(h.series,h.point);d&&ja(d.series,d.datapoint,b)}a.trigger(b,[l,d])}function ea(){var a=n.interaction.redrawOverlayInterval;-1==a?ka():ha||(ha=setTimeout(ka,a))}function ka(){ha=null;T.save();ga.clear();T.translate(u.left,u.top);var a,b;for(a=0;a<aa.length;++a)if(b=aa[a],b.series.bars.show)na(b.series,b.point);else{var e=b.series,d=b.point;b=d[0];var d=d[1],g=e.xaxis,f=e.yaxis,l="string"===typeof e.highlightColor?
e.highlightColor:c.color.parse(e.color).scale("a",0.5).toString();if(!(b<g.min||b>g.max||d<f.min||d>f.max)){var n=e.points.radius+e.points.lineWidth/2;T.lineWidth=n;T.strokeStyle=l;l=1.5*n;b=g.p2c(b);d=f.p2c(d);T.beginPath();"circle"==e.points.symbol?T.arc(b,d,l,0,2*Math.PI,!1):e.points.symbol(T,b,d,l,!1);T.closePath();T.stroke()}}T.restore();h(U.drawOverlay,[T])}function ja(a,b,c){"number"==typeof a&&(a=E[a]);if("number"==typeof b){var e=a.datapoints.pointsize;b=a.datapoints.points.slice(e*b,e*(b+
1))}e=la(a,b);-1==e?(aa.push({series:a,point:b,auto:c}),ea()):c||(aa[e].auto=!1)}function ia(a,b){if(null==a&&null==b)aa=[],ea();else{"number"==typeof a&&(a=E[a]);if("number"==typeof b){var c=a.datapoints.pointsize;b=a.datapoints.points.slice(c*b,c*(b+1))}c=la(a,b);-1!=c&&(aa.splice(c,1),ea())}}function la(a,b){for(var c=0;c<aa.length;++c){var e=aa[c];if(e.series==a&&e.point[0]==b[0]&&e.point[1]==b[1])return c}return-1}function na(a,b){var e="string"===typeof a.highlightColor?a.highlightColor:c.color.parse(a.color).scale("a",
0.5).toString(),d="left"==a.bars.align?0:-a.bars.barWidth/2;T.lineWidth=a.bars.lineWidth;T.strokeStyle=e;fa(b[0],b[1],b[2]||0,d,d+a.bars.barWidth,0,function(){return e},a.xaxis,a.yaxis,T,a.bars.horizontal,a.bars.lineWidth)}function pa(a,b,e,d){if("string"==typeof a)return a;b=p.createLinearGradient(0,e,0,b);e=0;for(var g=a.colors.length;e<g;++e){var h=a.colors[e];if("string"!=typeof h){var l=c.color.parse(d);null!=h.brightness&&(l=l.scale("rgb",h.brightness));null!=h.opacity&&(l.a*=h.opacity);h=l.toString()}b.addColorStop(e/
(g-1),h)}return b}var E=[],n={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:0.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,
alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:0.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,
margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1E3/60},hooks:{}},K=null,ga=null,$=null,p=null,T=null,O=[],W=[],u={left:0,right:0,top:0,bottom:0},Y=0,V=0,U={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},G=this;
G.setData=f;G.setupGrid=x;G.draw=A;G.getPlaceholder=function(){return a};G.getCanvas=function(){return K.element};G.getPlotOffset=function(){return u};G.width=function(){return Y};G.height=function(){return V};G.offset=function(){var a=$.offset();a.left+=u.left;a.top+=u.top;return a};G.getData=function(){return E};G.getAxes=function(){var a={};c.each(O.concat(W),function(b,c){c&&(a[c.direction+(1!=c.n?c.n:"")+"axis"]=c)});return a};G.getXAxes=function(){return O};G.getYAxes=function(){return W};G.c2p=
r;G.p2c=function(a){var b={},c,e,d;for(c=0;c<O.length;++c)if((e=O[c])&&e.used&&(d="x"+e.n,null==a[d]&&1==e.n&&(d="x"),null!=a[d])){b.left=e.p2c(a[d]);break}for(c=0;c<W.length;++c)if((e=W[c])&&e.used&&(d="y"+e.n,null==a[d]&&1==e.n&&(d="y"),null!=a[d])){b.top=e.p2c(a[d]);break}return b};G.getOptions=function(){return n};G.highlight=ja;G.unhighlight=ia;G.triggerRedrawOverlay=ea;G.pointOffset=function(a){return{left:parseInt(O[l(a,"x")-1].p2c(+a.x)+u.left,10),top:parseInt(W[l(a,"y")-1].p2c(+a.y)+u.top,
10)}};G.shutdown=function(){ha&&clearTimeout(ha);$.unbind("mousemove",qa);$.unbind("mouseleave",X);$.unbind("click",ra);h(U.shutdown,[$])};G.resize=function(){var b=a.width(),c=a.height();K.resize(b,c);ga.resize(b,c)};G.hooks=U;(function(){for(var a={Canvas:B},b=0;b<g.length;++b){var e=g[b];e.init(G,a);e.options&&c.extend(!0,n,e.options)}})(G);(function(b){c.extend(!0,n,b);b&&b.colors&&(n.colors=b.colors);null==n.xaxis.color&&(n.xaxis.color=c.color.parse(n.grid.color).scale("a",0.22).toString());
null==n.yaxis.color&&(n.yaxis.color=c.color.parse(n.grid.color).scale("a",0.22).toString());null==n.xaxis.tickColor&&(n.xaxis.tickColor=n.grid.tickColor||n.xaxis.color);null==n.yaxis.tickColor&&(n.yaxis.tickColor=n.grid.tickColor||n.yaxis.color);null==n.grid.borderColor&&(n.grid.borderColor=n.grid.color);null==n.grid.tickColor&&(n.grid.tickColor=c.color.parse(n.grid.color).scale("a",0.22).toString());var d,g,l={style:a.css("font-style"),size:Math.round(0.8*(+a.css("font-size").replace("px","")||13)),
variant:a.css("font-variant"),weight:a.css("font-weight"),family:a.css("font-family")};l.lineHeight=1.15*l.size;g=n.xaxes.length||1;for(b=0;b<g;++b)(d=n.xaxes[b])&&!d.tickColor&&(d.tickColor=d.color),d=c.extend(!0,{},n.xaxis,d),n.xaxes[b]=d,d.font&&(d.font=c.extend({},l,d.font),d.font.color||(d.font.color=d.color));g=n.yaxes.length||1;for(b=0;b<g;++b)(d=n.yaxes[b])&&!d.tickColor&&(d.tickColor=d.color),d=c.extend(!0,{},n.yaxis,d),n.yaxes[b]=d,d.font&&(d.font=c.extend({},l,d.font),d.font.color||(d.font.color=
d.color));n.xaxis.noTicks&&null==n.xaxis.ticks&&(n.xaxis.ticks=n.xaxis.noTicks);n.yaxis.noTicks&&null==n.yaxis.ticks&&(n.yaxis.ticks=n.yaxis.noTicks);n.x2axis&&(n.xaxes[1]=c.extend(!0,{},n.xaxis,n.x2axis),n.xaxes[1].position="top");n.y2axis&&(n.yaxes[1]=c.extend(!0,{},n.yaxis,n.y2axis),n.yaxes[1].position="right");n.grid.coloredAreas&&(n.grid.markings=n.grid.coloredAreas);n.grid.coloredAreasColor&&(n.grid.markingsColor=n.grid.coloredAreasColor);n.lines&&c.extend(!0,n.series.lines,n.lines);n.points&&
c.extend(!0,n.series.points,n.points);n.bars&&c.extend(!0,n.series.bars,n.bars);null!=n.shadowSize&&(n.series.shadowSize=n.shadowSize);null!=n.highlightColor&&(n.series.highlightColor=n.highlightColor);for(b=0;b<n.xaxes.length;++b)q(O,b+1).options=n.xaxes[b];for(b=0;b<n.yaxes.length;++b)q(W,b+1).options=n.yaxes[b];for(var f in U)n.hooks[f]&&n.hooks[f].length&&(U[f]=U[f].concat(n.hooks[f]));h(U.processOptions,[n])})(b);(function(){a.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove();
"static"==a.css("position")&&a.css("position","relative");K=new B("flot-base",a);ga=new B("flot-overlay",a);p=K.context;T=ga.context;$=c(ga.element).unbind();var b=a.data("plot");b&&(b.shutdown(),ga.clear());a.data("plot",G)})();f(d);x();A();n.grid.hoverable&&($.mousemove(qa),$.bind("mouseleave",X));n.grid.clickable&&$.click(ra);h(U.bindEvents,[$]);var aa=[],ha=null}var a=Object.prototype.hasOwnProperty;B.prototype.resize=function(a,c){if(0>=a||0>=c)throw Error("Invalid dimensions for plot, width = "+
a+", height = "+c);var b=this.element,g=this.context,h=this.pixelRatio;this.width!=a&&(b.width=a*h,b.style.width=a+"px",this.width=a);this.height!=c&&(b.height=c*h,b.style.height=c+"px",this.height=c);g.restore();g.save();g.scale(h,h)};B.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};B.prototype.render=function(){var c=this._textCache,d;for(d in c)if(a.call(c,d)){var b=this.getTextLayer(d),g=c[d];b.hide();for(var h in g)if(a.call(g,h)){var f=g[h],l;for(l in f)if(a.call(f,
l)){for(var t=f[l].positions,r=0,q;q=t[r];r++)q.active?q.rendered||(b.append(q.element),q.rendered=!0):(t.splice(r--,1),q.rendered&&q.element.detach());0==t.length&&delete f[l]}}b.show()}};B.prototype.getTextLayer=function(a){var d=this.text[a];null==d&&(null==this.textContainer&&(this.textContainer=c("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),d=this.text[a]=c("<div></div>").addClass(a).css({position:"absolute",
top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer));return d};B.prototype.getTextInfo=function(a,d,b,g,h){var f,l;d=""+d;g="object"===typeof b?b.style+" "+b.variant+" "+b.weight+" "+b.size+"px/"+b.lineHeight+"px "+b.family:b;f=this._textCache[a];null==f&&(f=this._textCache[a]={});l=f[g];null==l&&(l=f[g]={});f=l[d];null==f&&(a=c("<div></div>").html(d).css({position:"absolute","max-width":h,top:-9999}).appendTo(this.getTextLayer(a)),"object"===typeof b?a.css({font:g,color:b.color}):"string"===
typeof b&&a.addClass(b),f=l[d]={width:a.outerWidth(!0),height:a.outerHeight(!0),element:a,positions:[]},a.detach());return f};B.prototype.addText=function(a,c,b,g,h,f,l,t,r){a=this.getTextInfo(a,g,h,f,l);g=a.positions;"center"==t?c-=a.width/2:"right"==t&&(c-=a.width);"middle"==r?b-=a.height/2:"bottom"==r&&(b-=a.height);for(r=0;h=g[r];r++)if(h.x==c&&h.y==b){h.active=!0;return}h={active:!0,rendered:!1,element:g.length?a.element.clone():a.element,x:c,y:b};g.push(h);h.element.css({top:Math.round(b),left:Math.round(c),
"text-align":t})};B.prototype.removeText=function(c,d,b,g,h,f){if(null==g){if(d=this._textCache[c],null!=d)for(var l in d)if(a.call(d,l)){b=d[l];for(var t in b)if(a.call(b,t))for(c=b[t].positions,g=0;h=c[g];g++)h.active=!1}}else for(c=this.getTextInfo(c,g,h,f).positions,g=0;h=c[g];g++)h.x==d&&h.y==b&&(h.active=!1)};c.plot=function(a,d,b){return new C(c(a),d,b,c.plot.plugins)};c.plot.version="0.8.1";c.plot.plugins=[];c.fn.plot=function(a,d){return this.each(function(){c.plot(this,a,d)})}})(jQuery);
(function(c){var B=10,C=0.95,a={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:0.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(a,c){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+c.color+";'>"+a+"<br/>"+Math.round(c.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:0.5}}}};c.plot.plugins.push({init:function(e){function d(b){for(var d=
0,e=0,g=0,h=a.series.pie.combine.color,l=[],f=0;f<b.length;++f){var q=b[f].data;c.isArray(q)&&1==q.length&&(q=q[0]);c.isArray(q)?!isNaN(parseFloat(q[1]))&&isFinite(q[1])?q[1]=+q[1]:q[1]=0:q=!isNaN(parseFloat(q))&&isFinite(q)?[1,+q]:[1,0];b[f].data=[q]}for(f=0;f<b.length;++f)d+=b[f].data[0][1];for(f=0;f<b.length;++f)q=b[f].data[0][1],q/d<=a.series.pie.combine.threshold&&(e+=q,g++,h||(h=b[f].color));for(f=0;f<b.length;++f)q=b[f].data[0][1],(2>g||q/d>a.series.pie.combine.threshold)&&l.push({data:[[1,
q]],color:b[f].color,label:b[f].label,angle:2*q*Math.PI/d,percent:q/(d/100)});1<g&&l.push({data:[[1,e]],color:h,label:a.series.pie.combine.label,angle:2*e*Math.PI/d,percent:e/(d/100)});return l}function b(b,d){function e(){x.clearRect(0,0,l,t);q.children().filter(".pieLabel, .pieLabelBackground").remove()}function f(){var b=a.series.pie.shadow.left,c=a.series.pie.shadow.top,d=a.series.pie.shadow.alpha,e=1<a.series.pie.radius?a.series.pie.radius:H*a.series.pie.radius;if(!(e>=l/2-b||e*a.series.pie.tilt>=
t/2-c||10>=e)){x.save();x.translate(b,c);x.globalAlpha=d;x.fillStyle="#000";x.translate(D,ba);x.scale(1,a.series.pie.tilt);for(b=1;10>=b;b++)x.beginPath(),x.arc(0,0,e,0,2*Math.PI,!1),x.fill(),e-=b;x.restore()}}function h(){function b(a,c,d){0>=a||isNaN(a)||(d?x.fillStyle=c:(x.strokeStyle=c,x.lineJoin="round"),x.beginPath(),1E-9<Math.abs(a-2*Math.PI)&&x.moveTo(0,0),x.arc(0,0,f,r,r+a/2,!1),x.arc(0,0,f,r+a/2,r+a,!1),x.closePath(),r+=a,d?x.fill():x.stroke())}function d(){for(var b=e,g=1<a.series.pie.label.radius?
a.series.pie.label.radius:H*a.series.pie.label.radius,f=0;f<S.length;++f){if(S[f].percent>=100*a.series.pie.label.threshold){var h;h=S[f];var y=b,r=f;if(0==h.data[0][1])h=!0;else{var A=a.legend.labelFormatter,n=void 0,x=a.series.pie.label.formatter,n=A?A(h.label,h):h.label;x&&(n=x(n,h));A=(y+h.angle+y)/2;y=D+Math.round(Math.cos(A)*g);A=ba+Math.round(Math.sin(A)*g)*a.series.pie.tilt;q.append("<span class='pieLabel' id='pieLabel"+r+"' style='position:absolute;top:"+A+"px;left:"+y+"px;'>"+n+"</span>");
r=q.children("#pieLabel"+r);n=A-r.height()/2;A=y-r.width()/2;r.css("top",n);r.css("left",A);0<0-n||0<0-A||0>t-(n+r.height())||0>l-(A+r.width())?h=!1:(0!=a.series.pie.label.background.opacity&&(y=a.series.pie.label.background.color,null==y&&(y=h.color),h="top:"+n+"px;left:"+A+"px;",c("<div class='pieLabelBackground' style='position:absolute;width:"+r.width()+"px;height:"+r.height()+"px;"+h+"background-color:"+y+";'></div>").css("opacity",a.series.pie.label.background.opacity).insertBefore(r)),h=!0)}if(!h)return!1}b+=
S[f].angle}return!0}var e=Math.PI*a.series.pie.startAngle,f=1<a.series.pie.radius?a.series.pie.radius:H*a.series.pie.radius;x.save();x.translate(D,ba);x.scale(1,a.series.pie.tilt);x.save();for(var r=e,y=0;y<S.length;++y)S[y].startAngle=r,b(S[y].angle,S[y].color,!0);x.restore();if(0<a.series.pie.stroke.width){x.save();x.lineWidth=a.series.pie.stroke.width;r=e;for(y=0;y<S.length;++y)b(S[y].angle,a.series.pie.stroke.color,!1);x.restore()}g(x);x.restore();return a.series.pie.label.show?d():!0}if(q){var l=
b.getPlaceholder().width(),t=b.getPlaceholder().height(),r=q.children().filter(".legend").children().width()||0;x=d;M=!1;H=Math.min(l,t/a.series.pie.tilt)/2;ba=t/2+a.series.pie.offset.top;D=l/2;D="auto"==a.series.pie.offset.left?a.legend.position.match("w")?D+r/2:D-r/2:D+a.series.pie.offset.left;D<H?D=H:D>l-H&&(D=l-H);var S=b.getData(),r=0;do 0<r&&(H*=C),r+=1,e(),0.8>=a.series.pie.tilt&&f();while(!h()&&r<B);r>=B&&(e(),q.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>"));
b.setSeries&&b.insertLegend&&(b.setSeries(S),b.insertLegend())}}function g(b){if(0<a.series.pie.innerRadius){b.save();var c=1<a.series.pie.innerRadius?a.series.pie.innerRadius:H*a.series.pie.innerRadius;b.globalCompositeOperation="destination-out";b.beginPath();b.fillStyle=a.series.pie.stroke.color;b.arc(0,0,c,0,2*Math.PI,!1);b.fill();b.closePath();b.restore();b.save();b.beginPath();b.strokeStyle=a.series.pie.stroke.color;b.arc(0,0,c,0,2*Math.PI,!1);b.stroke();b.closePath();b.restore()}}function h(a){l("plothover",
a)}function f(a){l("plotclick",a)}function l(b,c){var d=e.offset(),g=parseInt(c.pageX-d.left);a:{for(var d=parseInt(c.pageY-d.top),f=e.getData(),h=e.getOptions(),h=1<h.series.pie.radius?h.series.pie.radius:H*h.series.pie.radius,l,r,C=0;C<f.length;++C){var z=f[C];if(z.pie.show){x.save();x.beginPath();x.moveTo(0,0);x.arc(0,0,h,z.startAngle,z.startAngle+z.angle/2,!1);x.arc(0,0,h,z.startAngle+z.angle/2,z.startAngle+z.angle,!1);x.closePath();l=g-D;r=d-ba;if(x.isPointInPath){if(x.isPointInPath(g-D,d-ba)){x.restore();
g={datapoint:[z.percent,z.data],dataIndex:0,series:z,seriesIndex:C};break a}}else{var B=h*Math.cos(z.startAngle),X=h*Math.sin(z.startAngle),M=h*Math.cos(z.startAngle+z.angle/4),Z=h*Math.sin(z.startAngle+z.angle/4),ea=h*Math.cos(z.startAngle+z.angle/2),ka=h*Math.sin(z.startAngle+z.angle/2),ja=h*Math.cos(z.startAngle+z.angle/1.5),ia=h*Math.sin(z.startAngle+z.angle/1.5),la=h*Math.cos(z.startAngle+z.angle),na=h*Math.sin(z.startAngle+z.angle),B=[[0,0],[B,X],[M,Z],[ea,ka],[ja,ia],[la,na]];l=[l,r];r=!1;
X=-1;M=B.length;for(Z=M-1;++X<M;Z=X)(B[X][1]<=l[1]&&l[1]<B[Z][1]||B[Z][1]<=l[1]&&l[1]<B[X][1])&&l[0]<(B[Z][0]-B[X][0])*(l[1]-B[X][1])/(B[Z][1]-B[X][1])+B[X][0]&&(r=!r);if(r){x.restore();g={datapoint:[z.percent,z.data],dataIndex:0,series:z,seriesIndex:C};break a}}x.restore()}}g=null}if(a.grid.autoHighlight)for(d=0;d<P.length;++d)f=P[d],f.auto!=b||g&&f.series==g.series||(f=f.series,null==f&&(P=[],e.triggerRedrawOverlay()),f=t(f),-1!=f&&(P.splice(f,1),e.triggerRedrawOverlay()));g&&(d=g.series,f=t(d),
-1==f?(P.push({series:d,auto:b}),e.triggerRedrawOverlay()):b||(P[f].auto=!1));q.trigger(b,[{pageX:c.pageX,pageY:c.pageY},g])}function t(a){for(var b=0;b<P.length;++b)if(P[b].series==a)return b;return-1}var r=null,q=null,H=null,D=null,ba=null,M=!1,x=null,P=[];e.hooks.processOptions.push(function(a,b){b.series.pie.show&&(b.grid.show=!1,"auto"==b.series.pie.label.show&&(b.series.pie.label.show=b.legend.show?!1:!0),"auto"==b.series.pie.radius&&(b.series.pie.radius=b.series.pie.label.show?0.75:1),1<b.series.pie.tilt?
b.series.pie.tilt=1:0>b.series.pie.tilt&&(b.series.pie.tilt=0))});e.hooks.bindEvents.push(function(a,b){var c=a.getOptions();c.series.pie.show&&(c.grid.hoverable&&b.unbind("mousemove").mousemove(h),c.grid.clickable&&b.unbind("click").click(f))});e.hooks.processDatapoints.push(function(b,e,f,h){b.getOptions().series.pie.show&&!M&&(M=!0,r=b.getCanvas(),q=c(r).parent(),a=b.getOptions(),b.setData(d(b.getData())))});e.hooks.drawOverlay.push(function(a,b){if(a.getOptions().series.pie.show){var c=a.getOptions(),
d=1<c.series.pie.radius?c.series.pie.radius:H*c.series.pie.radius;b.save();b.translate(D,ba);b.scale(1,c.series.pie.tilt);for(var e=0;e<P.length;++e){var f=P[e].series;0>=f.angle||isNaN(f.angle)||(b.fillStyle="rgba(255, 255, 255, "+c.series.pie.highlight.opacity+")",b.beginPath(),1E-9<Math.abs(f.angle-2*Math.PI)&&b.moveTo(0,0),b.arc(0,0,d,f.startAngle,f.startAngle+f.angle/2,!1),b.arc(0,0,d,f.startAngle+f.angle/2,f.startAngle+f.angle,!1),b.closePath(),b.fill())}g(b);b.restore()}});e.hooks.draw.push(function(a,
c){a.getOptions().series.pie.show&&b(a,c)})},options:a,name:"pie",version:"1.1"})})(jQuery);
(function(c,B){var C=0;c.widget("s3.pivottable",{options:{showTotals:!0,ajaxURL:null,defaultChart:{type:"breakdown",axis:"rows"},renderFilter:!0,renderOptions:!0,renderChart:!0,renderTable:!0,collapseFilter:!1,collapseOptions:!0,collapseChart:!0,collapseTable:!1,autoSubmit:1E3},_create:function(){this.id=C;C+=1;this.chart=this.table=null},_init:function(){var a=this.element;this.table=this.data=null;this.chart_options={currentChart:null,currentDataIndex:null,currentSeriesIndex:null};this.table_options=
{hidden:!1};var e=c(a).find(".pt-chart");this.chart=e.length?e.first():null;this.options.renderFilter||this.options.renderOptions?(e=c(a).attr("id"),this.options.renderOptions?(c("#"+e+"-options").show(),this.options.collapseOptions&&(c("#"+e+"-options legend").siblings().toggle(),c("#"+e+"-options legend").children().toggle())):c("#"+e+"-options").hide(),this.options.renderFilter?(c("#"+e+"-filters").show(),this.options.collapseFilter&&(c("#"+e+"-filters legend").siblings().toggle(),c("#"+e+"-filters legend").children().toggle())):
c("#"+e+"-options").hide()):c(a).find(".pt-form-container").hide();this.options.collapseTable&&(this.table_options.hidden=!0,c(a).find(".pt-table").hide(),c(a).find(".pt-show-table").show(),c(a).find(".pt-hide-table").hide());this.refresh()},_destroy:function(){this.table&&this.table.remove();this.chart&&this.chart.empty()},refresh:function(){var a=this.element,e=null;this._unbindEvents();var d=c(a).find('input[type="hidden"][name="pivotdata"]');d.length&&(e=JSON.parse(c(d).first().val()));e||(e=
{empty:!0},c(a).find(".pt-hide-table").hide(),c(a).find(".pt-show-table").hide());this.data=e;e.nodata?(c(a).find(".pt-table").first().empty().append(c('<div class="pt-no-data">'+e.nodata+"</div>")),c(a).find(".pt-hide-table").hide(),c(a).find(".pt-show-table").hide()):(this._renderTable(),this._renderChartOptions());this._renderChart();e.empty?c(a).find(".pt-empty").show():c(a).find(".pt-empty").hide();this.options.autoSubmit?c(a).find(".pt-submit").hide():c(a).find(".pt-submit").show();this._bindEvents();
c(a).find(".pt-throbber").hide()},_renderTable:function(){var a=this.element,e=c(a).find(".pt-table").first().empty();this.table=null;var d=this.data;if(!d.empty)if(this.options.renderTable){var b=d.cells,g=d.cols,h=d.rows,f=d.total,l=d.labels,d=this._renderHeader(g,l);d.append(this._renderColumns(g,l));b=this._renderRows(h,g,l,b);g=this._renderFooter(h,g,l,f);h=c('<table class="dataTable display report"/>').append(d).append(b);null!==g&&h.append(g);this.table=c(h);c(e).append(this.table);this.table_options.hidden?
(c(a).find(".pt-show-table").show(),c(a).find(".pt-hide-table").hide()):(c(a).find(".pt-show-table").hide(),c(a).find(".pt-hide-table").show())}else c(a).find(".pt-show-table").hide(),c(a).find(".pt-hide-table").hide()},_renderHeader:function(a,e){var d=c("<tr>");colspan="__other__"==a[a.length-1][0]?a.length-1:a.length;d.append(c('<th scope="col">'+e.layer+"</th>"));(1<a.length||a[0][4])&&d.append(c('<th scope="col" colspan="'+colspan+'">'+e.cols+"</th>"));this.options.showTotals&&d.append(c('<th class="totals_header row_totals" scope="col" rowspan="2">'+
e.total+"</th>"));return c("<thead>").append(d)},_renderColumns:function(a,e){var d=c("<tr>"),b;d.append(c('<th scope="col">'+e.rows+"</th>"));for(var g=1==a.length&&null===a[0][4]?!0:!1,h=0;h<a.length;h++)"__other__"==a[h][0]||g&&this.options.showTotals||(b=g?"":a[h][4],d.append(c('<th scope="col">'+b+"</th>")));return d},_renderRows:function(a,e,d,b){for(var g=c("<tbody>"),h=this.options.showTotals,f=1==a.length&&null===a[0][4]?!0:!1,l,t,r=0;r<b.length;r++)l=a[r],"__other__"==l[0]||f&&this.options.showTotals||
(t=f?"":a[r][4],t=c('<tr class="'+(r%2?"odd":"even")+'"><td>'+t+"</td></tr>").append(this._renderCells(b[r],e,d)),h&&t.append(c("<td>"+l[2]+"</td>")),g.append(t));return g},_renderCells:function(a,e,d){for(var b,g=d.none,h=1==e.length&&null===e[0][4]?!0:!1,f=[],l,t,r=0;r<a.length;r++)if(!("__other__"==e[r][0]||h&&this.options.showTotals)){b=a[r];d=b.items;l=c("<td>");if(null===d)t=c('<div class="pt-cell-value">'+g+"</div>");else if(c.isArray(d)){t=c('<div class="pt-cell-value">');list=c("<ul>");for(var q=
0;q<d.length;q++)list.append(c("<li>"+d[q]+"</li>"));t.append(list)}else t=c('<div class="pt-cell-value">'+d+"</div>");l.append(t);b=b.keys;d&&(b&&b.length)&&l.data("records",b).append(c('<div class="pt-cell-zoom"></div>'));f.push(l)}return f},_renderFooter:function(a,e,d,b){var g=1==e.length&&null===e[0][4]?!0:!1;if(this.options.showTotals){var h,f;f=h=0;for(len=a.length;h<len;h++)"__other__"!=a[h][0]&&f++;a=c('<tr class="'+(f%2?"odd":"even")+' totals_row"><th class="totals_header" scope="row">'+
d.total+"</th></tr>");for(h=0;h<e.length;h++)"__other__"==e[h][0]||g||a.append(c("<td>"+e[h][2]+"</td>"));a.append(c("<td>"+b+"</td>"));return c("<tfoot>").append(a)}return null},_renderChartOptions:function(){var a=this.element,e=c(a).find(".pt-chart-controls").first().empty(),d=this.data;if(!d.empty&&this.options.renderChart){var d=d.labels,b=c(a).attr("id"),a=d.layer,g=d.rows,h=d.cols,f=d.per,l=c('<div class="pt-chart-opts">'),t=b+"-pchart-rows",r=b+"-vchart-rows",q=b+"-hchart-rows",H=b+"-pchart-cols",
D=b+"-vchart-cols",b=b+"-hchart-cols";a&&c(l).append(c('<span class="pt-chart-label">'+a+"</span>"));g&&c(l).append(c('<div id="'+t+'" class="pt-chart-icon pt-pchart"/><div id="'+r+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+f+" "+g+"</span>"));h&&c(l).append(c('<div id="'+H+'" class="pt-chart-icon pt-pchart"/><div id="'+D+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+f+" "+h+"</span>"));g&&h&&c(l).append(c('<span class="pt-chart-label">| '+d.breakdown+
'</span><div id="'+q+'" class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+[f,g,"&amp;",h].join(" ")+'</span><div id="'+b+'"  class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+[f,h,"&amp;",g].join(" ")+"</span>"));c(e).append(l)}},_renderChart:function(a){var e=this.data;c(this.element).find(".pt-chart-contents").hide();var d=this.chart;if(d&&(c(d).unbind("plothover").unbind("plotclick").empty(),!e.empty&&this.options.renderChart))if(!1===a)this.options.collapseChart=!0;
else{d=this.options.collapseChart;if("undefined"==typeof a||!a){if(d)return;a=this.chart_options.currentChart}if("undefined"==typeof a||!a){if(d)return;a=this.options.defaultChart}if("undefined"!=typeof a&&a){this.options.collapseChart=!1;this.chart_options.currentChart=a;d=a.type;a=a.axis;var b=e.labels,g=b.per,h=b.layer+" "+g+" "+b.rows,b=b.layer+" "+g+" "+b.cols,g=e.filter,f=g[0],l=g[1],t=g[2];"piechart"==d?"rows"==a?this._renderPieChart(e.rows,h,f,l):this._renderPieChart(e.cols,b,f,t):"barchart"==
d?"rows"==a?this._renderBarChart(e.rows,h,f,l):this._renderBarChart(e.cols,b,f,t):"breakdown"==d&&("rows"==a?this._renderBreakDown(e,0,h,g):this._renderBreakDown(e,1,b,g))}}},_renderPieChart:function(a,e,d,b){var g=this.chart;if(g){c(g).closest(".pt-chart-contents").show().css({width:"800px"});c(g).css({height:"360px"});for(var h=[],f=0;f<a.length;f++){var l=a[f];l[1]||h.push({label:l[4],data:l[2],key:l[3]})}e?c(g).siblings(".pt-chart-title").html("<h4>"+e+"</h4>"):c(g).siblings(".pt-chart-title").empty();
reportChart=jQuery.plot(c(g),h,{series:{pie:{show:!0,radius:125}},legend:{show:!0,position:"ne"},grid:{hoverable:!0,clickable:!0}});var t=this;this.chart_options.currentDataIndex=null;c(g).bind("plothover",function(a,b,d){if(d){if(t.chart_options.currentDataIndex!=d.seriesIndex){t._removeChartTooltip();t.chart_options.currentDataIndex=d.seriesIndex;a=d.series.data[0][1];var e=d.series.percent.toFixed(1),f='<div class="pt-tooltip-label">'+d.series.label+"</div>";t._renderChartTooltip(b.pageX,b.pageY,
f+('<div class="pt-tooltip-text">'+a+" ("+e+"%)</div>"));c(".pt-tooltip-label").css({color:d.series.color})}}else t._removeChartTooltip()});d&&b&&c(g).bind("plotclick",function(a,c,e){if(e){a={};try{a[b]=h[e.seriesIndex].key}catch(f){return}e=t._updateURL(d,a);window.open(e,"_blank")}})}},_renderBarChart:function(a,e,d,b){var g=this.chart;if(g){c(g).closest(".pt-chart-contents").show().css({width:"96%"});c(g).css({height:"360px"});for(var h=[],f=[],l=0,t=0;t<a.length;t++){var r=a[t];r[1]||(h.push({label:r[4],
data:[[l+1,r[2]]],key:r[3]}),f.push([l+1,r[4]]),l++)}e?c(g).siblings(".pt-chart-title").html("<h4>"+e+"</h4>"):c(g).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(c(g),h,{series:{bars:{show:!0,barWidth:0.6,align:"center"}},legend:{show:!1,position:"ne"},grid:{hoverable:!0,clickable:!0},xaxis:{ticks:f,min:0,max:h.length+1,tickLength:0}});var q=this;this.chart_options.currentDataIndex=null;c(g).bind("plothover",function(a,b,d){d?q.chart_options.currentDataIndex!=d.seriesIndex&&(q._removeChartTooltip(),
q.chart_options.currentDataIndex=d.seriesIndex,a='<div class="pt-tooltip-label">'+d.series.label+"</div>",a+='<div class="pt-tooltip-text">'+d.series.data[0][1]+"</div>",q._renderChartTooltip(b.pageX,b.pageY,a),c(".pt-tooltip-label").css({color:d.series.color})):q._removeChartTooltip()});d&&b&&c(g).bind("plotclick",function(a,c,e){if(e){a={};try{a[b]=h[e.seriesIndex].key}catch(f){return}e=q._updateURL(d,a);window.open(e,"_blank")}})}},_renderBreakDown:function(a,e,d,b){var g=this.chart;if(g){c(g).closest(".pt-chart-contents").show().css({width:"96%"});
var h=b[0],f,l,t=a.cells,r,q=[],C=[];0===e?(e=a.rows,r=a.cols,a=function(a,b){return t[q[a]][C[b]].value},f=b[1],l=b[2]):(e=a.cols,r=a.rows,a=function(a,b){return t[C[b]][q[a]].value},f=b[2],l=b[1]);var D=[],B=[];b=0;for(len=e.length;b<len;b++)e[b][1]||(D.push(e[b]),q.push(b));b=0;for(len=r.length;b<len;b++)r[b][1]||(B.push(r[b]),C.push(b));b=Math.max(D.length*Math.max(16*(B.length+1),50)+70,360);c(g).css({height:b+"px"});b=[];for(var M=e=0;M<B.length;M++){for(var x={label:B[M][4]},P=[],A,y=0;y<D.length;y++)r=
(D.length-y)*(B.length+1)-M,A=a(y,M),A>e&&(e=A),P.push([A,r]);x.data=P;b.push(x)}a=[];for(y=0;y<D.length;y++)M=D[y][4],r=(D.length-y)*(B.length+1)+1,a.push([r,M]);d?c(g).siblings(".pt-chart-title").html("<h4>"+d+"</h4>"):c(g).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(c(g),b,{series:{bars:{show:!0,barWidth:0.8,align:"center",horizontal:!0}},legend:{show:!0,position:"ne"},yaxis:{ticks:a,labelWidth:120,max:D.length*(B.length+1)+1},xaxis:{max:1.1*e},grid:{hoverable:!0,clickable:!0}});
c(".flot-y-axis .tickLabel").css({"padding-top":"20px",left:"0px",width:"120px"});var J=this;this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null;c(g).bind("plothover",function(a,b,d){if(d){if(J.chart_options.currentDataIndex!=d.dataIndex||J.chart_options.currentSeriesIndex!=d.seriesIndex)J._removeChartTooltip(),J.chart_options.currentDataIndex=d.dataIndex,J.chart_options.currentSeriesIndex=d.seriesIndex,a='<div class="pt-tooltip-label">'+D[d.dataIndex][4]+"</div>",
a+='<div class="pt-tooltip-text">'+d.series.label+' : <span class="pt-tooltip-value">'+d.datapoint[0]+"</span></div>",J._renderChartTooltip(b.pageX,b.pageY,a),c(".pt-tooltip-label").css({"padding-bottom":"8px"}),c(".pt-tooltip-text").css({color:d.series.color}),c(".pt-tooltip-value").css({"font-weight":"bold"})}else J._removeChartTooltip()});h&&(f&&l)&&c(g).bind("plotclick",function(a,b,c){if(c){a={};try{a[f]=D[c.dataIndex][3],a[l]=B[c.seriesIndex][3]}catch(d){return}c=J._updateURL(h,a);window.open(c,
"_blank")}})}},_renderChartTooltip:function(a,e,d){c('<div class="pt-chart-tooltip">'+d+"</div>").css({position:"absolute",display:"none",top:e-50,left:a+10,border:"1px solid #999",padding:"10px","min-height":"50px","max-width":"240px","z-index":"501","background-color":"white",color:"#000",opacity:0.95}).appendTo("body").fadeIn(200)},_removeChartTooltip:function(){c(".pt-chart-tooltip").remove();this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null},_getOptions:function(){var a=
"#"+c(this.element).attr("id");return{rows:c(a+"-rows").val(),cols:c(a+"-cols").val(),fact:c(a+"-fact").val(),totals:c(a+"-totals").is(":checked")?1:0}},_getFilters:function(){var a="#"+c(this.element).attr("id"),a=c(a+"-filters");try{return a.length?S3.search.getCurrentFilters(a.first()):null}catch(e){}},_updateURL:function(a,c){var d=a.split("?"),b={};if(1<d.length){var g=d[1].split("&"),h,f,l;f=0;for(l=g.length;f<l;f++)h=g[f].split("="),1<h.length&&(b[decodeURIComponent(h[0])]=decodeURIComponent(h[1]))}if(c)for(option in c)newopt=
c[option],b[option]=newopt?newopt:null;g=[];for(option in b)null!==b[option]&&g.push(option+"="+b[option]);b=g.join("&");d=d[0];b&&(d=d+"?"+b);return d},_updateAjaxURL:function(a,e){var d=this.options.ajaxURL.split("?"),b=null,b=[];needs_reload=!1;var g;1<d.length?(g=d[1],g=g.split("&")):g=[];var h,f;if(a)for(h in a)newopt=a[h],f=h+"="+newopt,"totals"==h?this.options.showTotals=newopt?!0:!1:needs_reload||-1!=c.inArray(f,g)||(needs_reload=!0),b.push(f);h={};var l={},t,r,q;if(e)for(t=0,r=e.length;t<
r;t++)f=e[t],q=f[0],f=f[1],null===f?h[q]||(l[q]=!0):(l[q]&&(l[q]=!1),h[q]?h[q].push(q+"="+f):h[q]=[q+"="+f]);t=0;for(r=g.length;t<r;t++)f=g[t].split("="),1<f.length&&(q=decodeURIComponent(f[0]),f=decodeURIComponent(f[1]),l[q]?needs_reload=!0:h[q]?needs_reload||-1!=c.inArray(q+"="+f,h[q])||(needs_reload=!0):"aggregate"!=q&&(a&&a.hasOwnProperty(q)||b.push(g[t])));for(q in h)for(t=0,r=h[q].length;t<r;t++)needs_reload||-1!=c.inArray(h[q][t],g)||(needs_reload=!0),b.push(h[q][t]);b=b.join("&");d=d[0];b&&
(d=d+"?"+b);this.options.ajaxURL=d;return needs_reload},reload:function(a,e,d){d="undefined"!=typeof d?d:!0;"undefined"==typeof e&&(e=this._getFilters());var b=this,g=this.element,h,f=c(g).find('input[type="hidden"][name="pivotdata"]');if(f.length){if(a||e)h=this._updateAjaxURL(a,e);h||d?(a=this.options.ajaxURL,c(g).find(".pt-throbber").show(),c(g).find(".pt-empty").hide(),c.ajax({url:a,dataType:"json"}).done(function(a){f.first().val(JSON.stringify(a));b.refresh()}).fail(function(a,b,c){msg="UNAUTHORIZED"==
c?i18n.gis_requires_login:a.responseText;console.log(msg)})):(c(g).find(".pt-throbber").show(),b.refresh())}},_bindEvents:function(a){var e=this,d=this.element;a=this.data;var b=c(d).attr("id");c("#"+b+"-options legend").click(function(){c(this).siblings().toggle();c(this).children().toggle()});c("#"+b+"-filters legend").click(function(){c(this).siblings().toggle();c(this).children().toggle()});c(d).find(".pt-hide-table").click(function(){e.table_options.hidden=!0;c(d).find(".pt-table").hide();c(this).siblings(".pt-show-table").show();
c(this).hide()});c(d).find(".pt-show-table").click(function(){e.table_options.hidden=!1;c(d).find(".pt-table").show();c(this).siblings(".pt-hide-table").show();c(this).hide()});c("#"+b+"-totals").click(function(){var a=c(this).is(":checked");e.options.showTotals!=a&&e.reload({totals:a},null,!1)});c("#"+b+"-rows, #"+b+"-cols, #"+b+"-fact").on("change.autosubmit",function(){c(d).find(".pt-form").trigger("optionChanged")});if(this.options.autoSubmit){var g=this.options.autoSubmit;c(d).find(".pt-form").on("optionChanged",
function(){var a=c(this);if(!a.data("noAutoSubmit")){var b=a.data("autoSubmitTimeout");b&&clearTimeout(b);b=setTimeout(function(){var a=e._getOptions(),b=e._getFilters();e.reload(a,b,!1)},g);a.data("autoSubmitTimeout",b)}})}else c(d).find("input.pt-submit").click(function(){var a=e._getOptions(),b=e._getFilters();e.reload(a,b,!1)});c("#"+b+" div.pt-table div.pt-cell-zoom").click(function(b){b=c(b.currentTarget);var d=b.closest("td"),e=d.find(".pt-cell-records");if(0<e.length)e.remove(),b.removeClass("opened");
else{for(var g=d.data("records"),e=c("<div/>").addClass("pt-cell-records"),r=c("<ul/>"),q=0;q<g.length;q++)r.append("<li>"+a.lookup[g[q]]+"</li>");e.append(r);d.append(e);b.addClass("opened")}});c("#"+b+"-pchart-rows").click(function(){e._renderChart({type:"piechart",axis:"rows"})});c("#"+b+"-vchart-rows").click(function(){e._renderChart({type:"barchart",axis:"rows"})});c("#"+b+"-pchart-cols").click(function(){e._renderChart({type:"piechart",axis:"cols"})});c("#"+b+"-vchart-cols").click(function(){e._renderChart({type:"barchart",
axis:"cols"})});c("#"+b+"-hchart-rows").click(function(){e._renderChart({type:"breakdown",axis:"rows"})});c("#"+b+"-hchart-cols").click(function(){e._renderChart({type:"breakdown",axis:"cols"})});c(d).find(".pt-hide-chart").click(function(){e._renderChart(!1)})},_unbindEvents:function(){var a=this.element,e=c(a).attr("id");c("#"+e+" div.pt-table div.pt-cell-zoom").unbind("click");c("#"+e+"-options legend").unbind("click");c("#"+e+"-filters legend").unbind("click");c(e+"-totals").unbind("click");c("#"+
e+"-rows, #"+e+"-cols, #"+e+"-fact").unbind("change.autosubmit");c(a).find(".pt-form").unbind("optionChanged");c(a).find("input.pt-submit").unbind("click");c("#"+e+"-pchart-rows").unbind("click");c("#"+e+"-vchart-rows").unbind("click");c("#"+e+"-pchart-cols").unbind("click");c("#"+e+"-vchart-cols").unbind("click");c(a).find(".pt-hide-table").unbind("click");c(a).find(".pt-show-table").unbind("click");c(a).find(".pt-hide-chart").unbind("click")}})})(jQuery);
