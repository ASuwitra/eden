/*
: 2013 (c) Sahana Software Foundation
 @license: MIT

 requires: jQuery 1.9.1+
 requires: jQuery UI 1.10 widget factory

*/
(function(d){d.color={};d.color.make=function(q,c,a,e){var b={};b.r=q||0;b.g=c||0;b.b=a||0;b.a=null!=e?e:1;b.add=function(a,d){for(var c=0;c<a.length;++c)b[a.charAt(c)]+=d;return b.normalize()};b.scale=function(a,d){for(var c=0;c<a.length;++c)b[a.charAt(c)]*=d;return b.normalize()};b.toString=function(){return 1<=b.a?"rgb("+[b.r,b.g,b.b].join()+")":"rgba("+[b.r,b.g,b.b,b.a].join()+")"};b.normalize=function(){function a(b,d,c){return d<b?b:d>c?c:d}b.r=a(0,parseInt(b.r),255);b.g=a(0,parseInt(b.g),255);
b.b=a(0,parseInt(b.b),255);b.a=a(0,b.a,1);return b};b.clone=function(){return d.color.make(b.r,b.b,b.g,b.a)};return b.normalize()};d.color.extract=function(q,c){var a;do{a=q.css(c).toLowerCase();if(""!=a&&"transparent"!=a)break;q=q.parent()}while(!d.nodeName(q.get(0),"body"));"rgba(0, 0, 0, 0)"==a&&(a="transparent");return d.color.parse(a)};d.color.parse=function(s){var c,a=d.color.make;if(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(s))return a(parseInt(c[1],10),parseInt(c[2],
10),parseInt(c[3],10));if(c=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(s))return a(parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10),parseFloat(c[4]));if(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(s))return a(2.55*parseFloat(c[1]),2.55*parseFloat(c[2]),2.55*parseFloat(c[3]));if(c=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(s))return a(2.55*
parseFloat(c[1]),2.55*parseFloat(c[2]),2.55*parseFloat(c[3]),parseFloat(c[4]));if(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(s))return a(parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16));if(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(s))return a(parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16));s=d.trim(s).toLowerCase();if("transparent"==s)return a(255,255,255,0);c=q[s]||[0,0,0];return a(c[0],c[1],c[2])};var q={aqua:[0,255,255],azure:[240,255,255],beige:[245,
245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,
144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);
(function(d){function q(a,c){var b=c.children("."+a)[0];if(null==b&&(b=document.createElement("canvas"),b.className=a,d(b).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(c),!b.getContext))if(window.G_vmlCanvasManager)b=window.G_vmlCanvasManager.initElement(b);else throw Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=
b;b=this.context=b.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1);this.resize(c.width(),c.height());this.textContainer=null;this.text={};this._textCache={}}function s(a,c,b,k){function m(l,x){x=[G].concat(x);for(var g=0;g<l.length;++g)l[g].apply(this,x)}function h(l){for(var x=[],g=0;g<l.length;++g){var a=d.extend(!0,{},n.series);null!=l[g].data?
(a.data=l[g].data,delete l[g].data,d.extend(!0,a,l[g]),l[g].data=a.data):a.data=l[g];x.push(a)}C=x;g=C.length;x=-1;for(l=0;l<C.length;++l)a=C[l].color,null!=a&&(g--,"number"==typeof a&&a>x&&(x=a));g<=x&&(g=x+1);var x=[],b=n.colors,c=b.length,B=0;for(l=0;l<g;l++)a=d.color.parse(b[l%c]||"#666"),0==l%c&&l&&(B=0<=B?.5>B?-B-.2:0:-B),x[l]=a.scale("rgb",1+B);for(l=g=0;l<C.length;++l){a=C[l];null==a.color?(a.color=x[g].toString(),++g):"number"==typeof a.color&&(a.color=x[a.color].toString());if(null==a.lines.show){var e,
b=!0;for(e in a)if(a[e]&&a[e].show){b=!1;break}b&&(a.lines.show=!0)}null==a.lines.zero&&(a.lines.zero=!!a.lines.fill);a.xaxis=v(N,f(a,"x"));a.yaxis=v(T,f(a,"y"))}F()}function f(l,x){var g=l[x+"axis"];"object"==typeof g&&(g=g.n);"number"!=typeof g&&(g=1);return g}function p(){return d.grep(N.concat(T),function(l){return l})}function E(l){var x={},g,a;for(g=0;g<N.length;++g)(a=N[g])&&a.used&&(x["x"+a.n]=a.c2p(l.left));for(g=0;g<T.length;++g)(a=T[g])&&a.used&&(x["y"+a.n]=a.c2p(l.top));void 0!==x.x1&&
(x.x=x.x1);void 0!==x.y1&&(x.y=x.y1);return x}function v(l,a){l[a-1]||(l[a-1]={n:a,direction:l==N?"x":"y",options:d.extend(!0,{},l==N?n.xaxis:n.yaxis)});return l[a-1]}function F(){function l(l,g,a){g<l.datamin&&g!=-b&&(l.datamin=g);a>l.datamax&&a!=b&&(l.datamax=a)}var a=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,b=Number.MAX_VALUE,c,e,B,H,u,J,Q,n,k,r,h,f;d.each(p(),function(l,b){b.datamin=a;b.datamax=g;b.used=!1});for(c=0;c<C.length;++c)u=C[c],u.datapoints={points:[]},m(R.processRawData,
[u,u.data,u.datapoints]);for(c=0;c<C.length;++c){u=C[c];h=u.data;f=u.datapoints.format;if(!f){f=[];f.push({x:!0,number:!0,required:!0});f.push({y:!0,number:!0,required:!0});if(u.bars.show||u.lines.show&&u.lines.fill)f.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:!!(u.bars.show&&u.bars.zero||u.lines.show&&u.lines.zero)}),u.bars.horizontal&&(delete f[f.length-1].y,f[f.length-1].x=!0);u.datapoints.format=f}if(null==u.datapoints.pointsize){u.datapoints.pointsize=f.length;Q=u.datapoints.pointsize;
J=u.datapoints.points;var ba=u.lines.show&&u.lines.steps;u.xaxis.used=u.yaxis.used=!0;for(e=B=0;e<h.length;++e,B+=Q){r=h[e];var E=null==r;if(!E)for(H=0;H<Q;++H){n=r[H];if(k=f[H])k.number&&null!=n&&(n=+n,isNaN(n)?n=null:Infinity==n?n=b:-Infinity==n&&(n=-b)),null==n&&(k.required&&(E=!0),null!=k.defaultValue&&(n=k.defaultValue));J[B+H]=n}if(E)for(H=0;H<Q;++H)n=J[B+H],null!=n&&(k=f[H],k.autoscale&&(k.x&&l(u.xaxis,n,n),k.y&&l(u.yaxis,n,n))),J[B+H]=null;else if(ba&&0<B&&null!=J[B-Q]&&J[B-Q]!=J[B]&&J[B-
Q+1]!=J[B+1]){for(H=0;H<Q;++H)J[B+Q+H]=J[B+H];J[B+1]=J[B-Q+1];B+=Q}}}}for(c=0;c<C.length;++c)u=C[c],m(R.processDatapoints,[u,u.datapoints]);for(c=0;c<C.length;++c){u=C[c];J=u.datapoints.points;Q=u.datapoints.pointsize;f=u.datapoints.format;r=B=a;ba=h=g;for(e=0;e<J.length;e+=Q)if(null!=J[e])for(H=0;H<Q;++H)n=J[e+H],(k=f[H])&&!1!==k.autoscale&&n!=b&&n!=-b&&(k.x&&(n<B&&(B=n),n>h&&(h=n)),k.y&&(n<r&&(r=n),n>ba&&(ba=n)));if(u.bars.show){switch(u.bars.align){case "left":e=0;break;case "right":e=-u.bars.barWidth;
break;case "center":e=-u.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+u.bars.align);}u.bars.horizontal?(r+=e,ba+=e+u.bars.barWidth):(B+=e,h+=e+u.bars.barWidth)}l(u.xaxis,B,h);l(u.yaxis,r,ba)}d.each(p(),function(l,b){b.datamin==a&&(b.datamin=null);b.datamax==g&&(b.datamax=null)})}function s(l){function a(l){return l}var g,b,c=l.options.transform||a,d=l.options.inverseTransform;"x"==l.direction?(g=l.scale=U/Math.abs(c(l.max)-c(l.min)),b=Math.min(c(l.max),c(l.min))):(g=l.scale=
S/Math.abs(c(l.max)-c(l.min)),g=-g,b=Math.max(c(l.max),c(l.min)));l.p2c=c==a?function(l){return(l-b)*g}:function(l){return(c(l)-b)*g};l.c2p=d?function(l){return d(b+l/g)}:function(l){return b+l/g}}function t(l){var a=l.labelWidth,g=l.labelHeight,b=l.options.position,c=l.options.tickLength,e=n.grid.axisMargin,B=n.grid.labelMargin,H="x"==l.direction?N:T,u,J=d.grep(H,function(l){return l&&l.options.position==b&&l.reserveSpace});d.inArray(l,J)==J.length-1&&(e=0);null==c&&(c=d.grep(H,function(l){return l&&
l.reserveSpace}),c=(u=0==d.inArray(l,c))?"full":5);isNaN(+c)||(B+=+c);"x"==l.direction?(g+=B,"bottom"==b?(w.bottom+=g+e,l.box={top:L.height-w.bottom,height:g}):(l.box={top:w.top+e,height:g},w.top+=g+e)):(a+=B,"left"==b?(l.box={left:w.left+e,width:a},w.left+=a+e):(w.right+=a+e,l.box={left:L.width-w.right,width:a}));l.position=b;l.tickLength=c;l.box.padding=B;l.innermost=u}function O(){var l=n.grid.minBorderMargin,a={x:0,y:0},g;if(null==l)for(g=l=0;g<C.length;++g)l=Math.max(l,2*(C[g].points.radius+
C[g].points.lineWidth/2));a.x=a.y=Math.ceil(l);d.each(p(),function(l,g){var b=g.direction;g.reserveSpace&&(a[b]=Math.ceil(Math.max(a[b],("x"==b?g.labelWidth:g.labelHeight)/2)))});w.left=Math.max(a.x,w.left);w.right=Math.max(a.x,w.right);w.top=Math.max(a.y,w.top);w.bottom=Math.max(a.y,w.bottom)}function z(){var l,a=p(),g=n.grid.show;for(l in w){var b=n.grid.margin||0;w[l]="number"==typeof b?b:b[l]||0}m(R.processOffset,[w]);for(l in w)w[l]="object"==typeof n.grid.borderWidth?w[l]+(g?n.grid.borderWidth[l]:
0):w[l]+(g?n.grid.borderWidth:0);d.each(a,function(l,a){a.show=a.options.show;null==a.show&&(a.show=a.used);a.reserveSpace=a.show||a.options.reserveSpace;var g=a.options,b=+(null!=g.min?g.min:a.datamin),c=+(null!=g.max?g.max:a.datamax),x=c-b;if(0==x){if(x=0==c?1:.01,null==g.min&&(b-=x),null==g.max||null!=g.min)c+=x}else{var d=g.autoscaleMargin;null!=d&&(null==g.min&&(b-=x*d,0>b&&null!=a.datamin&&0<=a.datamin&&(b=0)),null==g.max&&(c+=x*d,0<c&&null!=a.datamax&&0>=a.datamax&&(c=0)))}a.min=b;a.max=c});
if(g){b=d.grep(a,function(l){return l.reserveSpace});d.each(b,function(l,a){A(a);var g=a.options.ticks,b=[];null==g||"number"==typeof g&&0<g?b=a.tickGenerator(a):g&&(b=d.isFunction(g)?g(a):g);var c;a.ticks=[];for(g=0;g<b.length;++g){var x=null,e=b[g];"object"==typeof e?(c=+e[0],1<e.length&&(x=e[1])):c=+e;null==x&&(x=a.tickFormatter(c,a));isNaN(c)||a.ticks.push({v:c,label:x})}b=a.ticks;a.options.autoscaleMargin&&0<b.length&&(null==a.options.min&&(a.min=Math.min(a.min,b[0].v)),null==a.options.max&&
1<b.length&&(a.max=Math.max(a.max,b[b.length-1].v)));b=a.options;g=a.ticks||[];c=b.labelWidth||0;x=b.labelHeight||0;e=c||"x"==a.direction?Math.floor(L.width/(g.length||1)):null;legacyStyles=a.direction+"Axis "+a.direction+a.n+"Axis";layer="flot-"+a.direction+"-axis flot-"+a.direction+a.n+"-axis "+legacyStyles;font=b.font||"flot-tick-label tickLabel";for(var n=0;n<g.length;++n){var D=g[n];D.label&&(D=L.getTextInfo(layer,D.label,font,null,e),c=Math.max(c,D.width),x=Math.max(x,D.height))}a.labelWidth=
b.labelWidth||c;a.labelHeight=b.labelHeight||x});for(l=b.length-1;0<=l;--l)t(b[l]);O();d.each(b,function(l,a){"x"==a.direction?(a.box.left=w.left-a.labelWidth/2,a.box.width=L.width-w.left-w.right+a.labelWidth):(a.box.top=w.top-a.labelHeight/2,a.box.height=L.height-w.bottom-w.top+a.labelHeight)})}U=L.width-w.left-w.right;S=L.height-w.bottom-w.top;d.each(a,function(l,a){s(a)});g&&fa();V()}function A(l){var a=l.options,g;g="number"==typeof a.ticks&&0<a.ticks?a.ticks:.3*Math.sqrt("x"==l.direction?L.width:
L.height);g=(l.max-l.min)/g;var b=-Math.floor(Math.log(g)/Math.LN10),c=a.tickDecimals;null!=c&&b>c&&(b=c);var e=Math.pow(10,-b),n=g/e,k;1.5>n?k=1:3>n?(k=2,2.25<n&&(null==c||b+1<=c)&&(k=2.5,++b)):k=7.5>n?5:10;k*=e;null!=a.minTickSize&&k<a.minTickSize&&(k=a.minTickSize);l.delta=g;l.tickDecimals=Math.max(0,null!=c?c:b);l.tickSize=a.tickSize||k;if("time"==a.mode&&!l.tickGenerator)throw Error("Time mode requires the flot.time plugin.");l.tickGenerator||(l.tickGenerator=function(l){var a=[],g;g=l.tickSize;
g*=Math.floor(l.min/g);var b=0,c=Number.NaN,x;do x=c,c=g+b*l.tickSize,a.push(c),++b;while(c<l.max&&c!=x);return a},l.tickFormatter=function(l,a){var g=a.tickDecimals?Math.pow(10,a.tickDecimals):1,b=""+Math.round(l*g)/g;if(null!=a.tickDecimals){var c=b.indexOf("."),c=-1==c?0:b.length-c-1;if(c<a.tickDecimals)return(c?b:b+".")+(""+g).substr(1,a.tickDecimals-c)}return b});d.isFunction(a.tickFormatter)&&(l.tickFormatter=function(l,g){return""+a.tickFormatter(l,g)});if(null!=a.alignTicksWithAxis){var u=
("x"==l.direction?N:T)[a.alignTicksWithAxis-1];u&&u.used&&u!=l&&(g=l.tickGenerator(l),0<g.length&&(null==a.min&&(l.min=Math.min(l.min,g[0])),null==a.max&&1<g.length&&(l.max=Math.max(l.max,g[g.length-1]))),l.tickGenerator=function(l){var a=[],g,b;for(b=0;b<u.ticks.length;++b)g=(u.ticks[b].v-u.min)/(u.max-u.min),g=l.min+g*(l.max-l.min),a.push(g);return a},l.mode||null!=a.tickDecimals||(g=Math.max(0,-Math.floor(Math.log(l.delta)/Math.LN10)+1),b=l.tickGenerator(l),1<b.length&&/\..*0$/.test((b[1]-b[0]).toFixed(g))||
(l.tickDecimals=g)))}}function K(){L.clear();m(R.drawBackground,[r]);var l=n.grid;l.show&&l.backgroundColor&&(r.save(),r.translate(w.left,w.top),r.fillStyle=na(n.grid.backgroundColor,S,0,"rgba(255, 255, 255, 0)"),r.fillRect(0,0,U,S),r.restore());l.show&&!l.aboveData&&oa();for(var a=0;a<C.length;++a){m(R.drawSeries,[r,C[a]]);var g=C[a];g.lines.show&&aa(g);g.bars.show&&y(g);g.points.show&&I(g)}m(R.draw,[r]);l.show&&l.aboveData&&oa();L.render();ca()}function W(l,a){for(var g,b,c,d,e=p(),n=0;n<e.length;++n)if(g=
e[n],g.direction==a&&(d=a+g.n+"axis",l[d]||1!=g.n||(d=a+"axis"),l[d])){b=l[d].from;c=l[d].to;break}l[d]||(g="x"==a?N[0]:T[0],b=l[a+"1"],c=l[a+"2"]);null!=b&&null!=c&&b>c&&(d=b,b=c,c=d);return{from:b,to:c,axis:g}}function oa(){var l,a,g;r.save();r.translate(w.left,w.top);if(g=n.grid.markings)for(d.isFunction(g)&&(a=G.getAxes(),a.xmin=a.xaxis.min,a.xmax=a.xaxis.max,a.ymin=a.yaxis.min,a.ymax=a.yaxis.max,g=g(a)),l=0;l<g.length;++l){a=g[l];var b=W(a,"x"),c=W(a,"y");null==b.from&&(b.from=b.axis.min);null==
b.to&&(b.to=b.axis.max);null==c.from&&(c.from=c.axis.min);null==c.to&&(c.to=c.axis.max);b.to<b.axis.min||b.from>b.axis.max||c.to<c.axis.min||c.from>c.axis.max||(b.from=Math.max(b.from,b.axis.min),b.to=Math.min(b.to,b.axis.max),c.from=Math.max(c.from,c.axis.min),c.to=Math.min(c.to,c.axis.max),b.from==b.to&&c.from==c.to)||(b.from=b.axis.p2c(b.from),b.to=b.axis.p2c(b.to),c.from=c.axis.p2c(c.from),c.to=c.axis.p2c(c.to),b.from==b.to||c.from==c.to?(r.beginPath(),r.strokeStyle=a.color||n.grid.markingsColor,
r.lineWidth=a.lineWidth||n.grid.markingsLineWidth,r.moveTo(b.from,c.from),r.lineTo(b.to,c.to),r.stroke()):(r.fillStyle=a.color||n.grid.markingsColor,r.fillRect(b.from,c.to,b.to-b.from,c.from-c.to)))}a=p();g=n.grid.borderWidth;for(b=0;b<a.length;++b){c=a[b];l=c.box;var e=c.tickLength,k,m,u,f;if(c.show&&0!=c.ticks.length){r.lineWidth=1;"x"==c.direction?(k=0,m="full"==e?"top"==c.position?0:S:l.top-w.top+("top"==c.position?l.height:0)):(m=0,k="full"==e?"left"==c.position?0:U:l.left-w.left+("left"==c.position?
l.width:0));c.innermost||(r.strokeStyle=c.options.color,r.beginPath(),u=f=0,"x"==c.direction?u=U+1:f=S+1,1==r.lineWidth&&("x"==c.direction?m=Math.floor(m)+.5:k=Math.floor(k)+.5),r.moveTo(k,m),r.lineTo(k+u,m+f),r.stroke());r.strokeStyle=c.options.tickColor;r.beginPath();for(l=0;l<c.ticks.length;++l){var h=c.ticks[l].v;u=f=0;isNaN(h)||h<c.min||h>c.max||"full"==e&&("object"==typeof g&&0<g[c.position]||0<g)&&(h==c.min||h==c.max)||("x"==c.direction?(k=c.p2c(h),f="full"==e?-S:e,"top"==c.position&&(f=-f)):
(m=c.p2c(h),u="full"==e?-U:e,"left"==c.position&&(u=-u)),1==r.lineWidth&&("x"==c.direction?k=Math.floor(k)+.5:m=Math.floor(m)+.5),r.moveTo(k,m),r.lineTo(k+u,m+f))}r.stroke()}}g&&(l=n.grid.borderColor,"object"==typeof g||"object"==typeof l?("object"!==typeof g&&(g={top:g,right:g,bottom:g,left:g}),"object"!==typeof l&&(l={top:l,right:l,bottom:l,left:l}),0<g.top&&(r.strokeStyle=l.top,r.lineWidth=g.top,r.beginPath(),r.moveTo(0-g.left,0-g.top/2),r.lineTo(U,0-g.top/2),r.stroke()),0<g.right&&(r.strokeStyle=
l.right,r.lineWidth=g.right,r.beginPath(),r.moveTo(U+g.right/2,0-g.top),r.lineTo(U+g.right/2,S),r.stroke()),0<g.bottom&&(r.strokeStyle=l.bottom,r.lineWidth=g.bottom,r.beginPath(),r.moveTo(U+g.right,S+g.bottom/2),r.lineTo(0,S+g.bottom/2),r.stroke()),0<g.left&&(r.strokeStyle=l.left,r.lineWidth=g.left,r.beginPath(),r.moveTo(0-g.left/2,S+g.bottom),r.lineTo(0-g.left/2,0),r.stroke())):(r.lineWidth=g,r.strokeStyle=n.grid.borderColor,r.strokeRect(-g/2,-g/2,U+g,S+g)));r.restore()}function fa(){d.each(p(),
function(a,b){if(b.show&&0!=b.ticks.length){var c=b.box,d="flot-"+b.direction+"-axis flot-"+b.direction+b.n+"-axis "+(b.direction+"Axis "+b.direction+b.n+"Axis"),e=b.options.font||"flot-tick-label tickLabel",n,k,m,u,f;L.removeText(d);for(var h=0;h<b.ticks.length;++h)n=b.ticks[h],!n.label||n.v<b.min||n.v>b.max||("x"==b.direction?(u="center",k=w.left+b.p2c(n.v),"bottom"==b.position?m=c.top+c.padding:(m=c.top+c.height-c.padding,f="bottom")):(f="middle",m=w.top+b.p2c(n.v),"left"==b.position?(k=c.left+
c.width-c.padding,u="right"):k=c.left+c.padding),L.addText(d,k,m,n.label,e,null,null,u,f))}})}function aa(a){function b(a,l,c,g,d){var e=a.points;a=a.pointsize;var n=null,x=null;r.beginPath();for(var k=a;k<e.length;k+=a){var m=e[k-a],f=e[k-a+1],h=e[k],p=e[k+1];if(null!=m&&null!=h){if(f<=p&&f<d.min){if(p<d.min)continue;m=(d.min-f)/(p-f)*(h-m)+m;f=d.min}else if(p<=f&&p<d.min){if(f<d.min)continue;h=(d.min-f)/(p-f)*(h-m)+m;p=d.min}if(f>=p&&f>d.max){if(p>d.max)continue;m=(d.max-f)/(p-f)*(h-m)+m;f=d.max}else if(p>=
f&&p>d.max){if(f>d.max)continue;h=(d.max-f)/(p-f)*(h-m)+m;p=d.max}if(m<=h&&m<g.min){if(h<g.min)continue;f=(g.min-m)/(h-m)*(p-f)+f;m=g.min}else if(h<=m&&h<g.min){if(m<g.min)continue;p=(g.min-m)/(h-m)*(p-f)+f;h=g.min}if(m>=h&&m>g.max){if(h>g.max)continue;f=(g.max-m)/(h-m)*(p-f)+f;m=g.max}else if(h>=m&&h>g.max){if(m>g.max)continue;p=(g.max-m)/(h-m)*(p-f)+f;h=g.max}m==n&&f==x||r.moveTo(g.p2c(m)+l,d.p2c(f)+c);n=h;x=p;r.lineTo(g.p2c(h)+l,d.p2c(p)+c)}}r.stroke()}function c(a,l,b){var g=a.points;a=a.pointsize;
for(var d=Math.min(Math.max(0,b.min),b.max),e=0,n=!1,x=1,m=0,k=0;!(0<a&&e>g.length+a);){var e=e+a,f=g[e-a],h=g[e-a+x],p=g[e],D=g[e+x];if(n){if(0<a&&null!=f&&null==p){k=e;a=-a;x=2;continue}if(0>a&&e==m+a){r.fill();n=!1;a=-a;x=1;e=m=k+a;continue}}if(null!=f&&null!=p){if(f<=p&&f<l.min){if(p<l.min)continue;h=(l.min-f)/(p-f)*(D-h)+h;f=l.min}else if(p<=f&&p<l.min){if(f<l.min)continue;D=(l.min-f)/(p-f)*(D-h)+h;p=l.min}if(f>=p&&f>l.max){if(p>l.max)continue;h=(l.max-f)/(p-f)*(D-h)+h;f=l.max}else if(p>=f&&
p>l.max){if(f>l.max)continue;D=(l.max-f)/(p-f)*(D-h)+h;p=l.max}n||(r.beginPath(),r.moveTo(l.p2c(f),b.p2c(d)),n=!0);if(h>=b.max&&D>=b.max)r.lineTo(l.p2c(f),b.p2c(b.max)),r.lineTo(l.p2c(p),b.p2c(b.max));else if(h<=b.min&&D<=b.min)r.lineTo(l.p2c(f),b.p2c(b.min)),r.lineTo(l.p2c(p),b.p2c(b.min));else{var E=f,ma=p;h<=D&&h<b.min&&D>=b.min?(f=(b.min-h)/(D-h)*(p-f)+f,h=b.min):D<=h&&D<b.min&&h>=b.min&&(p=(b.min-h)/(D-h)*(p-f)+f,D=b.min);h>=D&&h>b.max&&D<=b.max?(f=(b.max-h)/(D-h)*(p-f)+f,h=b.max):D>=h&&D>b.max&&
h<=b.max&&(p=(b.max-h)/(D-h)*(p-f)+f,D=b.max);f!=E&&r.lineTo(l.p2c(E),b.p2c(h));r.lineTo(l.p2c(f),b.p2c(h));r.lineTo(l.p2c(p),b.p2c(D));p!=ma&&(r.lineTo(l.p2c(p),b.p2c(D)),r.lineTo(l.p2c(ma),b.p2c(D)))}}}}r.save();r.translate(w.left,w.top);r.lineJoin="round";var d=a.lines.lineWidth,e=a.shadowSize;if(0<d&&0<e){r.lineWidth=e;r.strokeStyle="rgba(0,0,0,0.1)";var n=Math.PI/18;b(a.datapoints,Math.sin(n)*(d/2+e/2),Math.cos(n)*(d/2+e/2),a.xaxis,a.yaxis);r.lineWidth=e/2;b(a.datapoints,Math.sin(n)*(d/2+e/4),
Math.cos(n)*(d/2+e/4),a.xaxis,a.yaxis)}r.lineWidth=d;r.strokeStyle=a.color;if(e=M(a.lines,a.color,0,S))r.fillStyle=e,c(a.datapoints,a.xaxis,a.yaxis);0<d&&b(a.datapoints,0,0,a.xaxis,a.yaxis);r.restore()}function I(a){function b(a,l,c,g,d,e,f,n){var h=a.points;a=a.pointsize;for(var x=0;x<h.length;x+=a){var m=h[x],k=h[x+1];null==m||m<e.min||m>e.max||k<f.min||k>f.max||(r.beginPath(),m=e.p2c(m),k=f.p2c(k)+g,"circle"==n?r.arc(m,k,l,0,d?Math.PI:2*Math.PI,!1):n(r,m,k,l,d),r.closePath(),c&&(r.fillStyle=c,
r.fill()),r.stroke())}}r.save();r.translate(w.left,w.top);var c=a.points.lineWidth,d=a.shadowSize,e=a.points.radius,f=a.points.symbol;0==c&&(c=1E-4);0<c&&0<d&&(d/=2,r.lineWidth=d,r.strokeStyle="rgba(0,0,0,0.1)",b(a.datapoints,e,null,d+d/2,!0,a.xaxis,a.yaxis,f),r.strokeStyle="rgba(0,0,0,0.2)",b(a.datapoints,e,null,d/2,!0,a.xaxis,a.yaxis,f));r.lineWidth=c;r.strokeStyle=a.color;b(a.datapoints,e,M(a.points,a.color),0,!1,a.xaxis,a.yaxis,f);r.restore()}function pa(a,b,c,d,e,f,n,m,h,k,p,r){var E,z,q,v;p?
(v=z=q=!0,E=!1,p=c,c=b+d,e=b+e,a<p&&(b=a,a=p,p=b,E=!0,z=!1)):(E=z=q=!0,v=!1,p=a+d,a+=e,e=c,c=b,c<e&&(b=c,c=e,e=b,v=!0,q=!1));a<m.min||p>m.max||c<h.min||e>h.max||(p<m.min&&(p=m.min,E=!1),a>m.max&&(a=m.max,z=!1),e<h.min&&(e=h.min,v=!1),c>h.max&&(c=h.max,q=!1),p=m.p2c(p),e=h.p2c(e),a=m.p2c(a),c=h.p2c(c),n&&(k.beginPath(),k.moveTo(p,e),k.lineTo(p,c),k.lineTo(a,c),k.lineTo(a,e),k.fillStyle=n(e,c),k.fill()),0<r&&(E||z||q||v)&&(k.beginPath(),k.moveTo(p,e+f),E?k.lineTo(p,c+f):k.moveTo(p,c+f),q?k.lineTo(a,
c+f):k.moveTo(a,c+f),z?k.lineTo(a,e+f):k.moveTo(a,e+f),v?k.lineTo(p,e+f):k.moveTo(p,e+f),k.stroke()))}function y(a){r.save();r.translate(w.left,w.top);r.lineWidth=a.bars.lineWidth;r.strokeStyle=a.color;var b;switch(a.bars.align){case "left":b=0;break;case "right":b=-a.bars.barWidth;break;case "center":b=-a.bars.barWidth/2;break;default:throw Error("Invalid bar alignment: "+a.bars.align);}(function(b,c,d,e,f,n,m){var k=b.points;b=b.pointsize;for(var h=0;h<k.length;h+=b)null!=k[h]&&pa(k[h],k[h+1],k[h+
2],c,d,e,f,n,m,r,a.bars.horizontal,a.bars.lineWidth)})(a.datapoints,b,b+a.bars.barWidth,0,a.bars.fill?function(b,c){return M(a.bars,a.color,b,c)}:null,a.xaxis,a.yaxis);r.restore()}function M(a,b,c,e){var f=a.fill;if(!f)return null;if(a.fillColor)return na(a.fillColor,c,e,b);a=d.color.parse(b);a.a="number"==typeof f?f:.4;a.normalize();return a.toString()}function V(){a.find(".legend").remove();if(n.legend.show){for(var b=[],c=[],g=!1,e=n.legend.labelFormatter,f,h,k=0;k<C.length;++k)f=C[k],f.label&&
(h=e?e(f.label,f):f.label)&&c.push({label:h,color:f.color});if(n.legend.sorted)if(d.isFunction(n.legend.sorted))c.sort(n.legend.sorted);else if("reverse"==n.legend.sorted)c.reverse();else{var m="descending"!=n.legend.sorted;c.sort(function(a,b){return a.label==b.label?0:a.label<b.label!=m?1:-1})}for(k=0;k<c.length;++k)e=c[k],0==k%n.legend.noColumns&&(g&&b.push("</tr>"),b.push("<tr>"),g=!0),b.push('<td class="legendColorBox"><div style="border:1px solid '+n.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+
e.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+e.label+"</td>");g&&b.push("</tr>");0!=b.length&&(c='<table style="font-size:smaller;color:'+n.grid.color+'">'+b.join("")+"</table>",null!=n.legend.container?d(n.legend.container).html(c):(b="",g=n.legend.position,k=n.legend.margin,null==k[0]&&(k=[k,k]),"n"==g.charAt(0)?b+="top:"+(k[1]+w.top)+"px;":"s"==g.charAt(0)&&(b+="bottom:"+(k[1]+w.bottom)+"px;"),"e"==g.charAt(1)?b+="right:"+(k[0]+w.right)+"px;":"w"==g.charAt(1)&&(b+="left:"+
(k[0]+w.left)+"px;"),c=d('<div class="legend">'+c.replace('style="','style="position:absolute;'+b+";")+"</div>").appendTo(a),0!=n.legend.backgroundOpacity&&(g=n.legend.backgroundColor,null==g&&(g=(g=n.grid.backgroundColor)&&"string"==typeof g?d.color.parse(g):d.color.extract(c,"background-color"),g.a=1,g=g.toString()),k=c.children(),d('<div style="position:absolute;width:'+k.width()+"px;height:"+k.height()+"px;"+b+"background-color:"+g+';"> </div>').prependTo(c).css("opacity",n.legend.backgroundOpacity))))}}
function da(a){n.grid.hoverable&&ga("plothover",a,function(a){return!1!=a.hoverable})}function Y(a){n.grid.hoverable&&ga("plothover",a,function(a){return!1})}function ia(a){ga("plotclick",a,function(a){return!1!=a.clickable})}function ga(b,c,g){var d=X.offset(),e=c.pageX-d.left-w.left,f=c.pageY-d.top-w.top,k=E({left:e,top:f});k.pageX=c.pageX;k.pageY=c.pageY;c=n.grid.mouseActiveRadius;var h=c*c+1,m=null,p,r,z;for(p=C.length-1;0<=p;--p)if(g(C[p])){var q=C[p],v=q.xaxis,t=q.yaxis,A=q.datapoints.points,
F=v.c2p(e),aa=t.c2p(f),fa=c/v.scale,K=c/t.scale;z=q.datapoints.pointsize;v.options.inverseTransform&&(fa=Number.MAX_VALUE);t.options.inverseTransform&&(K=Number.MAX_VALUE);if(q.lines.show||q.points.show)for(r=0;r<A.length;r+=z){var y=A[r],I=A[r+1];null==y||y-F>fa||y-F<-fa||I-aa>K||I-aa<-K||(y=Math.abs(v.p2c(y)-e),I=Math.abs(t.p2c(I)-f),I=y*y+I*I,I<h&&(h=I,m=[p,r/z]))}if(q.bars.show&&!m)for(v="left"==q.bars.align?0:-q.bars.barWidth/2,q=v+q.bars.barWidth,r=0;r<A.length;r+=z)y=A[r],I=A[r+1],t=A[r+2],
null!=y&&(C[p].bars.horizontal?F<=Math.max(t,y)&&F>=Math.min(t,y)&&aa>=I+v&&aa<=I+q:F>=y+v&&F<=y+q&&aa>=Math.min(t,I)&&aa<=Math.max(t,I))&&(m=[p,r/z])}m?(p=m[0],r=m[1],z=C[p].datapoints.pointsize,g={datapoint:C[p].datapoints.points.slice(r*z,(r+1)*z),dataIndex:r,series:C[p],seriesIndex:p}):g=null;g&&(g.pageX=parseInt(g.series.xaxis.p2c(g.datapoint[0])+d.left+w.left,10),g.pageY=parseInt(g.series.yaxis.p2c(g.datapoint[1])+d.top+w.top,10));if(n.grid.autoHighlight){for(d=0;d<Z.length;++d)e=Z[d],e.auto!=
b||g&&e.series==g.series&&e.point[0]==g.datapoint[0]&&e.point[1]==g.datapoint[1]||ja(e.series,e.point);g&&ka(g.series,g.datapoint,b)}a.trigger(b,[k,g])}function ca(){var a=n.interaction.redrawOverlayInterval;-1==a?la():ha||(ha=setTimeout(la,a))}function la(){ha=null;P.save();ea.clear();P.translate(w.left,w.top);var a,b;for(a=0;a<Z.length;++a)if(b=Z[a],b.series.bars.show)ra(b.series,b.point);else{var c=b.series,e=b.point;b=e[0];var e=e[1],f=c.xaxis,k=c.yaxis,h="string"===typeof c.highlightColor?c.highlightColor:
d.color.parse(c.color).scale("a",.5).toString();if(!(b<f.min||b>f.max||e<k.min||e>k.max)){var n=c.points.radius+c.points.lineWidth/2;P.lineWidth=n;P.strokeStyle=h;h=1.5*n;b=f.p2c(b);e=k.p2c(e);P.beginPath();"circle"==c.points.symbol?P.arc(b,e,h,0,2*Math.PI,!1):c.points.symbol(P,b,e,h,!1);P.closePath();P.stroke()}}P.restore();m(R.drawOverlay,[P])}function ka(a,b,c){"number"==typeof a&&(a=C[a]);if("number"==typeof b){var e=a.datapoints.pointsize;b=a.datapoints.points.slice(e*b,e*(b+1))}e=qa(a,b);-1==
e?(Z.push({series:a,point:b,auto:c}),ca()):c||(Z[e].auto=!1)}function ja(a,b){if(null==a&&null==b)Z=[],ca();else{"number"==typeof a&&(a=C[a]);if("number"==typeof b){var c=a.datapoints.pointsize;b=a.datapoints.points.slice(c*b,c*(b+1))}c=qa(a,b);-1!=c&&(Z.splice(c,1),ca())}}function qa(a,b){for(var c=0;c<Z.length;++c){var e=Z[c];if(e.series==a&&e.point[0]==b[0]&&e.point[1]==b[1])return c}return-1}function ra(a,b){var c="string"===typeof a.highlightColor?a.highlightColor:d.color.parse(a.color).scale("a",
.5).toString(),e="left"==a.bars.align?0:-a.bars.barWidth/2;P.lineWidth=a.bars.lineWidth;P.strokeStyle=c;pa(b[0],b[1],b[2]||0,e,e+a.bars.barWidth,0,function(){return c},a.xaxis,a.yaxis,P,a.bars.horizontal,a.bars.lineWidth)}function na(a,b,c,e){if("string"==typeof a)return a;b=r.createLinearGradient(0,c,0,b);c=0;for(var f=a.colors.length;c<f;++c){var k=a.colors[c];if("string"!=typeof k){var h=d.color.parse(e);null!=k.brightness&&(h=h.scale("rgb",k.brightness));null!=k.opacity&&(h.a*=k.opacity);k=h.toString()}b.addColorStop(c/
(f-1),k)}return b}var C=[],n={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,
alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,
margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1E3/60},hooks:{}},L=null,ea=null,X=null,r=null,P=null,N=[],T=[],w={left:0,right:0,top:0,bottom:0},U=0,S=0,R={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},G=this;
G.setData=h;G.setupGrid=z;G.draw=K;G.getPlaceholder=function(){return a};G.getCanvas=function(){return L.element};G.getPlotOffset=function(){return w};G.width=function(){return U};G.height=function(){return S};G.offset=function(){var a=X.offset();a.left+=w.left;a.top+=w.top;return a};G.getData=function(){return C};G.getAxes=function(){var a={};d.each(N.concat(T),function(b,c){c&&(a[c.direction+(1!=c.n?c.n:"")+"axis"]=c)});return a};G.getXAxes=function(){return N};G.getYAxes=function(){return T};G.c2p=
E;G.p2c=function(a){var b={},c,e,d;for(c=0;c<N.length;++c)if((e=N[c])&&e.used&&(d="x"+e.n,null==a[d]&&1==e.n&&(d="x"),null!=a[d])){b.left=e.p2c(a[d]);break}for(c=0;c<T.length;++c)if((e=T[c])&&e.used&&(d="y"+e.n,null==a[d]&&1==e.n&&(d="y"),null!=a[d])){b.top=e.p2c(a[d]);break}return b};G.getOptions=function(){return n};G.highlight=ka;G.unhighlight=ja;G.triggerRedrawOverlay=ca;G.pointOffset=function(a){return{left:parseInt(N[f(a,"x")-1].p2c(+a.x)+w.left,10),top:parseInt(T[f(a,"y")-1].p2c(+a.y)+w.top,
10)}};G.shutdown=function(){ha&&clearTimeout(ha);X.unbind("mousemove",da);X.unbind("mouseleave",Y);X.unbind("click",ia);m(R.shutdown,[X])};G.resize=function(){var b=a.width(),c=a.height();L.resize(b,c);ea.resize(b,c)};G.hooks=R;(function(){for(var a={Canvas:q},b=0;b<k.length;++b){var c=k[b];c.init(G,a);c.options&&d.extend(!0,n,c.options)}})(G);(function(b){d.extend(!0,n,b);b&&b.colors&&(n.colors=b.colors);null==n.xaxis.color&&(n.xaxis.color=d.color.parse(n.grid.color).scale("a",.22).toString());null==
n.yaxis.color&&(n.yaxis.color=d.color.parse(n.grid.color).scale("a",.22).toString());null==n.xaxis.tickColor&&(n.xaxis.tickColor=n.grid.tickColor||n.xaxis.color);null==n.yaxis.tickColor&&(n.yaxis.tickColor=n.grid.tickColor||n.yaxis.color);null==n.grid.borderColor&&(n.grid.borderColor=n.grid.color);null==n.grid.tickColor&&(n.grid.tickColor=d.color.parse(n.grid.color).scale("a",.22).toString());var c,e,f={style:a.css("font-style"),size:Math.round(.8*(+a.css("font-size").replace("px","")||13)),variant:a.css("font-variant"),
weight:a.css("font-weight"),family:a.css("font-family")};f.lineHeight=1.15*f.size;e=n.xaxes.length||1;for(b=0;b<e;++b)(c=n.xaxes[b])&&!c.tickColor&&(c.tickColor=c.color),c=d.extend(!0,{},n.xaxis,c),n.xaxes[b]=c,c.font&&(c.font=d.extend({},f,c.font),c.font.color||(c.font.color=c.color));e=n.yaxes.length||1;for(b=0;b<e;++b)(c=n.yaxes[b])&&!c.tickColor&&(c.tickColor=c.color),c=d.extend(!0,{},n.yaxis,c),n.yaxes[b]=c,c.font&&(c.font=d.extend({},f,c.font),c.font.color||(c.font.color=c.color));n.xaxis.noTicks&&
null==n.xaxis.ticks&&(n.xaxis.ticks=n.xaxis.noTicks);n.yaxis.noTicks&&null==n.yaxis.ticks&&(n.yaxis.ticks=n.yaxis.noTicks);n.x2axis&&(n.xaxes[1]=d.extend(!0,{},n.xaxis,n.x2axis),n.xaxes[1].position="top");n.y2axis&&(n.yaxes[1]=d.extend(!0,{},n.yaxis,n.y2axis),n.yaxes[1].position="right");n.grid.coloredAreas&&(n.grid.markings=n.grid.coloredAreas);n.grid.coloredAreasColor&&(n.grid.markingsColor=n.grid.coloredAreasColor);n.lines&&d.extend(!0,n.series.lines,n.lines);n.points&&d.extend(!0,n.series.points,
n.points);n.bars&&d.extend(!0,n.series.bars,n.bars);null!=n.shadowSize&&(n.series.shadowSize=n.shadowSize);null!=n.highlightColor&&(n.series.highlightColor=n.highlightColor);for(b=0;b<n.xaxes.length;++b)v(N,b+1).options=n.xaxes[b];for(b=0;b<n.yaxes.length;++b)v(T,b+1).options=n.yaxes[b];for(var k in R)n.hooks[k]&&n.hooks[k].length&&(R[k]=R[k].concat(n.hooks[k]));m(R.processOptions,[n])})(b);(function(){a.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove();"static"==a.css("position")&&
a.css("position","relative");L=new q("flot-base",a);ea=new q("flot-overlay",a);r=L.context;P=ea.context;X=d(ea.element).unbind();var b=a.data("plot");b&&(b.shutdown(),ea.clear());a.data("plot",G)})();h(c);z();K();n.grid.hoverable&&(X.mousemove(da),X.bind("mouseleave",Y));n.grid.clickable&&X.click(ia);m(R.bindEvents,[X]);var Z=[],ha=null}var c=Object.prototype.hasOwnProperty;q.prototype.resize=function(a,c){if(0>=a||0>=c)throw Error("Invalid dimensions for plot, width = "+a+", height = "+c);var b=
this.element,d=this.context,m=this.pixelRatio;this.width!=a&&(b.width=a*m,b.style.width=a+"px",this.width=a);this.height!=c&&(b.height=c*m,b.style.height=c+"px",this.height=c);d.restore();d.save();d.scale(m,m)};q.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};q.prototype.render=function(){var a=this._textCache,e;for(e in a)if(c.call(a,e)){var b=this.getTextLayer(e),d=a[e];b.hide();for(var m in d)if(c.call(d,m)){var h=d[m],f;for(f in h)if(c.call(h,f)){for(var p=h[f].positions,
q=0,v;v=p[q];q++)v.active?v.rendered||(b.append(v.element),v.rendered=!0):(p.splice(q--,1),v.rendered&&v.element.detach());0==p.length&&delete h[f]}}b.show()}};q.prototype.getTextLayer=function(a){var c=this.text[a];null==c&&(null==this.textContainer&&(this.textContainer=d("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),c=this.text[a]=d("<div></div>").addClass(a).css({position:"absolute",top:0,
left:0,bottom:0,right:0}).appendTo(this.textContainer));return c};q.prototype.getTextInfo=function(a,c,b,k,m){var h,f;c=""+c;k="object"===typeof b?b.style+" "+b.variant+" "+b.weight+" "+b.size+"px/"+b.lineHeight+"px "+b.family:b;h=this._textCache[a];null==h&&(h=this._textCache[a]={});f=h[k];null==f&&(f=h[k]={});h=f[c];null==h&&(a=d("<div></div>").html(c).css({position:"absolute","max-width":m,top:-9999}).appendTo(this.getTextLayer(a)),"object"===typeof b?a.css({font:k,color:b.color}):"string"===typeof b&&
a.addClass(b),h=f[c]={width:a.outerWidth(!0),height:a.outerHeight(!0),element:a,positions:[]},a.detach());return h};q.prototype.addText=function(a,c,b,d,m,h,f,p,q){a=this.getTextInfo(a,d,m,h,f);d=a.positions;"center"==p?c-=a.width/2:"right"==p&&(c-=a.width);"middle"==q?b-=a.height/2:"bottom"==q&&(b-=a.height);for(q=0;m=d[q];q++)if(m.x==c&&m.y==b){m.active=!0;return}m={active:!0,rendered:!1,element:d.length?a.element.clone():a.element,x:c,y:b};d.push(m);m.element.css({top:Math.round(b),left:Math.round(c),
"text-align":p})};q.prototype.removeText=function(a,d,b,k,m,h){if(null==k){if(d=this._textCache[a],null!=d)for(var f in d)if(c.call(d,f)){b=d[f];for(var p in b)if(c.call(b,p))for(a=b[p].positions,k=0;m=a[k];k++)m.active=!1}}else for(a=this.getTextInfo(a,k,m,h).positions,k=0;m=a[k];k++)m.x==d&&m.y==b&&(m.active=!1)};d.plot=function(a,c,b){return new s(d(a),c,b,d.plot.plugins)};d.plot.version="0.8.1";d.plot.plugins=[];d.fn.plot=function(a,c){return this.each(function(){d.plot(this,a,c)})}})(jQuery);
(function(d){var q={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(d,c){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+c.color+";'>"+d+"<br/>"+Math.round(c.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};d.plot.plugins.push({init:function(s){function c(a){for(var b=
0,c=0,e=0,f=q.series.pie.combine.color,k=[],h=0;h<a.length;++h){var m=a[h].data;d.isArray(m)&&1==m.length&&(m=m[0]);d.isArray(m)?!isNaN(parseFloat(m[1]))&&isFinite(m[1])?m[1]=+m[1]:m[1]=0:m=!isNaN(parseFloat(m))&&isFinite(m)?[1,+m]:[1,0];a[h].data=[m]}for(h=0;h<a.length;++h)b+=a[h].data[0][1];for(h=0;h<a.length;++h)m=a[h].data[0][1],m/b<=q.series.pie.combine.threshold&&(c+=m,e++,f||(f=a[h].color));for(h=0;h<a.length;++h)m=a[h].data[0][1],(2>e||m/b>q.series.pie.combine.threshold)&&k.push({data:[[1,
m]],color:a[h].color,label:a[h].label,angle:m*Math.PI*2/b,percent:m/(b/100)});1<e&&k.push({data:[[1,c]],color:f,label:q.series.pie.combine.label,angle:c*Math.PI*2/b,percent:c/(b/100)});return k}function a(a,b){function c(){t.clearRect(0,0,k,m);p.children().filter(".pieLabel, .pieLabelBackground").remove()}function f(){var a=q.series.pie.shadow.left,b=q.series.pie.shadow.top,c=q.series.pie.shadow.alpha,d=1<q.series.pie.radius?q.series.pie.radius:E*q.series.pie.radius;if(!(d>=k/2-a||d*q.series.pie.tilt>=
m/2-b||10>=d)){t.save();t.translate(a,b);t.globalAlpha=c;t.fillStyle="#000";t.translate(v,F);t.scale(1,q.series.pie.tilt);for(a=1;10>=a;a++)t.beginPath(),t.arc(0,0,d,0,2*Math.PI,!1),t.fill(),d-=a;t.restore()}}function h(){function a(b,c,d){0>=b||isNaN(b)||(d?t.fillStyle=c:(t.strokeStyle=c,t.lineJoin="round"),t.beginPath(),1E-9<Math.abs(b-2*Math.PI)&&t.moveTo(0,0),t.arc(0,0,f,z,z+b/2,!1),t.arc(0,0,f,z+b/2,z+b,!1),t.closePath(),z+=b,d?t.fill():t.stroke())}function b(){for(var a=c,e=1<q.series.pie.label.radius?
q.series.pie.label.radius:E*q.series.pie.label.radius,f=0;f<s.length;++f){if(s[f].percent>=100*q.series.pie.label.threshold){var h;h=s[f];var t=a,z=f;if(0==h.data[0][1])h=!0;else{var A=q.legend.labelFormatter,y=void 0,K=q.series.pie.label.formatter,y=A?A(h.label,h):h.label;K&&(y=K(y,h));A=(t+h.angle+t)/2;t=v+Math.round(Math.cos(A)*e);A=F+Math.round(Math.sin(A)*e)*q.series.pie.tilt;p.append("<span class='pieLabel' id='pieLabel"+z+"' style='position:absolute;top:"+A+"px;left:"+t+"px;'>"+y+"</span>");
z=p.children("#pieLabel"+z);y=A-z.height()/2;A=t-z.width()/2;z.css("top",y);z.css("left",A);0<0-y||0<0-A||0>m-(y+z.height())||0>k-(A+z.width())?h=!1:(0!=q.series.pie.label.background.opacity&&(t=q.series.pie.label.background.color,null==t&&(t=h.color),h="top:"+y+"px;left:"+A+"px;",d("<div class='pieLabelBackground' style='position:absolute;width:"+z.width()+"px;height:"+z.height()+"px;"+h+"background-color:"+t+";'></div>").css("opacity",q.series.pie.label.background.opacity).insertBefore(z)),h=!0)}if(!h)return!1}a+=
s[f].angle}return!0}var c=Math.PI*q.series.pie.startAngle,f=1<q.series.pie.radius?q.series.pie.radius:E*q.series.pie.radius;t.save();t.translate(v,F);t.scale(1,q.series.pie.tilt);t.save();for(var z=c,A=0;A<s.length;++A)s[A].startAngle=z,a(s[A].angle,s[A].color,!0);t.restore();if(0<q.series.pie.stroke.width){t.save();t.lineWidth=q.series.pie.stroke.width;z=c;for(A=0;A<s.length;++A)a(s[A].angle,q.series.pie.stroke.color,!1);t.restore()}e(t);t.restore();return q.series.pie.label.show?b():!0}if(p){var k=
a.getPlaceholder().width(),m=a.getPlaceholder().height(),I=p.children().filter(".legend").children().width()||0;t=b;$=!1;E=Math.min(k,m/q.series.pie.tilt)/2;F=m/2+q.series.pie.offset.top;v=k/2;v="auto"==q.series.pie.offset.left?q.legend.position.match("w")?v+I/2:v-I/2:v+q.series.pie.offset.left;v<E?v=E:v>k-E&&(v=k-E);var s=a.getData(),I=0;do 0<I&&(E*=.95),I+=1,c(),.8>=q.series.pie.tilt&&f();while(!h()&&10>I);10<=I&&(c(),p.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>"));
a.setSeries&&a.insertLegend&&(a.setSeries(s),a.insertLegend())}}function e(a){if(0<q.series.pie.innerRadius){a.save();var b=1<q.series.pie.innerRadius?q.series.pie.innerRadius:E*q.series.pie.innerRadius;a.globalCompositeOperation="destination-out";a.beginPath();a.fillStyle=q.series.pie.stroke.color;a.arc(0,0,b,0,2*Math.PI,!1);a.fill();a.closePath();a.restore();a.save();a.beginPath();a.strokeStyle=q.series.pie.stroke.color;a.arc(0,0,b,0,2*Math.PI,!1);a.stroke();a.closePath();a.restore()}}function b(a){m("plothover",
a)}function k(a){m("plotclick",a)}function m(a,b){var c=s.offset(),d=parseInt(b.pageX-c.left);a:{for(var c=parseInt(b.pageY-c.top),e=s.getData(),f=s.getOptions(),f=1<f.series.pie.radius?f.series.pie.radius:E*f.series.pie.radius,k,m,$=0;$<e.length;++$){var y=e[$];if(y.pie.show){t.save();t.beginPath();t.moveTo(0,0);t.arc(0,0,f,y.startAngle,y.startAngle+y.angle/2,!1);t.arc(0,0,f,y.startAngle+y.angle/2,y.startAngle+y.angle,!1);t.closePath();k=d-v;m=c-F;if(t.isPointInPath){if(t.isPointInPath(d-v,c-F)){t.restore();
d={datapoint:[y.percent,y.data],dataIndex:0,series:y,seriesIndex:$};break a}}else{var M=f*Math.cos(y.startAngle),V=f*Math.sin(y.startAngle),da=f*Math.cos(y.startAngle+y.angle/4),Y=f*Math.sin(y.startAngle+y.angle/4),ia=f*Math.cos(y.startAngle+y.angle/2),ga=f*Math.sin(y.startAngle+y.angle/2),ca=f*Math.cos(y.startAngle+y.angle/1.5),la=f*Math.sin(y.startAngle+y.angle/1.5),ka=f*Math.cos(y.startAngle+y.angle),ja=f*Math.sin(y.startAngle+y.angle),M=[[0,0],[M,V],[da,Y],[ia,ga],[ca,la],[ka,ja]];k=[k,m];m=!1;
V=-1;da=M.length;for(Y=da-1;++V<da;Y=V)(M[V][1]<=k[1]&&k[1]<M[Y][1]||M[Y][1]<=k[1]&&k[1]<M[V][1])&&k[0]<(M[Y][0]-M[V][0])*(k[1]-M[V][1])/(M[Y][1]-M[V][1])+M[V][0]&&(m=!m);if(m){t.restore();d={datapoint:[y.percent,y.data],dataIndex:0,series:y,seriesIndex:$};break a}}t.restore()}}d=null}if(q.grid.autoHighlight)for(c=0;c<O.length;++c)e=O[c],e.auto!=a||d&&e.series==d.series||(e=e.series,null==e&&(O=[],s.triggerRedrawOverlay()),e=h(e),-1!=e&&(O.splice(e,1),s.triggerRedrawOverlay()));d&&(c=d.series,e=h(c),
-1==e?(O.push({series:c,auto:a}),s.triggerRedrawOverlay()):a||(O[e].auto=!1));p.trigger(a,[{pageX:b.pageX,pageY:b.pageY},d])}function h(a){for(var b=0;b<O.length;++b)if(O[b].series==a)return b;return-1}var f=null,p=null,E=null,v=null,F=null,$=!1,t=null,O=[];s.hooks.processOptions.push(function(a,b){b.series.pie.show&&(b.grid.show=!1,"auto"==b.series.pie.label.show&&(b.series.pie.label.show=b.legend.show?!1:!0),"auto"==b.series.pie.radius&&(b.series.pie.radius=b.series.pie.label.show?.75:1),1<b.series.pie.tilt?
b.series.pie.tilt=1:0>b.series.pie.tilt&&(b.series.pie.tilt=0))});s.hooks.bindEvents.push(function(a,c){var d=a.getOptions();d.series.pie.show&&(d.grid.hoverable&&c.unbind("mousemove").mousemove(b),d.grid.clickable&&c.unbind("click").click(k))});s.hooks.processDatapoints.push(function(a,b,e,h){a.getOptions().series.pie.show&&!$&&($=!0,f=a.getCanvas(),p=d(f).parent(),q=a.getOptions(),a.setData(c(a.getData())))});s.hooks.drawOverlay.push(function(a,b){if(a.getOptions().series.pie.show){var c=a.getOptions(),
d=1<c.series.pie.radius?c.series.pie.radius:E*c.series.pie.radius;b.save();b.translate(v,F);b.scale(1,c.series.pie.tilt);for(var f=0;f<O.length;++f){var h=O[f].series;0>=h.angle||isNaN(h.angle)||(b.fillStyle="rgba(255, 255, 255, "+c.series.pie.highlight.opacity+")",b.beginPath(),1E-9<Math.abs(h.angle-2*Math.PI)&&b.moveTo(0,0),b.arc(0,0,d,h.startAngle,h.startAngle+h.angle/2,!1),b.arc(0,0,d,h.startAngle+h.angle/2,h.startAngle+h.angle,!1),b.closePath(),b.fill())}e(b);b.restore()}});s.hooks.draw.push(function(b,
c){b.getOptions().series.pie.show&&a(b,c)})},options:q,name:"pie",version:"1.1"})})(jQuery);
(function(d,q){var s=0;d.widget("s3.pivottable",{options:{showTotals:!0,ajaxURL:null,defaultChart:{type:"breakdown",axis:"rows"},renderFilter:!0,renderOptions:!0,renderChart:!0,renderTable:!0,collapseFilter:!1,collapseOptions:!0,collapseChart:!0,collapseTable:!1,exploreChart:!1,filterURL:null,filterForm:null,filterTab:null,autoSubmit:1E3,thousandSeparator:" ",thousandGrouping:"3",minTickSize:null,precision:null},_create:function(){this.id=s;s+=1;this.chart=this.table=null},_init:function(){var c=
d(this.element),a=this.options;this.table=this.data=null;this.chart_options={currentChart:null,currentDataIndex:null,currentSeriesIndex:null};this.table_options={hidden:!1};var e=c.find(".pt-chart");this.chart=e.length?e.first():null;a.renderFilter||a.renderOptions?(e=c.attr("id"),a.renderOptions?(d("#"+e+"-options").show(),a.collapseOptions&&(d("#"+e+"-options legend").siblings().toggle(),d("#"+e+"-options legend").children().toggle())):d("#"+e+"-options").hide(),a.renderFilter?(d("#"+e+"-filters").show(),
a.collapseFilter&&(d("#"+e+"-filters legend").siblings().toggle(),d("#"+e+"-filters legend").children().toggle())):d("#"+e+"-options").hide()):c.find(".pt-form-container").hide();a.collapseTable&&(this.table_options.hidden=!0,c.find(".pt-table").hide(),c.find(".pt-show-table").show(),c.find(".pt-hide-table").hide());a.numberFormatter=function(b){var c=a.precision,c=c||0==c?b.toFixed(c):b.toString(),c=c.split(".");b=c[0];c=1<c.length?"."+c[1]:"";b=b.replace(new RegExp("\\B(?=(\\d{"+a.thousandGrouping+
"})+(?!\\d))","g"),a.thousandSeparator);return b+c};this.refresh()},_destroy:function(){this.table&&this.table.remove();this.chart&&this.chart.empty()},refresh:function(){var c=d(this.element),a=null;this._unbindEvents();var e=c.find('input[type="hidden"][name="pivotdata"]');e.length&&(a=JSON.parse(d(e).first().val()));a?"count"==a.method&&(this.options.precision=0,this.options.minTickSize=1):(a={empty:!0},c.find(".pt-hide-table").hide(),c.find(".pt-show-table").hide());this.data=a;a.nodata?(c.find(".pt-table").first().empty().append(d('<div class="pt-no-data">'+
a.nodata+"</div>")),c.find(".pt-hide-table").hide(),c.find(".pt-show-table").hide()):(this._renderTable(),this._renderChartOptions());this._renderChart();a.empty?c.find(".pt-empty").show():c.find(".pt-empty").hide();this.options.autoSubmit?c.find(".pt-submit").hide():c.find(".pt-submit").show();this._bindEvents();c.find(".pt-throbber").hide()},_renderTable:function(){var c=d(this.element),a=c.find(".pt-table").first().empty();this.table=null;var e=this.data;if(!e.empty)if(this.options.renderTable){var b=
e.cells,k=e.cols,m=e.rows,h=e.total,f=e.labels,e=this._renderHeader(k,f);e.append(this._renderColumns(k,f));b=this._renderRows(m,k,f,b);k=this._renderFooter(m,k,f,h);m=d('<table class="dataTable display report"/>').append(e).append(b);null!==k&&m.append(k);this.table=d(m);d(a).append(this.table);this.table_options.hidden?(c.find(".pt-show-table").show(),c.find(".pt-hide-table").hide()):(c.find(".pt-show-table").hide(),c.find(".pt-hide-table").show())}else c.find(".pt-show-table").hide(),c.find(".pt-hide-table").hide()},
_renderHeader:function(c,a){var e=d("<tr>");colspan="__other__"==c[c.length-1][0]?c.length-1:c.length;e.append(d('<th scope="col">'+a.layer+"</th>"));(1<c.length||c[0][4])&&e.append(d('<th scope="col" colspan="'+colspan+'">'+a.cols+"</th>"));this.options.showTotals&&e.append(d('<th class="totals_header row_totals" scope="col" rowspan="2">'+a.total+"</th>"));return d("<thead>").append(e)},_renderColumns:function(c,a){var e=d("<tr>"),b;e.append(d('<th scope="col">'+a.rows+"</th>"));for(var k=1==c.length&&
null===c[0][4]?!0:!1,m=0;m<c.length;m++)"__other__"==c[m][0]||k&&this.options.showTotals||(b=k?"":c[m][4],e.append(d('<th scope="col">'+b+"</th>")));return e},_renderRows:function(c,a,e,b){for(var k=d("<tbody>"),m=this.options.showTotals,h=1==c.length&&null===c[0][4]?!0:!1,f,p,q=0;q<b.length;q++)f=c[q],"__other__"==f[0]||h&&this.options.showTotals||(p=h?"":c[q][4],p=d('<tr class="'+(q%2?"odd":"even")+'"><td>'+p+"</td></tr>").append(this._renderCells(b[q],a,e)),m&&p.append(d("<td>"+f[2]+"</td>")),
k.append(p));return k},_renderCells:function(c,a,e){for(var b,k=e.none,m=1==a.length&&null===a[0][4]?!0:!1,h=[],f,p,q=0;q<c.length;q++)if(!("__other__"==a[q][0]||m&&this.options.showTotals)){b=c[q];e=b.items;f=d("<td>");if(null===e)p=d('<div class="pt-cell-value">'+k+"</div>");else if(d.isArray(e)){p=d('<div class="pt-cell-value">');list=d("<ul>");for(var v=0;v<e.length;v++)list.append(d("<li>"+e[v]+"</li>"));p.append(list)}else p=d('<div class="pt-cell-value">'+e+"</div>");f.append(p);b=b.keys;e&&
b&&b.length&&f.data("records",b).append(d('<div class="pt-cell-zoom"></div>'));h.push(f)}return h},_renderFooter:function(c,a,e,b){var k=1==a.length&&null===a[0][4]?!0:!1;if(this.options.showTotals){var m,h;h=m=0;for(len=c.length;m<len;m++)"__other__"!=c[m][0]&&h++;c=d('<tr class="'+(h%2?"odd":"even")+' totals_row"><th class="totals_header" scope="row">'+e.total+"</th></tr>");for(m=0;m<a.length;m++)"__other__"==a[m][0]||k||c.append(d("<td>"+a[m][2]+"</td>"));c.append(d("<td>"+b+"</td>"));return d("<tfoot>").append(c)}return null},
_renderChartOptions:function(){var c=d(this.element),a=c.find(".pt-chart-controls").first().empty(),e=this.data;if(!e.empty&&this.options.renderChart){var e=e.labels,b=c.attr("id"),c=e.layer,k=e.rows,m=e.cols,h=e.per,f=d('<div class="pt-chart-opts">'),p=b+"-pchart-rows",q=b+"-vchart-rows",v=b+"-hchart-rows",F=b+"-pchart-cols",s=b+"-vchart-cols",b=b+"-hchart-cols";c&&d(f).append(d('<span class="pt-chart-label">'+c+": </span>"));k&&d(f).append(d('<div id="'+p+'" class="pt-chart-icon pt-pchart"/><div id="'+
q+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+h+" "+k+"</span>"));m&&d(f).append(d('<div id="'+F+'" class="pt-chart-icon pt-pchart"/><div id="'+s+'" class="pt-chart-icon pt-vchart"/><span class="pt-chart-label">'+h+" "+m+"</span>"));k&&m&&d(f).append(d('<span class="pt-chart-label">| '+e.breakdown+': </span><div id="'+v+'" class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+[h,k,"&amp;",m].join(" ")+'</span><div id="'+b+'"  class="pt-chart-icon pt-hchart"/><span class="pt-chart-label">'+
[h,m,"&amp;",k].join(" ")+"</span>"));d(a).append(f)}},_truncateLabel:function(c,a){return c.length>a?c.substring(0,a-3).replace(/\s+$/g,"")+"...":c},_renderChart:function(c){var a=d(this.element),e=this.data;a.find(".pt-chart-contents").hide();if(a=this.chart)if(d(a).unbind("plothover").unbind("plotclick").empty(),!e.empty&&this.options.renderChart)if(!1===c)this.options.collapseChart=!0;else{a=this.options.collapseChart;if("undefined"==typeof c||!c){if(a)return;c=this.chart_options.currentChart}if("undefined"==
typeof c||!c){if(a)return;c=this.options.defaultChart}if("undefined"!=typeof c&&c){this.options.collapseChart=!1;this.chart_options.currentChart=c;a=c.type;c=c.axis;var b=e.labels,k=b.per,m=b.layer+" "+k+" "+b.rows,b=b.layer+" "+k+" "+b.cols,k=e.filter,h=k[0],f=k[1];"piechart"==a?"rows"==c?this._renderPieChart(e.rows,m,h):this._renderPieChart(e.cols,b,f):"barchart"==a?"rows"==c?this._renderBarChart(e.rows,m,h):this._renderBarChart(e.cols,b,f):"breakdown"==a&&("rows"==c?this._renderBreakDown(e,0,m,
k):this._renderBreakDown(e,1,b,k))}}},_renderPieChart:function(c,a,e){var b=this.chart;if(b){d(b).closest(".pt-chart-contents").show().css({width:"800px"});d(b).css({height:"360px"});for(var k=[],m=0;m<c.length;m++){var h=c[m];h[1]||k.push({label:h[4],data:h[2],key:h[3]})}a?d(b).siblings(".pt-chart-title").html("<h4>"+a+"</h4>"):d(b).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(b),k,{series:{pie:{show:!0,radius:125}},legend:{show:!0,position:"ne"},grid:{hoverable:!0,clickable:!0}});
var f=this;this.chart_options.currentDataIndex=null;d(b).bind("plothover",function(a,b,c){if(c){if(f.chart_options.currentDataIndex!=c.seriesIndex){f._removeChartTooltip();f.chart_options.currentDataIndex=c.seriesIndex;a=c.series.data[0][1];var e=c.series.percent.toFixed(1),h='<div class="pt-tooltip-label">'+c.series.label+"</div>";f._renderChartTooltip(b.pageX,b.pageY,h+('<div class="pt-tooltip-text">'+a+" ("+e+"%)</div>"));d(".pt-tooltip-label").css({color:c.series.color})}}else f._removeChartTooltip()});
this.options.exploreChart&&e&&d(b).bind("plotclick",function(a,b,c){if(c){try{var d=[[e,k[c.seriesIndex].key]]}catch(h){return}f._chartExplore(d)}})}},_renderBarChart:function(c,a,e){var b=this.chart,k=this._truncateLabel;if(b){d(b).closest(".pt-chart-contents").show().css({width:"96%"});d(b).css({height:"360px"});for(var m=[],h=[],f=0,p=0;p<c.length;p++){var q=c[p];q[1]||(m.push({label:q[4],data:[[f+1,q[2]]],key:q[3]}),h.push([f+1,k(q[4],16)]),f++)}a?d(b).siblings(".pt-chart-title").html("<h4>"+
a+"</h4>"):d(b).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(b),m,{series:{bars:{show:!0,barWidth:.6,align:"center"}},legend:{show:!1,position:"ne"},grid:{hoverable:!0,clickable:!0},xaxis:{ticks:h,min:0,max:m.length+1,tickLength:0},yaxis:{tickFormatter:this.options.numberFormatter,minTickSize:this.options.minTickSize}});var v=this;this.chart_options.currentDataIndex=null;d(b).bind("plothover",function(a,b,c){c?v.chart_options.currentDataIndex!=c.seriesIndex&&(v._removeChartTooltip(),
v.chart_options.currentDataIndex=c.seriesIndex,a='<div class="pt-tooltip-label">'+c.series.label+"</div>",a+='<div class="pt-tooltip-text">'+c.series.data[0][1]+"</div>",v._renderChartTooltip(b.pageX,b.pageY,a),d(".pt-tooltip-label").css({color:c.series.color})):v._removeChartTooltip()});this.options.exploreChart&&e&&d(b).bind("plotclick",function(a,b,c){if(c){try{var d=[[e,m[c.seriesIndex].key]]}catch(f){return}v._chartExplore(d)}})}},_renderBreakDown:function(c,a,e,b){var k=this.chart;if(k){d(k).closest(".pt-chart-contents").show().css({width:"96%"});
var m,h,f=c.cells,p,q=[],v=[];0===a?(a=c.rows,p=c.cols,c=function(a,b){return f[q[a]][v[b]].value},m=b[0],h=b[1]):(a=c.cols,p=c.rows,c=function(a,b){return f[v[b]][q[a]].value},m=b[1],h=b[0]);var F=[],s=[];b=0;for(len=a.length;b<len;b++)a[b][1]||(F.push(a[b]),q.push(b));b=0;for(len=p.length;b<len;b++)p[b][1]||(s.push(p[b]),v.push(b));b=Math.max(F.length*Math.max(16*(s.length+1),50)+70,360);d(k).css({height:b+"px"});b=[];for(var t=a=0;t<s.length;t++){for(var O={label:s[t][4]},z=[],A,K=0;K<F.length;K++)p=
(F.length-K)*(s.length+1)-t,A=c(K,t),A>a&&(a=A),z.push([A,p]);O.data=z;b.push(O)}c=[];for(K=0;K<F.length;K++)t=F[K][4],p=(F.length-K)*(s.length+1)+1,c.push([p,t]);e?d(k).siblings(".pt-chart-title").html("<h4>"+e+"</h4>"):d(k).siblings(".pt-chart-title").empty();reportChart=jQuery.plot(d(k),b,{series:{bars:{show:!0,barWidth:.8,align:"center",horizontal:!0}},legend:{show:!0,position:"ne"},yaxis:{ticks:c,labelWidth:120,max:F.length*(s.length+1)+1},xaxis:{max:1.1*a,tickFormatter:this.options.numberFormatter,
minTickSize:this.options.minTickSize},grid:{hoverable:!0,clickable:!0}});d(".flot-y-axis .tickLabel").css({"padding-top":"25px",left:"0px",width:"120px"});var W=this;this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null;d(k).bind("plothover",function(a,b,c){if(c){if(W.chart_options.currentDataIndex!=c.dataIndex||W.chart_options.currentSeriesIndex!=c.seriesIndex)W._removeChartTooltip(),W.chart_options.currentDataIndex=c.dataIndex,W.chart_options.currentSeriesIndex=c.seriesIndex,
a='<div class="pt-tooltip-label">'+F[c.dataIndex][4]+"</div>",a+='<div class="pt-tooltip-text">'+c.series.label+' : <span class="pt-tooltip-value">'+c.datapoint[0]+"</span></div>",W._renderChartTooltip(b.pageX,b.pageY,a),d(".pt-tooltip-label").css({"padding-bottom":"8px"}),d(".pt-tooltip-text").css({color:c.series.color}),d(".pt-tooltip-value").css({"font-weight":"bold"})}else W._removeChartTooltip()});this.options.exploreChart&&m&&h&&d(k).bind("plotclick",function(a,b,c){if(c){try{var d=[[m,F[c.dataIndex][3]],
[h,s[c.seriesIndex][3]]]}catch(e){return}W._chartExplore(d)}})}},_chartExplore:function(c){var a=this.options,e=d(this.element).closest(".ui-tabs"),b=a.filterTab;if(e.length&&!1!==b)a=(a=a.filterForm)?d("#"+a):q,S3.search.setCurrentFilters(a,c),c=b?d("#"+b).index():0,e.tabs("option","active",c);else if(filterURL=a.filterURL)e=this._updateURL(filterURL,c),window.open(e,"_blank")},_renderChartTooltip:function(c,a,e){d('<div class="pt-chart-tooltip">'+e+"</div>").css({position:"absolute",display:"none",
top:a-50,left:c+10,border:"1px solid #999",padding:"10px","min-height":"50px","max-width":"240px","z-index":"501","background-color":"white",color:"#000",opacity:.95}).appendTo("body").fadeIn(200)},_removeChartTooltip:function(){d(".pt-chart-tooltip").remove();this.chart_options.currentDataIndex=null;this.chart_options.currentSeriesIndex=null},_getOptions:function(){var c="#"+d(this.element).attr("id");return{rows:d(c+"-rows").val(),cols:d(c+"-cols").val(),fact:d(c+"-fact").val(),totals:d(c+"-totals").is(":checked")?
1:0}},_getFilters:function(){var c="#"+d(this.element).attr("id"),c=d(c+"-filters");try{return c.length?S3.search.getCurrentFilters(c.first()):null}catch(a){}},_updateURL:function(c,a){var d,b,k=[],m={};d={};var h,f,p;if(a)for(h=0,len=a.length;h<len;h++)d=a[h],p=d[0],m[p]=!0,k.push(p+"="+d[1]);d=this.options.ajaxURL.split("?");if(1<d.length){b=d[1].split("&");d={};h=0;for(len=b.length;h<len;h++)f=b[h].split("="),1<f.length&&(p=decodeURIComponent(f[0]),m[p]||(k.push(p+"="+decodeURIComponent(f[1])),
d[p]=!0));for(p in d)m[p]=!0}d=c.split("?");if(1<d.length)for(b=d[1].split("&"),h=0,len=b.length;h<len;h++)f=b[h].split("="),1<f.length&&(p=decodeURIComponent(f[0]),m[p]||k.push(p+"="+decodeURIComponent(f[1])));k=k.join("&");m=d[0];k&&(m=m+"?"+k);return m},_updateAjaxURL:function(c,a){var e=this.options.ajaxURL.split("?"),b=null,b=[],k=!1,m;1<e.length?(m=e[1],m=m.split("&")):m=[];var h,f;if(c)for(h in c)newopt=c[h],f=h+"="+newopt,"totals"==h?this.options.showTotals=newopt?!0:!1:k||-1!=d.inArray(f,
m)||(k=!0),b.push(f);h={};var p={},q,v,s;if(a)for(q=0,v=a.length;q<v;q++)f=a[q],s=f[0],f=f[1],null===f?h[s]||(p[s]=!0):(p[s]&&(p[s]=!1),h[s]?h[s].push(s+"="+f):h[s]=[s+"="+f]);q=0;for(v=m.length;q<v;q++)f=m[q].split("="),1<f.length&&(s=decodeURIComponent(f[0]),f=decodeURIComponent(f[1]),p[s]?k=!0:h[s]?k||-1!=d.inArray(s+"="+f,h[s])||(k=!0):"aggregate"!=s&&(c&&c.hasOwnProperty(s)||b.push(m[q])));for(s in h)for(q=0,v=h[s].length;q<v;q++)k||-1!=d.inArray(h[s][q],m)||(k=!0),b.push(h[s][q]);b=b.join("&");
e=e[0];b&&(e=e+"?"+b);this.options.ajaxURL=e;return k},reload:function(c,a,e){e="undefined"!=typeof e?e:!0;"undefined"==typeof a&&(a=this._getFilters());var b=this,k=this.element,m,h=k.find('input[type="hidden"][name="pivotdata"]');if(h.length){k.find(".pt-throbber").show();if(c||a)m=this._updateAjaxURL(c,a);m||e?(c=this.options.ajaxURL,k.find(".pt-empty").hide(),d.ajax({url:c,dataType:"json"}).done(function(a){h.first().val(JSON.stringify(a));b.refresh()}).fail(function(a,b,c){msg="UNAUTHORIZED"==
c?i18n.gis_requires_login:a.responseText;console.log(msg)})):b.refresh()}},_bindEvents:function(c){var a=this,e=d(this.element);c=this.data;var b=e.attr("id");d("#"+b+"-options legend").click(function(){d(this).siblings().toggle();d(this).children().toggle()});d("#"+b+"-filters legend").click(function(){d(this).siblings().toggle();d(this).children().toggle()});e.find(".pt-hide-table").click(function(){a.table_options.hidden=!0;e.find(".pt-table").hide();d(this).siblings(".pt-show-table").show();d(this).hide()});
e.find(".pt-show-table").click(function(){a.table_options.hidden=!1;e.find(".pt-table").show();d(this).siblings(".pt-hide-table").show();d(this).hide()});d("#"+b+"-totals").click(function(){var b=d(this).is(":checked");a.options.showTotals!=b&&a.reload({totals:b},null,!1)});d("#"+b+"-rows, #"+b+"-cols, #"+b+"-fact").on("change.autosubmit",function(){d("#"+b+"-pt-form").trigger("optionChanged")});if(this.options.autoSubmit){var k=this.options.autoSubmit;d("#"+b+"-pt-form").on("optionChanged",function(){var b=
d(this);if(!b.data("noAutoSubmit")){var c=b.data("autoSubmitTimeout");c&&clearTimeout(c);c=setTimeout(function(){var b=a._getOptions(),c=a._getFilters();a.reload(b,c,!1)},k);b.data("autoSubmitTimeout",c)}})}else d("#"+b+"-pt-form input.pt-submit").click(function(){var b=a._getOptions(),c=a._getFilters();a.reload(b,c,!1)});d("#"+b+" div.pt-table div.pt-cell-zoom").click(function(a){a=d(a.currentTarget);var b=a.closest("td"),e=b.find(".pt-cell-records");if(0<e.length)e.remove(),a.removeClass("opened");
else{for(var k=b.data("records"),e=d("<div/>").addClass("pt-cell-records"),q=d("<ul/>"),s=0;s<k.length;s++)q.append("<li>"+c.lookup[k[s]]+"</li>");e.append(q);b.append(e);a.addClass("opened")}});d("#"+b+"-pchart-rows").click(function(){a._renderChart({type:"piechart",axis:"rows"})});d("#"+b+"-vchart-rows").click(function(){a._renderChart({type:"barchart",axis:"rows"})});d("#"+b+"-pchart-cols").click(function(){a._renderChart({type:"piechart",axis:"cols"})});d("#"+b+"-vchart-cols").click(function(){a._renderChart({type:"barchart",
axis:"cols"})});d("#"+b+"-hchart-rows").click(function(){a._renderChart({type:"breakdown",axis:"rows"})});d("#"+b+"-hchart-cols").click(function(){a._renderChart({type:"breakdown",axis:"cols"})});e.find(".pt-hide-chart").click(function(){a._renderChart(!1)})},_unbindEvents:function(){var c=d(this.element),a=c.attr("id");d("#"+a+" div.pt-table div.pt-cell-zoom").unbind("click");d("#"+a+"-options legend").unbind("click");d("#"+a+"-filters legend").unbind("click");d(a+"-totals").unbind("click");d("#"+
a+"-rows, #"+a+"-cols, #"+a+"-fact").unbind("change.autosubmit");d("#"+a+"-pt-form").unbind("optionChanged");c.find("input.pt-submit").unbind("click");d("#"+a+"-pchart-rows").unbind("click");d("#"+a+"-vchart-rows").unbind("click");d("#"+a+"-pchart-cols").unbind("click");d("#"+a+"-vchart-cols").unbind("click");c.find(".pt-hide-table").unbind("click");c.find(".pt-show-table").unbind("click");c.find(".pt-hide-chart").unbind("click")}})})(jQuery);
