(function(){S3.addPersonWidget=function(b){var a="#"+b,e=$(a),f=e.next(".error_wrapper"),l=$(a+"_title__row"),g=$(a+"_full_name__row"),k=$(a+"_date_of_birth__row"),c=$(a+"_gender__row"),d=$(a+"_occupation__row"),n=$(a+"_email__row"),m=$(a+"_mobile_phone__row"),h=$(a+"_box_bottom");$(a+"__row").hide().after(h).after(m).after(n).after(d).after(c).after(k).after(g).after(l).after(f);l.show();g.show();k.show();c.show();d.show();n.show();m.show();h.show();e.val()?p(b):q(b);$("form").submit(function(){S3ClearNavigateAwayConfirm();
r(b);return!0})};var r=function(b){var a="#"+b;$(a+"_full_name").prop("disabled",!1);$(a+"_gender").prop("disabled",!1);$(a+"_date_of_birth").prop("disabled",!1);$(a+"_occupation").prop("disabled",!1);$(a+"_email").prop("disabled",!1);$(a+"_mobile_phone").prop("disabled",!1);$(a+"_edit_bar .icon-edit").hide();q(b)},p=function(b){var a="#"+b;$(a+"_full_name").prop("disabled",!0);$(a+"_gender").prop("disabled",!0);$(a+"_date_of_birth").prop("disabled",!0);$(a+"_occupation").prop("disabled",!0);$(a+
"_email").prop("disabled",!0);$(a+"_mobile_phone").prop("disabled",!0);$(a+"_edit_bar").removeClass("hide").show();$(a+"_edit_bar .icon-edit").click(function(){r(b)});$(a+"_edit_bar .icon-remove").click(function(){s(b)})},s=function(b){b="#"+b;$(b).val("");$(b+"_full_name").prop("disabled",!1).val("");$(b+"_gender").prop("disabled",!1).val("");$(b+"_date_of_birth").prop("disabled",!1).val("");$(b+"_occupation").prop("disabled",!1).val("");$(b+"_email").prop("disabled",!1).val("");$(b+"_mobile_phone").prop("disabled",
!1).val("");$(b+"_edit_bar").hide()},q=function(b){var a="#"+b,e=$(a+"_full_name");if(!e.attr("autocomplete")){var f=$(a),l=e.attr("data-c");$(a+"_full_name").after('<div id="'+b+'_throbber" class="throbber hide"></div>');var g=$(a+"_throbber"),k=S3.Ap.concat("/"+l+"/person/search_ac"),c=e.val(),d=!1;e.autocomplete({delay:450,minLength:2,source:function(a,b){$.ajax({url:k,data:{term:a.term}}).done(function(a){if(0==a.length){var c=i18n.no_matching_records;a.push({id:0,value:"",label:c,first:c})}b(a)})},
search:function(a,b){e.hide();g.removeClass("hide").show();return!0},response:function(a,b,c){g.hide();e.show();return c},focus:function(a,b){var c=b.item,d=c.first;c.middle&&(d+=" "+c.middle);c.last&&(d+=" "+c.last);e.val(d);return!1},select:function(a,c){var h=c.item;if(h.id){var g=h.first;h.middle&&(g+=" "+h.middle);h.last&&(g+=" "+h.last);e.val(g);f.val(h.id);t(b,h.id)}else e.val(""),f.val("");d=!0;return!1}}).data("ui-autocomplete")._renderItem=function(a,c){var b=c.first;c.middle&&(b+=" "+c.middle);
c.last&&(b+=" "+c.last);return $("<li>").data("item.autocomplete",c).append("<a>"+b+"</a>").appendTo(a)};e.blur(function(){e.val()||(f.val(""),d=!0);d?c=e.val():e.val(c);d=!1})}},t=function(b,a){s(b);var e=$("#"+b),f=e.attr("data-c"),f=S3.Ap.concat("/"+f+"/person/"+a+".s3json?show_ids=True");$.getJSONS3(f,function(a){try{var b=void 0,k=void 0,c=a.$_pr_person[0];p();addPerson_real_input.val(c["@id"]);c.hasOwnProperty("first_name")&&$("#pr_person_first_name").val(c.first_name);c.hasOwnProperty("middle_name")&&
$("#pr_person_middle_name").val(c.middle_name["@value"]);c.hasOwnProperty("last_name")&&$("#pr_person_last_name").val(c.last_name["@value"]);c.hasOwnProperty("gender")&&$("#pr_person_gender").val(c.gender["@value"]);c.hasOwnProperty("date_of_birth")&&$("#pr_person_date_of_birth").val(c.date_of_birth["@value"]);c.hasOwnProperty("occupation")&&$("#pr_person_occupation").val(c.occupation["@value"]);if(c.hasOwnProperty("$_pr_email_contact"))var d=c.$_pr_email_contact[0],b=d.value["@value"];c.hasOwnProperty("$_pr_phone_contact")&&
(d=c.$_pr_phone_contact[0],k=d.value["@value"]);if(c.hasOwnProperty("$_pr_contact")){var f=c.$_pr_contact;for(a=0;a<f.length;a++)d=f[a],void 0==b&&"EMAIL"==d.contact_method["@value"]&&(b=d.value["@value"]),void 0==k&&"SMS"==d.contact_method["@value"]&&(k=d.value["@value"])}void 0!==b&&$("#pr_person_email").val(b);void 0!==k&&$("#pr_person_mobile_phone").val(k)}catch(m){e.val("")}})}})();
